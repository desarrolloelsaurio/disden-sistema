CLOSE DATA
SET TALK OFF
SET DELE ON
SET EXCL OFF
SET EXAC ON
SET CONF ON
SELE 0
USE ORFABDAT ALIAS FAX
SELE 0
USE REMITOF ALIAS REM
SELE 0
USE REMITDAF ALIAS REX
DO WHILE .T.
   CLEA
   STORE SPACE(15) TO M.REMITO
   @ 10,10 SAY "REMITO" GET M.REMITO PICT "!9999-99999999A"
   READ
   SELE FAX
   SET ORDER TO TAG REMTRU
   IF SEEK(M.REMITO)
      IF EMPTY(EEC) .AND. EMPTY(SEC) .AND. EMPTY(ESC) .AND. EMPTY(SSC)
         WAIT "OK" WIND NOWA
         SET ORDER TO TAG REMITO
         IF SEEK(M.REMITO)
            DELE WHILE FAX.REMITO==M.REMITO
            SELE REM
            SET ORDER TO TAG REMITO
            IF SEEK(M.REMITO)
               DELE
               SELE REX
               SET ORDER TO TAG REMITO
               IF SEEK(M.REMITO)
                  DELE WHILE REX.REMITO==REM.REMITO
               ELSE
                  WAIT "NO BORRADO DE DATOS REMITOS" WIND
               ENDIF
            ELSE
               WAIT "NO BORRADO DE REMITOS" WIND
            ENDIF
         ELSE
            WAIT "NO BORRADO DE FAX" WIND
         ENDIF
      ELSE
         WAIT "REMITO "+M.REMITO+" INCORRECTO" WIND
      ENDIF
   ENDIF
   IF EMPTY(VAL(RIGHT(M.REMITO,8)))
      EXIT
   ENDIF
ENDDO
