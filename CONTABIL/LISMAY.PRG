*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/07/95             LISMAY.PRG                17:39:56 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1995 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS eltitulo,porprin,porfecha

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 LISMAY/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
ELTITULO=" "+ALLTRIM(ELTITULO)+" "
STORE {} TO FE1,FE2,FECINI,FECINORI,FECFIN,FECFINORI
=GETFEC()

SELE BAL
SET ORDER TO TAG CODIGO
GO TOP
STORE CODIGO TO INICIO,INIINI
GO BOTT
STORE CODIGO TO FINAL,FINFIN
store .t. to m.salida
STORE KPERINIC TO PERINI
STORE KPERIODO TO PERFIN
STORE 1 TO ACUMANIO,MPAG,ACUMMES


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

DEFINE WINDOW win2 ;
	FROM INT((SROW()-20)/2),INT((SCOL()-72)/2) ;
	TO INT((SROW()-20)/2)+19,INT((SCOL()-72)/2)+71 ;
	TITLE ELTITULO ;						
	FOOTER ' '+EMPRESA+' / '+ALLTRIM(KMESES[KPERIODO])+' ' ;
	NOFLOAT ;
	NOCLOSE ;
	SHADOW ;
	NOMINIMIZE ;
	DOUBLE ;
	COLOR SCHEME 1


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISMAY/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("win2")
	ACTIVATE WINDOW win2 SAME
ELSE
	ACTIVATE WINDOW win2 NOSHOW
ENDIF
@ 5,13 SAY "Inicio" ;
	SIZE 1,6, 0
@ 6,13 SAY "Final" ;
	SIZE 1,5, 0
@ 1,37 SAY "Reporte" ;
	SIZE 1,7, 0
@ 16,1 SAY "Comienza en p쟥ina" ;
	SIZE 1,18, 0
@ 13,1 SAY "Arrastra Saldos meses anteriores" ;
	SIZE 1,32, 0
@ 14,1 SAY "Arrastra Saldos a쨚 anterior" ;
	SIZE 1,28, 0
@ 8,1 SAY "Tipo de Listado" ;
	SIZE 1,15, 0
@ 1,1 SAY "Cuentas de Nivel" ;
	SIZE 1,16, 0
@ 3,1 SAY "L죑ite de Cuentas" ;
	SIZE 1,17, 0
@ 10,13 SAY "Desde" ;
	SIZE 1,5, 0
@ 11,13 SAY "Hasta" ;
	SIZE 1,5, 0
@ 1,20 GET mniv ;
	SIZE 1,1 ;
	DEFAULT 0 ;
	PICTURE "9" ;
	VALID _r1p11v40a() ;
	MESSAGE "Nivel de las Cuentas del Listado - [ESC] para Men" ;
	ERROR "EL NIVEL DE LAS CUENTAS DEBE ESTAR ENTRE 1 Y 8"
@ 1,54 GET kreporte ;
	SIZE 1,5 ;
	DEFAULT " " ;
	PICTURE "!!!!!" ;
	WHEN .F.
@ 3,20 GET mlim ;
	PICTURE "@*RHN \<Todas;\<Rango" ;
	SIZE 1,9,8 ;
	DEFAULT 1 ;
	WHEN _r1p11v49k() ;
	VALID _r1p11v4dq() ;
	MESSAGE "Rango del Listado"
@ 5,20 GET M.INICIO ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 ;
	VALID LAST()=27 .OR. (SEEK(M.INICIO) .AND. SGET("WIN2")) ;
	MESSAGE "C줰igo de Cuenta Inicial" ;
	ERROR "CUENTA INEXISTENTE"
@ 5,30 SAY iif(empty(inicio),"",saynom(inicio)) ;
	SIZE 1,39 ;
	PICTURE "@!"
@ 6,20 GET M.FINAL ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 .AND. !EMPTY(INICIO) .AND. LAST()#27 ;
	VALID _r1p11v4ln() ;
	MESSAGE "C줰igo de Cuenta Final - [0] = / [1] Pr쥅 / [9] Ult. del Grupo" ;
	ERROR "CUENTA INEXISTENTE"
@ 6,30 SAY iif(empty(final),"",saynom(final)) ;
	SIZE 1,39 ;
	PICTURE "@!"
@ 8,20 GET AP ;
	PICTURE "@*RHN \<Acumulado;\<Peri줰ico" ;
	SIZE 1,13,6 ;
	DEFAULT 1 ;
	WHEN LAST()#27 ;
	VALID _r1p11v4vh() ;
	MESSAGE "Rango de Fechas del Listado"
@ 10,20 GET perini ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN .F. ;
	VALID perini>0 .AND. perini<13 ;
	MESSAGE "Per죓do Inicial" ;
	ERROR "EL PERIODO DEBE SER ENTRE 1 Y 12"
@ 10,23 SAY ALLTRIM(KMESES[PERINI]) ;
	SIZE 1,25 ;
	PICTURE "@!"
@ 10,49 GET M.FECINI ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	PICTURE "@E" ;
	WHEN PORFECHA ;
	VALID _r1p11v565() ;
	MESSAGE "Fecha Inicial del Listado" ;
	ERROR "LA FECHA NO PUEDE SER ANTERIOR QUE LA INICIAL DEL SISTEMA"
@ 11,20 GET perfin ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN ap="A" .AND. LAST()#27 ;
	VALID _r1p11v5ce() ;
	MESSAGE "Per죓do Final" ;
	ERROR "EL PERIODO DEBE SER ENTRE 1 Y 12"
@ 11,23 SAY ALLTRIM(KMESES[PERFIN]) ;
	SIZE 1,25 ;
	PICTURE "@!"
@ 11,49 GET M.FECFIN ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	PICTURE "@E" ;
	WHEN PORFEC ;
	VALID _r1p11v5j2() ;
	MESSAGE "Fecha Inicial del Listado" ;
	ERROR "LA FECHA FINAL NO PUEDE SER ANTERIOR A LA INICIAL NI POSTERIOR A LA FINAL DEL SISTEMA"
@ 13,36 GET ARRASMES ;
	PICTURE "@*RHN \<S;\<No" ;
	SIZE 1,6,10 ;
	DEFAULT 1 ;
	WHEN LAST()#27 ;
	VALID _r1p11v5sa() ;
	MESSAGE "ARRASTRA SALDOS DE LOS MESES ANTERIORES ?"
@ 14,36 GET ARRASANIO ;
	PICTURE "@*RHN S\<i;N\<o" ;
	SIZE 1,6,10 ;
	DEFAULT 1 ;
	WHEN ARRASMES=1 .AND. LAST()#27 ;
	VALID _r1p11v5z7() ;
	MESSAGE "ARRASTRA LOS SALDOS DEL BALANCE DEL A쩙 ANTERIOR ?"
@ 16,20 GET npag ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN PORPRIN .AND. LAST()#27 ;
	MESSAGE "N de p쟥ina Inicial del Listado"
@ 16,31 GET m.opcion ;
	PICTURE "@*HN \!Confirma;\?Anula" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _r1p11v66g() ;
	MESSAGE "Confirma la Selecci줻 Realizada ?"

IF NOT WVISIBLE("win2")
	ACTIVATE WINDOW win2
ENDIF

READ CYCLE ;
	SHOW _r1p11v6q8()

RELEASE WINDOW win2

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISMAY/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=MEN_LIN(SISNOMBRE)
RETURN M.SALIDA

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V40A           mniv VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   13    
*        Variable:            mniv                               
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v40a     &&  mniv VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ENDIF
IF mniv<1 .OR. mniv>8
   RETURN .F.
ENDIF
SELE BAL
SET ORDER TO TAG NIVEL
FOR XX=MNIV TO 1 STEP -1
IF SEEK(XX)
   SET ORDER TO TAG CODIGO
   RETURN .T.
ENDIF
NEXT
=TECNIV()
_CUROBJ=1
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V49K           mlim WHEN                          
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   15    
*        Variable:            mlim                               
*        Called By:           WHEN Clause                        
*        Object Type:         Radio Button                       
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v49k     &&  mlim WHEN
#REGION 1
IF EMPTY(KREPORTE)
   RETURN .T.
ENDIF
RETURN 5

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V4DQ           mlim VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   15    
*        Variable:            mlim                               
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v4dq     &&  mlim VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   IF MLIM=1	
     _CUROBJ=7
   ELSE
     _CUROBJ=5
   ENDIF
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V4LN           M.FINAL VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   18    
*        Variable:            M.FINAL                            
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v4ln     &&  M.FINAL VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ENDIF
IF M.FINAL<2
   M.FINAL=M.INICIO+M.FINAL
   =SGET("WIN2")
ELSE
   IF M.FINAL=9
      M.FINAL=(INT(M.INICIO/10000000)+1)*10000000
      SEEK M.FINAL
      SKIP -1
      M.FINAL=CODIGO
      =SGET("WIN2")
   ELSE
      IF M.FINAL<10000000 .OR. M.FINAL>FINFIN
         =SGET("WIN2")
         WAIT "LOS CODIGOS ESTAN ENTRE 10000000 Y "+STR(FINFIN,8) WIND NOWA
         RETURN .F.
      ENDIF
   ENDIF
ENDIF
RETURN SEEK(M.FINAL) .AND. SGET("WIN2")

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V4VH           AP VALID                           
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   20    
*        Variable:            AP                                 
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v4vh     &&  AP VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   if ap="P"
      STORE KPERIODO TO PERINI
      ANN=YEAR(FECINORI)
      STORE CTOD(ALLT(STR(PERINI))+"/01/"+STR(ANN,4)) TO FECINI
      IF FECINI<FECINORI
         STORE CTOD(ALLT(STR(PERINI))+"/01/"+STR(ANN+1,4)) TO FECINI
      ENDIF
      STORE GOMONTH(FECINI,1)-1 TO FECFIN
      =SGET("WIN2")
      if porfec
        return 2
      else
         return 5
      ENDIF
   endif
   return IIF(PORFEC,3,4)
ENDIF
_CUROBJ=7
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V565           M.FECINI VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   23    
*        Variable:            M.FECINI                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v565     &&  M.FECINI VALID
#REGION 1
IF EMPTY(FECINI)
   KEYB CHR(27)
ENDIF
IF FECINI<FECINORI
   RETURN .F.
ENDIF
=SGET("WIN2")
_curobj=11
RETURN

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V5CE           perfin VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   24    
*        Variable:            perfin                             
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v5ce     &&  perfin VALID
#REGION 1
=SGET("WIN2")
IF PORFEC
      RETURN 1
   ELSE
      RETURN 2
   ENDIF
RETURN .t.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V5J2           M.FECFIN VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   26    
*        Variable:            M.FECFIN                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v5j2     &&  M.FECFIN VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ENDIF
IF EMPTY(M.FECFIN)
   RETURN .F.
ENDIF
STORE MONTH(FECFIN) TO PERFIN
P1=PERINI
P2=PERFIN
IF KPERINIC#1
   IF PERFIN<KPERINIC
      P2=12+P2
   ENDIF
ENDIF
IF P2>=P1
    =SGET("WIN2")
   RETURN 1
ENDIF
RETURN SGET("WIN2")

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V5SA           ARRASMES VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   27    
*        Variable:            ARRASMES                           
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      9                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v5sa     &&  ARRASMES VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   IF ARRASMES=2
      STORE 2 TO M.ARRASANIO
      =SGET("WIN2")
      return 3
   ELSE
      RETURN 2
   ENDIF
ENDIF
_curobj=13
RETURN .T.



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V5Z7           ARRASANIO VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   28    
*        Variable:            ARRASANIO                          
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      10                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v5z7     &&  ARRASANIO VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   RETURN IIF(ARRASANIO=1,2,1)
ENDIF
_CUROBJ=15
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V66G           m.opcion VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY,     Record Number:   30    
*        Variable:            m.opcion                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      11                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v66g     &&  m.opcion VALID
#REGION 1
DO CASE
CASE M.OPCION=2
STORE .F. TO SALIDA
CLEA READ
CASE M.OPCION=1
STORE "" TO F1,F2,F3,F4,F5
ARRASANIO=(ARRASANIO=1)
ARRASMES=(ARRASMES=1)


F1='NIVEL<='+ALLTRIM(STR(MNIV))

IF !EMPTY(KREPORTE)
   F2='!EMPTY(AT("'+ALLTRIM(KREPORTE)+'",REPORTE))'
ENDIF

IF MLIM=2 .AND. (INICIO#INIINI .OR. FINAL#FINFIN)
   F3='CODIGO>='+STR(INICIO,8)+" .AND. CODIGO<="+STR(FINAL,8)
ENDIF

IF AP="P"
   IF !ARRASANIO .AND. !ARRASMES
      F4="(!EMPTY(DEBE"+ALLTRIM(STR(PERINI))+") .OR. !EMPTY(HABER"+ALLTRIM(STR(PERINI))+"))"
   ELSE
      F4="HAYSALDO("+;
      ALLTRIM(STR(PERFIN))+;
      ","+;
      IIF(ARRASANIO,".T.",".F.")+;
      ")"
   ENDIF
ENDIF

FISC='IMPUTABLE="I"'
FISC=QW_FISC(FISC,F1)
FISC=QW_FISC(FISC,F2)
FISC=QW_FISC(FISC,F3)
FISC=QW_FISC(FISC,F4)

FISC1='!EMPTY(BAL1.NOMBRE) .AND. '
IF AP="P"
   FISC1=FISC1+"PERIODO="+ALLTRIM(STR(KPERIODO))
ELSE
   IF KPERINIC=1 .OR. PERINI<=PERFIN
   FISC1=FISC1+"PERIODO>="+ALLTRIM(STR(PERINI))+" .AND. PERIODO<="+ALLTRIM(STR(PERFIN))
   ELSE
   FISC1=FISC1+"PERIODO>="+ALLTRIM(STR(PERINI))+" .OR. PERIODO<="+ALLTRIM(STR(PERFIN))
   ENDIF
ENDIF

CLEA READ
ENDCASE
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V6Q8           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISMAY                             
*        Called By:           READ Statement                     
*        Snippet Number:      12                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v6q8     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: LISMAY
*
#REGION 1
IF SYS(2016) = "WIN2" OR SYS(2016) = "*"
	ACTIVATE WINDOW win2 SAME
	@ 5,30 SAY iif(empty(inicio),"",saynom(inicio)) ;
		SIZE 1,39, 0 ;
		PICTURE "@!"
	@ 6,30 SAY iif(empty(final),"",saynom(final)) ;
		SIZE 1,39, 0 ;
		PICTURE "@!"
	@ 10,23 SAY ALLTRIM(KMESES[PERINI]) ;
		SIZE 1,25, 0 ;
		PICTURE "@!"
	@ 11,23 SAY ALLTRIM(KMESES[PERFIN]) ;
		SIZE 1,25, 0 ;
		PICTURE "@!"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF