*
*                               MUESTRA EL ASIENTO
*
* MUESTRA.PRG
* GOYO / 10-04-93 02:27am
PARAMETER MUTIT
=WIN0()
SELE MOV
SET ORDE TO TAG MOVIMIE
SEEK STR(KPERIODO,2)+STR(NROASI,4)
STORE 0 TO C,TDEBE,THABER
DO MUESTR_1
SCAN while ASIENTO=NROASI .and. PERIODO=KPERIODO
   @C,1 say CODIGO     PICT "@#"
   @C,10 say MOVIMIENTO PICT "@X"
   @C,15 say SAYNOM(CODIGO) PICT "@X"
   @C,46 say DEBE PICT PICU1
   @C,63 say HABER PICT PICU1
   STORE DEBE+TDEBE TO TDEBE
   STORE HABER+THABER TO THABER
   store C+1 to C
   if C>21
      =TECLA(24)
      DO MUESTR_1
   endif
enDS
@C,46 say REPL("-",34)
store C+1 to C
@C,30 say "TOTAL"
@C,46 say TDEBE  PICT PICU1
@C,63 say THABER PICT PICU1
return

PROCEDURE MUESTR_1
CLEA
C=5
IF EMPTY(MUTIT)
@0,1 SAY "MES:"+ALLTRIM(KMESES[KPERIODO])
ELSE
@0,1 SAY PARSE("MES:"+ALLTRIM(KMESES[KPERIODO]),MUTIT,78)
ENDIF
@1,1 say "ASIENTO: "+str(ASIENTO,4)
@2,1 say REPL("-",78)
@3,1 say " CUENTA  MOV.             NOMBRE                        DEBE            HABER"
@4,1 say REPL("-",78)
RETURN