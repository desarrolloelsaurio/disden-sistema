*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/07/95             LISDIA.PRG                17:40:16 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1995 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS eltit,porprin

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 LISDIA/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

ELTIT=IIF(EMPTY(ELTIT)," Listado de Libro Diario ",ELTIT)
SELE MOV
SET ORDER TO TAG MOVIMIE

=SEEK(STR(KPERIODO,2))
STORE MOV.ASIENTO TO M.INICIO,M.INIINI
=SEEK(STR(KPERIODO+1,2))
SKIP -1
STORE MOV.ASIENTO TO M.FINAL,M.FINFIN
STORE 1 TO NPAG
store .t. to m.salida

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

DEFINE WINDOW win2 ;
	FROM INT((SROW()-11)/2),INT((SCOL()-51)/2) ;
	TO INT((SROW()-11)/2)+10,INT((SCOL()-51)/2)+50 ;
	TITLE eltit ;						
	FOOTER ' '+empresa+' ' ;
	NOFLOAT ;
	NOCLOSE ;
	SHADOW ;
	NOMINIMIZE ;
	DOUBLE ;
	COLOR SCHEME 1


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISDIA/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("win2")
	ACTIVATE WINDOW win2 SAME
ELSE
	ACTIVATE WINDOW win2 NOSHOW
ENDIF
@ 1,1 SAY "L죑ite" ;
	SIZE 1,6, 0
@ 2,20 SAY "Inicio" ;
	SIZE 1,6, 0
@ 3,20 SAY "Final" ;
	SIZE 1,5, 0
@ 2,26 SAY ":" ;
	SIZE 1,1, 0
@ 3,26 SAY ":" ;
	SIZE 1,1, 0
@ 5,1 SAY "Comienza en p쟥ina" ;
	SIZE 1,18, 0
@ 1,20 GET mlim ;
	PICTURE "@*RHN \<Todos;\<Rango" ;
	SIZE 1,9,9 ;
	DEFAULT 1 ;
	VALID _r1p11vjgn() ;
	MESSAGE "Rango del Listado"
@ 2,28 GET M.INICIO ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 ;
	VALID LAST()=27 .OR. (SEEK(STR(KPERIODO,2)+STR(M.INICIO,4)) .AND. SGET("WIN2")) ;
	MESSAGE "N de Asiento Inicial" ;
	ERROR "ASIENTO INEXISTENTE"
@ 3,28 GET M.FINAL ;
	SIZE 1,8 ;
	RANGE INICIO, FINFIN ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 .AND. !EMPTY(M.INICIO) ;
	VALID LAST()=27 .OR. (SEEK(STR(KPERIODO,2)+STR(M.final,4)) .AND. SGET("WIN2")) ;
	MESSAGE "N de Asiento Final" ;
	ERROR "ASIENTO INEXISTENTE"
@ 5,20 GET npag ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN PORPRIN ;
	MESSAGE "N de p쟥ina Inicial del Listado"
@ 7,14 GET m.opcion ;
	PICTURE "@*HN \!Confirma;\?Anula" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _r1p11vjqh() ;
	MESSAGE "Confirma la Selecci줻 Realizada ?"

IF NOT WVISIBLE("win2")
	ACTIVATE WINDOW win2
ENDIF

READ CYCLE

RELEASE WINDOW win2

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISDIA/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=MEN_LIN(SYSNOMBRE)
return m.salida

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VJGN           mlim VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISDIA,     Record Number:    8    
*        Variable:            mlim                               
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vjgn     &&  mlim VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   IF MLIM=1	
     _CUROBJ=5
   ELSE
     _CUROBJ=3
   ENDIF
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VJQH           m.opcion VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISDIA,     Record Number:   12    
*        Variable:            m.opcion                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vjqh     &&  m.opcion VALID
#REGION 1
DO CASE
CASE M.OPCION=2
STORE .F. TO SALIDA
CLEA READ
CASE M.OPCION=1
STORE "PERIODO="+ALLTRIM(STR(KPERIODO)) TO Fisc1

IF MLIM=2 .AND. (INICIO#INIINI .OR. FINAL#FINFIN)
   Fisc1=FISC1+' .AND. asiento>='+alltrim(STR(INICIO,8))+" .AND. asiento<="+alltrim(STR(FINAL,8))
ENDIF

CLEA READ
ENDCASE
RETURN .T.