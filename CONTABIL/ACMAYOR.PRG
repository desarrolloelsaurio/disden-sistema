*
*                                ACUMULA PARA MAYOR
*
* ACMAYOR.PRG
* GOYO / OCTUBRE 10-07-93 08:14PM
ELAANT=ALIAS()
SELE BAL1
IF ARRASANIO
	STORE DEBE0-HABER0 TO SB
ELSE
	STORE 0 TO SB
ENDIF
IF ARRASMES
	IF KPERINIC=PERINI
		SI=0
	ELSE
		SI=0
		STORE KPERINIC TO PER
		STORE CODIGO TO ANTERIOR
		SCAT TO ACNADA
		AC_PERIODO=KPERIODO-1
		FOR PER=KPERINIC TO IIF(AC_PERIODO<KPERINIC,AC_PERIODO+12,AC_PERIODO)
			PER2=IIF(PER>12,PER-12,PER)
			POSIC=(PER2+2)*2
			SI=SI+ACNADA[POSIC]-ACNADA[POSIC+1]
		NEXT
	ENDIF
ELSE
	SI=0
ENDIF
SM=0
IF PORFEC
   SELE MOV1
   SET ORDER TO TAG INICIO
   CALC SUM(HABER),SUM(DEBE) ;
   FOR CODIGO=BAL1.CODIGO ;
   TO D1,H1
   STORE D1-H1 TO SM
   SET ORDER TO TAG CODIGO
ENDIF
SELE (ELAANT)
RELE ACNADA
RETURN
