*
*                         APERTURA DE ARCHIVOS
*
* APERTURA.PRG
* GOYO / OCTUBRE DE 1993

IF FILE("XBALANCE.DBF")
	SELE 1
	USE XBALANCE ALIAS BAL
	IF !FILE("XBALANCE.CDX")
		WAIT "REINDEXANDO..." WIND NOWA
		=INDEX1()
		WAIT CLEA
	ENDIF
ELSE
	=aper1("BALANCE")
ENDIF

IF FILE("XMOVIMIE.DBF")
	SELE 2
	USE XMOVIMIE ALIAS MOV
	IF !FILE("XMOVIMIE.CDX")
		WAIT "REINDEXANDO..." WIND NOWA
		=INDEX2()
		WAIT CLEA
	ENDIF
ELSE
	=aper1("MOVIMIENTOS")
ENDIF

IF !FILE("XVARIABL.MEM")
	WAIT "RECONSTRUYENDO..." WIND NOWA
	STOR "     " TO KREPORTE
	STOR 1 TO KPERINIC,KPERIODO
	STOR "  ENERO  " TO KMESES[1]
	STOR " FEBRERO " TO KMESES[2]
	STOR "  MARZO  " TO KMESES[3]
	STOR "  ABRIL  " TO KMESES[4]
	STOR "  MAYO   " TO KMESES[5]
	STOR "  JUNIO  " TO KMESES[6]
	STOR "  JULIO  " TO KMESES[7]
	STOR " AGOSTO  " TO KMESES[8]
	STOR "SETIEMBRE" TO KMESES[9]
	STOR " OCTUBRE " TO KMESES[10]
	STOR "NOVIEMBRE" TO KMESES[11]
	STOR "DICIEMBRE" TO KMESES[12]
	STOR 1 TO KASIENTO,KMOVIMIENTO
	STOR 10000000 TO XCOMP,XVTA,XCRFV,XDBFV,XCRFC,XDBFC
	STOR 18 TO TIVA1
	STOR 9 TO TIVA2
	STOR "  " TO PROPIOIVA
	STOR IIF(TYPE("KPRES")#"C","1",KPRES) TO KPRES
	DO GRABA
	WAIT CLEA
	=CARTEL("ATENCION ! ! !",;
	"El archivo de VARIABLES no fue encontrado.",;
	"Ejecute la 6¦ opci¢n del sub-menu de ",;
	"Mantenimiento de Archivos")
ENDIF
DO CARGA
=MEN_LIN(SYSNOMBRE)
RETURN

FUNCTION aper1
	PARAMETERS AP_T1
	=CARTEL("ATENCION ! ! !",;
	"El archivo de "+AP_T1+" no fue encontrado",;
	"Es imposible arrancar el sistema",;
	"sin ese archivo")
	CLEA
	QUIT
RETURN
