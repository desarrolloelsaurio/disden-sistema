*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/07/95             LISBAL.PRG                17:40:19 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1995 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS eltitulo,porprin,elperiodo,completo

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 LISBAL/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
ELTITULO=" "+ALLTRIM(ELTITULO)+" "
STORE {} TO FE1,FE2,FECINI,FECINORI,FECFIN,FECFINORI
=GETFEC()
SELE BAL
SET ORDER TO TAG CODIGO
GO TOP
STORE CODIGO TO INICIO,INIINI
GO BOTT
STORE CODIGO TO FINAL,FINFIN
store .t. to m.salida
STORE KPERINIC TO PERINI
STORE KPERIODO TO PERFIN
STORE 1 TO ACUMANIO,MPAG
STORE IIF(ELPERIODO,1,2) TO ACUMMES


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

DEFINE WINDOW win2 ;
	FROM INT((SROW()-22)/2),INT((SCOL()-72)/2) ;
	TO INT((SROW()-22)/2)+21,INT((SCOL()-72)/2)+71 ;
	TITLE ELTITULO ;						
	FOOTER ' '+EMPRESA+' / '+ALLTRIM(KMESES[KPERIODO])+' ' ;
	NOFLOAT ;
	NOCLOSE ;
	SHADOW ;
	NOMINIMIZE ;
	DOUBLE ;
	COLOR SCHEME 1


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISBAL/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("win2")
	ACTIVATE WINDOW win2 SAME
ELSE
	ACTIVATE WINDOW win2 NOSHOW
ENDIF
@ 5,13 SAY "Inicio" ;
	SIZE 1,6, 0
@ 6,13 SAY "Final" ;
	SIZE 1,5, 0
@ 1,37 SAY "Reporte" ;
	SIZE 1,7, 0
@ 16,1 SAY "Comienza en p쟥ina" ;
	SIZE 1,18, 0
@ 13,1 SAY "Arrastra Saldos meses anteriores" ;
	SIZE 1,32, 0
@ 14,1 SAY "Arrastra Saldos a쨚 anterior" ;
	SIZE 1,28, 0
@ 8,1 SAY "Tipo de Listado" ;
	SIZE 1,15, 0
@ 1,1 SAY "Cuentas de Nivel" ;
	SIZE 1,16, 0
@ 3,1 SAY "L죑ite de Cuentas" ;
	SIZE 1,17, 0
@ 10,13 SAY "Desde" ;
	SIZE 1,5, 0
@ 11,13 SAY "Hasta" ;
	SIZE 1,5, 0
@ 1,20 GET mniv ;
	SIZE 1,1 ;
	DEFAULT 0 ;
	PICTURE "9" ;
	VALID _r1p11vm3z() ;
	MESSAGE "Nivel de las Cuentas del Listado - [ESC] para Men" ;
	ERROR "EL NIVEL DE LAS CUENTAS DEBE ESTAR ENTRE 1 Y 8"
@ 1,54 GET kreporte ;
	SIZE 1,5 ;
	DEFAULT " " ;
	PICTURE "!!!!!" ;
	WHEN .F.
@ 3,20 GET mlim ;
	PICTURE "@*RHN \<Todas;\<Rango" ;
	SIZE 1,9,8 ;
	DEFAULT 1 ;
	WHEN _r1p11vmd9() ;
	VALID _r1p11vmhf() ;
	MESSAGE "Rango del Listado"
@ 5,20 GET M.INICIO ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 ;
	VALID LAST()=27 .OR. (SEEK(M.INICIO) .AND. SGET("WIN2")) ;
	MESSAGE "C줰igo de Cuenta Inicial" ;
	ERROR "CUENTA INEXISTENTE"
@ 5,30 SAY iif(empty(inicio),"",saynom(inicio)) ;
	SIZE 1,39 ;
	PICTURE "@!"
@ 6,20 GET M.FINAL ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 .AND. !EMPTY(INICIO) ;
	VALID _r1p11vmpp() ;
	MESSAGE "C줰igo de Cuenta Final - [0] = / [1] Pr쥅 / [9] Ult. del Grupo" ;
	ERROR "CUENTA INEXISTENTE"
@ 6,30 SAY iif(empty(final),"",saynom(final)) ;
	SIZE 1,39 ;
	PICTURE "@!"
@ 8,20 GET AP ;
	PICTURE "@*RHN \<Acumulado;\<Peri줰ico" ;
	SIZE 1,13,6 ;
	DEFAULT 1 ;
	VALID _r1p11vmzi() ;
	MESSAGE "Rango de Fechas del Listado"
@ 10,20 GET perini ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN .F. ;
	VALID perini>0 .AND. perini<13 ;
	MESSAGE "Per죓do Inicial" ;
	ERROR "EL PERIODO DEBE SER ENTRE 1 Y 12"
@ 10,23 SAY ALLTRIM(KMESES[PERINI]) ;
	SIZE 1,25 ;
	PICTURE "@!"
@ 11,20 GET perfin ;
	SIZE 1,2 ;
	DEFAULT 0 ;
	PICTURE "99" ;
	WHEN ap="A" ;
	VALID _r1p11vn88() ;
	MESSAGE "Per죓do Final" ;
	ERROR "EL PERIODO DEBE SER ENTRE 1 Y 12"
@ 11,23 SAY ALLTRIM(KMESES[PERFIN]) ;
	SIZE 1,25 ;
	PICTURE "@!"
@ 13,36 GET ARRASMES ;
	PICTURE "@*RHN \<S;\<No" ;
	SIZE 1,6,10 ;
	DEFAULT 1 ;
	WHEN LAST()#27 ;
	VALID _r1p11vnha() ;
	MESSAGE "ARRASTRA SALDOS DE LOS MESES ANTERIORES ?"
@ 14,36 GET ARRASANIO ;
	PICTURE "@*RHN S\<i;N\<o" ;
	SIZE 1,6,10 ;
	DEFAULT 1 ;
	WHEN LAST()#27 .AND. ARRASMES=1 ;
	VALID _r1p11vnod() ;
	MESSAGE "ARRASTRA LOS SALDOS DEL BALANCE DEL A쩙 ANTERIOR ?"
@ 16,20 GET npag ;
	SIZE 1,4 ;
	DEFAULT 0 ;
	PICTURE "9999" ;
	WHEN LAST()#27 .AND. PORPRIN ;
	MESSAGE "N de p쟥ina Inicial del Listado"
@ 18,24 GET m.opcion ;
	PICTURE "@*HN \!Confirma;\?Anula" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _r1p11vnus() ;
	MESSAGE "Confirma la Selecci줻 Realizada ?"

IF NOT WVISIBLE("win2")
	ACTIVATE WINDOW win2
ENDIF

READ CYCLE ;
	SHOW _r1p11vo6u()

RELEASE WINDOW win2

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISBAL/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=MEN_LIN(SISNOMBRE)
RETURN M.SALIDA

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VM3Z           mniv VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   13    
*        Variable:            mniv                               
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vm3z     &&  mniv VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ENDIF
IF mniv<1 .OR. mniv>8
   RETURN .F.
ENDIF
SELE BAL
SET ORDER TO TAG NIVEL
FOR XX=MNIV TO 1 STEP -1
IF SEEK(XX)
   SET ORDER TO TAG CODIGO
   RETURN .T.
ENDIF
NEXT
=TECNIV()
_CUROBJ=1
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VMD9           mlim WHEN                          
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   15    
*        Variable:            mlim                               
*        Called By:           WHEN Clause                        
*        Object Type:         Radio Button                       
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vmd9     &&  mlim WHEN
#REGION 1
IF EMPTY(KREPORTE)
   RETURN .T.
ENDIF
RETURN 5

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VMHF           mlim VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   15    
*        Variable:            mlim                               
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vmhf     &&  mlim VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   IF MLIM=1	
     _CUROBJ=7
   ELSE
     _CUROBJ=5
   ENDIF
else
_CUROBJ=2
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VMPP           M.FINAL VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   18    
*        Variable:            M.FINAL                            
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vmpp     &&  M.FINAL VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ENDIF
IF M.FINAL<2
   M.FINAL=M.INICIO+M.FINAL
   =SGET("WIN2")
ELSE
   IF M.FINAL=9
      M.FINAL=(INT(M.INICIO/10000000)+1)*10000000
      SEEK M.FINAL
      SKIP -1
      M.FINAL=CODIGO
      =SGET("WIN2")
   ELSE
      IF M.FINAL<10000000 .OR. M.FINAL>FINFIN
         =SGET("WIN2")
         WAIT "LOS CODIGOS ESTAN ENTRE 10000000 Y "+STR(FINFIN,8) WIND NOWA
         RETURN .F.
      ENDIF
   ENDIF
ENDIF
RETURN SEEK(M.FINAL) .AND. SGET("WIN2")

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VMZI           AP VALID                           
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   20    
*        Variable:            AP                                 
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vmzi     &&  AP VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   if left(ap,1)="P"
      STORE KPERIODO TO PERINI
      STORE 2 TO M.ARRASMES,ARRASANIO
      =SGET("WIN2")
      return 7
   endif
   return 2
ENDIF
_CUROBJ=7
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VN88           perfin VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   23    
*        Variable:            perfin                             
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vn88     &&  perfin VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ENDIF
P1=PERINI
P2=PERFIN
IF KPERINIC#1
   IF PERFIN<KPERINIC
      P2=12+P2
   ENDIF
ENDIF
IF P2>=P1
    =SGET("WIN2")
   RETURN 1
ENDIF
RETURN .F.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VNHA           ARRASMES VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   25    
*        Variable:            ARRASMES                           
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vnha     &&  ARRASMES VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   IF ARRASMES=2
      STORE 2 TO M.ARRASANIO
      =SGET("WIN2")
      return 3
   ELSE
      RETURN 2
   ENDIF
ENDIF
_curobj=11
RETURN .T.



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VNOD           ARRASANIO VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   26    
*        Variable:            ARRASANIO                          
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vnod     &&  ARRASANIO VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   RETURN IIF(ARRASANIO=1,2,1)
ENDIF
_CUROBJ=13
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VNUS           m.opcion VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL,     Record Number:   28    
*        Variable:            m.opcion                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      9                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vnus     &&  m.opcion VALID
#REGION 1
DO CASE
CASE M.OPCION=2
STORE .F. TO SALIDA
CLEA READ
CASE M.OPCION=1

STORE "" TO F1,F2,F3,F4,F5
ARRASANIO=(ARRASANIO=1)
ARRASMES=(ARRASMES=1)

F1='NIVEL<='+ALLTRIM(STR(MNIV))

IF !EMPTY(KREPORTE)
   F2='!EMPTY(AT("'+ALLTRIM(KREPORTE)+'",REPORTE))'
ENDIF

IF MLIM=2 .AND. (INICIO#INIINI .OR. FINAL#FINFIN)
   F3='CODIGO>='+STR(INICIO,8)+" .AND. CODIGO<="+STR(FINAL,8)
ENDIF

FISC=IIF(COMPLETO,"","IMPUTABLE='I'")
FISC=QW_FISC(FISC,F1)
FISC=QW_FISC(FISC,F2)
FISC=QW_FISC(FISC,F3)

CLEA READ
ENDCASE
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11VO6U           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISBAL                             
*        Called By:           READ Statement                     
*        Snippet Number:      10                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11vo6u     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: LISBAL
*
#REGION 1
IF SYS(2016) = "WIN2" OR SYS(2016) = "*"
	ACTIVATE WINDOW win2 SAME
	@ 5,30 SAY iif(empty(inicio),"",saynom(inicio)) ;
		SIZE 1,39, 0 ;
		PICTURE "@!"
	@ 6,30 SAY iif(empty(final),"",saynom(final)) ;
		SIZE 1,39, 0 ;
		PICTURE "@!"
	@ 10,23 SAY ALLTRIM(KMESES[PERINI]) ;
		SIZE 1,25, 0 ;
		PICTURE "@!"
	@ 11,23 SAY ALLTRIM(KMESES[PERFIN]) ;
		SIZE 1,25, 0 ;
		PICTURE "@!"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF