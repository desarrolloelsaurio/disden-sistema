*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/07/95             LISCUE.PRG                17:39:52 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1995 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS eltit

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 LISCUE/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=SGET("WIN2")
ELTIT=IIF(EMPTY(ELTIT)," Listado de Plan de Cuentas ",ELTIT)
SELE BAL
SET ORDER TO TAG CODIGO
GO TOP
STORE CODIGO TO INICIO,INIINI
GO BOTT
STORE CODIGO TO FINAL,FINFIN
store .t. to m.salida

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

DEFINE WINDOW win2 ;
	FROM INT((SROW()-11)/2),INT((SCOL()-67)/2) ;
	TO INT((SROW()-11)/2)+10,INT((SCOL()-67)/2)+66 ;
	TITLE eltit ;						
	FOOTER ' '+empresa+' ' ;
	NOFLOAT ;
	NOCLOSE ;
	SHADOW ;
	NOMINIMIZE ;
	DOUBLE ;
	COLOR SCHEME 1


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISCUE/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("win2")
	ACTIVATE WINDOW win2 SAME
ELSE
	ACTIVATE WINDOW win2 NOSHOW
ENDIF
@ 1,1 SAY "Nivel" ;
	SIZE 1,5, 0
@ 2,1 SAY "Tipo" ;
	SIZE 1,4, 0
@ 3,1 SAY "L죑ite" ;
	SIZE 1,6, 0
@ 4,10 SAY "Inicio" ;
	SIZE 1,6, 0
@ 5,10 SAY "Final" ;
	SIZE 1,5, 0
@ 4,16 SAY ":" ;
	SIZE 1,1, 0
@ 5,16 SAY ":" ;
	SIZE 1,1, 0
@ 6,1 SAY "Reporte" ;
	SIZE 1,7, 0
@ 1,10 GET MNIV ;
	PICTURE "@*RHN \<1;\<2;\<3;\<4;\<5;\<6;\<7;\<8;\<9" ;
	SIZE 1,5,1 ;
	DEFAULT 9 ;
	WHEN SGET("WIN2") ;
	VALID _r1p11v0nw() ;
	MESSAGE "Nivel a Listar"
@ 2,10 GET mimp ;
	PICTURE "@*RHN \<Imputables;\<No Imputables;\<Ambas" ;
	SIZE 1,17,1 ;
	DEFAULT 3 ;
	WHEN sget("win2") ;
	VALID _r1p11v0t5() ;
	MESSAGE "Tipo de Cuenta a Listar"
@ 3,10 GET mlim ;
	PICTURE "@*RHN \<Todas;\<Rango" ;
	SIZE 1,9,9 ;
	DEFAULT 1 ;
	VALID _r1p11v0yc() ;
	MESSAGE "Rango del Listado"
@ 4,18 GET M.INICIO ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 ;
	VALID LAST()=27 .OR. (SEEK(M.INICIO) .AND. SGET("WIN2")) ;
	MESSAGE "C줰igo de Cuenta Inicial" ;
	ERROR "CUENTA INEXISTENTE"
@ 4,28 SAY iif(empty(inicio),"",saynom(inicio)) ;
	SIZE 1,35 ;
	PICTURE "@!"
@ 5,18 GET M.FINAL ;
	SIZE 1,8 ;
	RANGE INICIO, FINFIN ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN mlim=2 .AND. !EMPTY(INICIO) ;
	VALID LAST()=27 .OR. (SEEK(M.FINAL) .AND. SGET("WIN2")) ;
	MESSAGE "C줰igo de Cuenta Final" ;
	ERROR "CUENTA INEXISTENTE"
@ 5,28 SAY iif(empty(final),"",saynom(final)) ;
	SIZE 1,35 ;
	PICTURE "@!"
@ 6,10 GET mrep ;
	SIZE 1,5 ;
	DEFAULT " " ;
	PICTURE "!!!!!" ;
	MESSAGE "Reporte a Listar"
@ 7,41 GET m.opcion ;
	PICTURE "@*HN \!Confirma;\?Anula" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _r1p11v196() ;
	MESSAGE "Confirma la Selecci줻 Realizada ?"

IF NOT WVISIBLE("win2")
	ACTIVATE WINDOW win2
ENDIF

READ CYCLE ;
	SHOW _r1p11v1m9()

RELEASE WINDOW win2

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LISCUE/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=MEN_LIN(SYSNOMBRE)
return m.salida

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V0NW           MNIV VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISCUE,     Record Number:   10    
*        Variable:            MNIV                               
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v0nw     &&  MNIV VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   _CUROBJ=10
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V0T5           mimp VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISCUE,     Record Number:   11    
*        Variable:            mimp                               
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v0t5     &&  mimp VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   _CUROBJ=13
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V0YC           mlim VALID                         
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISCUE,     Record Number:   12    
*        Variable:            mlim                               
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v0yc     &&  mlim VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   IF MLIM=1	
     _CUROBJ=17
   ELSE
     _CUROBJ=15
   ENDIF
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V196           m.opcion VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISCUE,     Record Number:   18    
*        Variable:            m.opcion                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v196     &&  m.opcion VALID
#REGION 1
DO CASE
CASE M.OPCION=2
STORE .F. TO SALIDA
CLEA READ
CASE M.OPCION=1
STORE "" TO F1,F2,F3,F4
IF MNIV#9
   F1='NIVEL='+ALLTRIM(STR(MNIV))
ENDIF

F2=IIF(MIMP="A","",'IMPUTABLE="'+LEFT(MIMP,1)+'"')

IF MLIM=2 .AND. (INICIO#INIINI .OR. FINAL#FINFIN)
   F3='CODIGO>='+STR(INICIO,8)+" .AND. CODIGO<="+STR(FINAL,8)
ENDIF

IF !EMPTY(MREP)
   F4='!EMPTY(AT("'+ALLTRIM(MREP)+'",REPORTE))'
ENDIF

FISC=QW_FISC(FISC,F1)
FISC=QW_FISC(FISC,F2)
FISC=QW_FISC(FISC,F3)
FISC=QW_FISC(FISC,F4)
FISC=IIF(EMPTY(FISC),'.T.',FISC)
CLEA READ
ENDCASE
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R1P11V1M9           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LISCUE                             
*        Called By:           READ Statement                     
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r1p11v1m9     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: LISCUE
*
#REGION 1
IF SYS(2016) = "WIN2" OR SYS(2016) = "*"
	ACTIVATE WINDOW win2 SAME
	@ 4,28 SAY iif(empty(inicio),"",saynom(inicio)) ;
		SIZE 1,35, 0 ;
		PICTURE "@!"
	@ 5,28 SAY iif(empty(final),"",saynom(final)) ;
		SIZE 1,35, 0 ;
		PICTURE "@!"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF