#DEFINE CRLF CHR(13)+CHR(10)                   && CRLF
#DEFINE PAIP   "|"                             && PAIP
=WORKING()
=DOTALK()
SET ORDER TO TAG TALCOD IN PER
SET ORDER TO TAG NUMERO IN COR
SELE FAX
SET ORDER TO
SET RELA TO NUMERO INTO COR
TMP=GENTMP()
=FLOCK("FAX") .OR. FLOK("FAX")
FISC="TIPO='@' .AND. (!EMPTY(EEC) .OR. !EMPTY(ESC)) .AND. EMPTY(SEC) .AND. EMPTY(SSC)"
TT1="TODAS LAS ORDENES"
=FABNTZ()
SORT ON COR.ARTICULO TO (TMP) FOR &FISC
SELE FAX
USE
USE (TMP) ALIAS FAX EXCL
SET RELA TO NUMERO INTO COR
REPL ALL AVI WITH COR.ARTICULO
SET RELA TO TALLER INTO PER
REPL ALL POSIC WITH VAL(PER.NU1)
REPL FAX.EEC WITH NUL FOR POSIC=1
SELE MIX
SET ORDER TO TAG ETACOD
COUNT TO MAXETA
EXTERNAL ARRAY TOTLIN,TOTRUB,TOTTOT
DIME TITULO[MAXETA],TOTLIN[MAXETA],TOTRUB[MAXETA],TOTTOT[MAXETA]
STORE NUL TO TOTLIN,TOTRUB,TOTTOT
ACLA=PAIP+;
PADC("ARTICULO",10)+PAIP+;
IIF(LG_PORP,"",PADC("DESCRIPCION",30)+PAIP)
STORE 1 TO INDICE
SCAN
	STORE MIX.TEXTO1 TO TITULO[INDICE]
	STORE INDICE+1 TO INDICE
ENDSCAN
FOR A=1 TO MAXETA
	ACLA=ACLA+PADC(ALLTRIM(TITULO[A]),XACDIGI)+PAIP
NEXT
ACLA=ACLA+PADC("TOTAL",XACDIGI)+PAIP
TTU="Listado de pendientes y Cortes previstos"+;
crlf+;
TT1+CRLF+;
"por Art¡culo"
=UNTALK()
=UNWORK()
STORE NUL TO CASOS
SELE FAX
GO TOP
ELART=FAX.AVI
IF LG_PORP
	DO LPREVP
ELSE
	SET ORDER TO TAG ARTIRED IN MER
	SELE COR
	SET RELA TO ARTICULO INTO MER ADDI
	DO LPREVI
ENDIF
RETURN REOPFAB()
