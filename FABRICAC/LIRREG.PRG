* EL PROGRAMA LISTA CORTES CON IRREGULARIDADES
* 1. CORTES ABIERTOS SIN REMITOS PENDIENTES
* 2. CORTES CON DIFERENCIAS EN LAS ENTRADAS
* 3. CORTES CON DIFERENCIAS EN LAS SALIDAS
* 4. CORTES CON MAS SALIDAS QUE ENTRADAS
* COPIRAYS (C) by GOYO 18/10/95 13:19
PROCEDURE LIRREG
	#DEFINE BOTOM  "  "+repl("°",78)              && BOTOM
	#DEFINE PAIP   "|"                            && PAIP
	EXTERNAL PROCEDURE LIRREG0.PRG
	=WORKING()
	=DOTALK()
	=OPCOR()
	SELE COR
	SET ORDER TO
	TMPCOR=GENTMP()
	=FLOCK() .OR. FLOK()
	COPY TO (TMPCOR) FOR EMPTY(FECHAFIN)
	=UNLO_PRX("COR",TMPCOR,"TMPCOR")
	INDEX ON NUMERO TAG NUMERO
	SET ORDER TO TAG NUMERO
	=OPFAB()
	SELE FAX
	SET RELA TO NUMERO INTO TMPCOR
	TMPFAX=GENTMP()
	=FLOCK() .OR. FLOK()
	COPY TO (TMPFAX) ;
		FIELD NUMERO,REMITO,EEC,ESC,SEC,SSC FOR TIPO="@" ;
		.AND. !EMPTY(TMPCOR.NUMERO)
	=UNLO_PRX("FAX",TMPFAX,"TMPFAX")
	INDEX ON NUMERO TAG NUMERO
	SET ORDER TO TAG NUMERO
	TMPTOT=GENTMP()
	TOTAL ON NUMERO TO (TMPTOT) FIELD EEC,ESC,SEC,SSC
	=PRXAREA(.T.)
	USE (TMPTOT) ALIAS TMPTOT EXCL
	DELE FOR EEC=ESC .AND. SEC=SSC .AND. EEC>SEC
	PACK
	DIFENT=GENTMP()
	DIFSAL=GENTMP()
	MASSAL=GENTMP()
	CERRAD=GENTMP()

	* CORTES CON DIFERENCIAS EN ENTRADAS
	SELE TMPTOT
	COPY TO (DIFENT) FOR EEC#ESC
	=PRXAREA(.T.)
	USE (DIFENT) ALIAS DIFENT

	* CORTES CON DIFERENCIAS EN SALIDAS
	SELE TMPTOT
	COPY TO (DIFSAL) FOR SEC#SSC
	=PRXAREA(.T.)
	USE (DIFSAL) ALIAS DIFSAL

	* CORTES CON DIFERENCIAS MAS SALIDAS QUE ENTRADAS
	SELE TMPTOT
	COPY TO (MASSAL) FOR SEC=SSC .AND. EEC=ESC .AND. EEC>SEC
	=PRXAREA(.T.)
	USE (MASSAL) ALIAS MASSAL

	* CORTES SIN PENDIENTES
	SELE TMPTOT
	COPY TO (CERRAD) FOR SEC=SSC .AND. EEC=ESC .AND. SEC=EEC
	=PRXAREA(.T.)
	USE (CERRAD) ALIAS CERRAD
	acla=PAIP+PADC("N§ CORTE",10)+PAIP
	=UNTALK()
	=UNWORK()

	* CORTES CON DIFERENCIAS EN ENTRADAS
	SELE DIFENT
	IF !EMPTY("DIFENT"))
		TT="Cortes con Diferencias en Entradas al Taller"
		=LGRL2(PORP,"DIFENT","LIRREG0()","DIF. ENTRADA","LIRRENT")
	ENDIF

	* CORTES CON DIFERENCIAS EN SALIDAS
	SELE DIFSAL
	IF !EMPTY("DIFSAL"))
		TT="Cortes con Diferencias en Salidas del Taller"
		=LGRL2(PORP,"DIFSAL","LIRREG0()","DIF. SALIDA","LIRRSAL")
	ENDIF

	* CORTES CON MAS SALIDAS QUE ENTRADAS
	SELE MASSAL
	IF !EMPTY("MASSAL"))
		TT="Cortes con m s Salidas globales que Entradas"
		=LGRL2(PORP,"MASSAL","LIRREG0()","MAS SALIDAS QUE ENTRADAS","LIRMSAL")
	ENDIF

	* CORTES SIN REMITOS PENDIENTES
	SELE CERRAD
	IF !EMPTY("CERRAD"))
		TT="Cortes abiertos sin Remitos pendientes"
		=LGRL2(PORP,"CERRAD","LIRREG0()","SIN PENDIENTES","LIRRSPEN")
	ENDIF
	=OFF_TMP()
RETURN MEN_LIN(BOTOM)
