*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/29/96              LPMIO.PRG                09:16:42 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS ppan

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                  LPMIO/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

STORE 1 TO FILCOR,FILMER,FILTAL,FILFEC,FILPRC,MINOBJ,FILRANK
STORE "" TO TTCOR,TTMER,TTTAL,TTFEC,FISC,TTQUE,TTPRC,TTRANK
STORE ".T." TO QUECOR,QUEMER,QUETAL,QUEFEC,QUEPRC
STORE 2 TO MAXOBJ
STORE {} TO M.FECINI,M.FECFIN
STORE .F. TO M.HUBORES

CANT_MAX=13
DIME TEXTO[CANT_MAX,2],VARIABLE[CANT_MAX],HABILITADO[CANT_MAX],HABILANT[CANT_MAX],TTL[CANT_MAX],CTRL[CANT_MAX]

TEXTO[1,1]="N O. "+UPPER(KORTE)
TEXTO[2,1]="ARTICULO"
TEXTO[3,1]="DENOMINACION"
TEXTO[4,1]="F.INICIO"
TEXTO[5,1]="F.FINAL."
TEXTO[6,1]="DIAS"
TEXTO[7,1]="INICIAL"
TEXTO[8,1]="TERM. 1"
TEXTO[9,1]="TERM. 2 Esp"
TEXTO[10,1]="TERM. 2"
TEXTO[11,1]="TOTAL TERM."
TEXTO[12,1]="REPROCESO"
TEXTO[13,1]="PERD. TOTAL"

TEXTO[1,2]=10
TEXTO[2,2]=10
TEXTO[3,2]=30
TEXTO[4,2]=8
TEXTO[5,2]=8
TEXTO[6,2]=4
TEXTO[7,2]=XACDIGI
TEXTO[8,2]=XACDIGI
TEXTO[9,2]=XACDIGI
TEXTO[10,2]=XACDIGI
TEXTO[11,2]=XACDIGI
TEXTO[12,2]=XACDIGI
TEXTO[13,2]=XACDIGI


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("lfabnt",	INT((SROW()-11)/2), INT((SCOL()-74)/2), INT((SROW()-11)/2)+10, INT((SCOL()-74)/2)+73, ;
 " Listado de Ordenes de Corte - Ordenes Terminadas "		,' '+janname+' ')		


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LPMIO/MS-DOS Screen Layout                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("lfabnt")
	ACTIVATE WINDOW lfabnt SAME
ELSE
	ACTIVATE WINDOW lfabnt NOSHOW
ENDIF
@ 4,1 SAY "Ranking por" ;
	SIZE 1,11, 0
@ 1,1 GET m.filor ;
	PICTURE "@*RVN \<Todas las Ordenes;\<Opciones" ;
	SIZE 1,21,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ites por Orden de "+favri
@ 1,24 GET m.filmer ;
	PICTURE "@*RVN \<Todos los Art죅ulos;\<Opciones" ;
	SIZE 1,23,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ites de Productos"
@ 1,51 GET m.filfec ;
	PICTURE "@*RVN \<Todas las Fechas;\<Entre Fechas" ;
	SIZE 1,20,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,5) ;
	MESSAGE "L죑ite de Fechas"
@ 5,1 GET m.filrank ;
	PICTURE "@*RHN \<Duraci줻 ;De \<1;\<Terminado ;\<Reproceso ;\<P굍dida" ;
	SIZE 1,14,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "Listado Ordernado por"
@ 7,25 GET m.opcion ;
	PICTURE "@*HN \!Acepta;\?Rechaza" ;
	SIZE 1,11,2 ;
	DEFAULT 1 ;
	VALID _rcj0jvyrs()

IF NOT WVISIBLE("lfabnt")
	ACTIVATE WINDOW lfabnt
ENDIF

READ CYCLE

=RELEWIN("lfabnt")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       LPMIO/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=RELEWIN("LFABNT")
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JVYRS           m.opcion VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LPMIO,     Record Number:    7     
*        Variable:            m.opcion                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jvyrs     &&  m.opcion VALID
#REGION 1
IF M.OPCION=2
   CLEA READ
   RETURN .T.
ENDIF

IF READKEY()=15 .OR. READKEY()=271 .OR. READKEY()=5 .OR. READKEY()=261
   STORE .T. TO HABILITADO
   STORE .F. TO VARIABLE
   STORE QW_MER(3,24,"MER.ARTICULO") TO HABILITADO[2],HABILITADO[3]
   IF M.FILOR=1
      SELE COR
      SET ORDER TO
      CALC MIN(FECHAFIN),MAX(FECHAFIN) TO M.FECINI,M.FECFIN
   ELSE
      STORE {} TO M.FECINI,M.FECFIN
      STORE qw_FEC(7,1,'COR.FECHAFIN') TO HABILITADO[6]
   ENDIF
   *=qw_prc(7,50,"PRC")
   ***** FISC

   *FISC=qw_fisc(FISC,quemer)
   *FISC=qw_FISC(FISC,quefec)
   ****** TITULOS
   *QW_TT(TTMER)+QW_TT(TTFEC)
   IF PPAN
   STORE .F. TO VARIABLE[5],;
   VARIABLE[7],;
   HABILITADO[5],;
   HABILITADO[7],;
   VARIABLE[3],;
   HABILITADO[3]
   ENDIF
   =ACOPY(HABILITADO,HABILANT)
   DO WHILE CFGFAC()
      =WORKING()
      =DOTALK()
      RELE TTL,CTRL
      DIME TTL[CANT_MAX],CTRL[CANT_MAX]
      STORE .F. TO HAY
      =TTLCHEQ(6)

      CREATE CURSOR TEMPO ;
        (NUMERO N(10),;
        ARTICULO C(10),;
        MERCA    C(30),;
        FECHAINI D,;
        FECHAFIN D,;
        DIAS N(4,0),;
        TERM1 N(10,2),;
        TERM2 N(10,2),;
        TERM2E N(10,2),;
        REPROCESO N(10,2),;
        PERDIDO N(10,2),;
        TTER N(10,2),;
        CANTINI N(10,2))

      SELE TEMPO
      APPE BLAN
      APPE FROM DBF("FAB") FOR ;
        !EMPTY(FECHAFIN) .AND. ;
        FECHAFIN<=M.FECFIN .AND. ;
        FECHAFIN>=M.FECINI
      GO TOP
      DELE
      SET ORDER TO TAG ARTIRED IN MER
      SET RELA TO ARTICULO INTO MER
      DELE FOR !&QUEMER
      IF !PPAN
         REPL ALL MERCA WITH MER.MERCA
      ENDIF
      SET RELA OFF INTO MER
      REPL ALL TTER WITH TERM1+TERM2+TERM2E
      REPL ALL DIAS WITH FECHAFIN-FECHAINI
      SELE TEMPO
      DO CASE
      CASE FILRANK=1
         QUERANK="DIAS"
         ASCDES="A"
         TTRANK="Duraci줻 del Proceso"
      CASE FILRANK=2
         QUERANK="TERM1"
         ASCDES="D"
         TTRANK="Cantidad de Art죅ulos de Primera"
      CASE FILRANK=3
         ASCDES="D"
         QUERANK="TTER"
         TTRANK="Cantidad de Art죅ulos Disponibles"
      CASE FILRANK=4
         QUERANK="REPROCESO"
         ASCDES="A"
         TTRANK="Cantidad de Art죅ulos a Reproceso"
      CASE FILRANK=4
         ASCDES="A"
         QUERANK="PERDIDO"
         TTRANK="Cantidad de Art죅ulos Totalmente Irrecuperables"
      ENDCASE
      TTRANK="Ranking por "+ttrank

      =UNTALK()
      =UNWORK()
      STORE NUL TO CASOS,TTL
      STORE .T. TO HAY
      ACLA=HAZ_ACLA()
      M.LINEA=REPL("=",LEN(ACLA))
      TT="Listado de Rendimiento"+;
        CHR(10)+CHR(13)+;
        "Ordenes de "+korte+;
        " terminadas entre el "+dtoc(m.fecini)+" y el "+dtoc(m.fecfin)+;
        IIF(ISALPHA(TTMER),TTMER,"")+;
        CHR(10)+CHR(13)+TTRANK

      IF ASCDES="A"
         INDEX ON &QUERANK TAG TEMPO ASCE
      ELSE
         INDEX ON &QUERANK TAG TEMPO DESC
      ENDIF
      SET ORDER TO TAG TEMPO

      IF PPAN
         DO LPMIOP
      ELSE
         DO LPMIOI
      ENDIF
      USE IN TEMPO
      =ACOPY(HABILANT,HABILITADO)
   ENDDO
ENDIF
ACTI WIND LFABNT
CLEA
_CUROBJ=1
STORE 1 TO MINOBJ
STORE 2 TO MAXOBJ
RETURN SGET("LFABNT")
