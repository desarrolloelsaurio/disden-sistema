*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/29/96             LFABNT.PRG                09:16:23 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS ppan

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 LFABNT/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

ULPR=HORA_ULP(PROGRAM())
IF CHEQSEG()
** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
#DEFINE ABA    "Abriendo Base de "               && ABA
#DEFINE NUL    0                                 && NUL
#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
#DEFINE PICUMA1 "9,999,999,999,999"              && PICUMA1
#DEFINE PAIP   "|"                               && PAIP
#DEFINE FOLC  ".F."                              && FOLC
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
#DEFINE FOLL  .F.                                && FOLL
#DEFINE TRUC  ".T."                              && TRUC
#DEFINE TRUL  .T.                                && TRUL
#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
#DEFINE ELYES  "SI"                              && ELYES
#DEFINE ELNOU  "NO"                              && ELNOU
#DEFINE ONE    1                                 && ONE
#DEFINE TWO    2                                 && TWO
#DEFINE THREE  3                                 && THREE
#DEFINE FOUR   4                                 && FOUR
#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
#DEFINE RH      36 								 && RH
#DEFINE RP 		47 								 && RP
#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE

** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end

STORE 1 TO FILCOR,FILMER,FILTAL,FILFEC,FILPRC,FILFET
STORE "" TO TTCOR,TTMER,TTTAL,TTFEC,FISC,TTQUE,TTPRC,TTFET
STORE ".T." TO QUECOR,QUEMER,QUETAL,QUEFEC,QUEPRC,QUEFET
STORE 1 TO MINOBJ
STORE 2 TO MAXOBJ
STORE .F. TO HUBORES

CANT_MAX=8
DIME TEXTO[CANT_MAX,2],VARIABLE[CANT_MAX],HABILITADO[CANT_MAX],HABILANT[CANT_MAX],ttl[CANT_MAX],ctrl[CANT_MAX]

TEXTO[1,1]='N O. '+UPPER(KORTE)
TEXTO[2,1]='REMITO'
TEXTO[3,1]='ARTICULO'
TEXTO[4,1]='DENOMINACION'
TEXTO[5,1]='TALLER'
TEXTO[6,1]=' FECHA  '
TEXTO[7,1]='CANTIDAD'
TEXTO[8,1]='DIAS'

TEXTO[1,2]=10
TEXTO[2,2]=15
TEXTO[3,2]=10
TEXTO[4,2]=30
TEXTO[5,2]=30
TEXTO[6,2]=8
TEXTO[7,2]=XACDIGI
TEXTO[8,2]=XACDIGI


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("lfabnt",	INT((SROW()-13)/2), INT((SCOL()-77)/2), INT((SROW()-13)/2)+12, INT((SCOL()-77)/2)+76, ;
 " Listado de Ordenes de Corte Pendientes "		,' '+janname+' ')		


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LFABNT/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("lfabnt")
	ACTIVATE WINDOW lfabnt SAME
ELSE
	ACTIVATE WINDOW lfabnt NOSHOW
ENDIF
@ 4,1 SAY "FECHA DE FABRICACION" ;
	SIZE 1,20, 0
@ 4,26 SAY "FECHA ENTRADA TALLER" ;
	SIZE 1,20, 0
@ 1,1 GET m.filor ;
	PICTURE "@*RVN \<Todas las Ordenes;\<Opciones" ;
	SIZE 1,21,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ites por Orden de "+favri
@ 1,26 GET m.filmer ;
	PICTURE "@*RVN \<Todos los Art죅ulos;\<Opciones" ;
	SIZE 1,23,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ites de Productos"
@ 1,52 GET m.filtal ;
	PICTURE "@*RVN \<Todos los Talleres;\<Un Taller" ;
	SIZE 1,22,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ites de Taller"
@ 5,1 GET m.filfec ;
	PICTURE "@*RVN \<Todas las Fechas;\<Entre Fechas" ;
	SIZE 1,20,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ite de Fechas de Inicio de Fabricaci줻"
@ 5,26 GET m.filfet ;
	PICTURE "@*RVN \<Todas las Fechas;\<Entre Fechas" ;
	SIZE 1,20,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ite de Fechas de Entrada al Taller"
@ 5,52 GET m.filprc ;
	PICTURE "@*RVN \<Todos los Procesos;\<Opciones" ;
	SIZE 1,22,0 ;
	DEFAULT 1 ;
	WHEN BETW(_CUROBJ,MINOBJ,MAXOBJ) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ites de Procesos de Fabricaci줻"
@ 9,26 GET m.opcion ;
	PICTURE "@*HN \!Acepta;\?Rechaza" ;
	SIZE 1,11,1 ;
	DEFAULT 1 ;
	VALID _rcj0jvkdw()

IF NOT WVISIBLE("lfabnt")
	ACTIVATE WINDOW lfabnt
ENDIF

READ CYCLE


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      LFABNT/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=RELEWIN("LFABNT")
ELSE
=IAUDI()
ENDIF
RETURN MEN_LIN(BOTOM)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JVKDW           m.opcion VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         LFABNT,     Record Number:   10    
*        Variable:            m.opcion                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jvkdw     &&  m.opcion VALID
#REGION 1
IF M.OPCION=2
   CLEA READ
   RETURN .T.
ENDIF

IF READKEY()=15 .OR. READKEY()=271 .OR. READKEY()=5 .OR. READKEY()=261
   STORE .T. TO HABILITADO
   STORE .F. TO VARIABLE
   STORE QW_MER(4,31,"MER.ARTICULO") TO HABILITADO[4],HABILITADO[3]
   STORE QW_TALS(7,1,'FAX.TALLER') TO HABILITADO[5]
   =QW_PRC(7,52,"FAX.PRC")
   STORE {} TO M.NUINI,NUFIN
   STORE QW_FEC(7,31,'COR.FECHAINI') TO HABILITADO[6]
   QUEFE1=QUEFEC
   TTFE1=TTFEC
   FILFE1=FILFEC
   STORE FILFET TO FILFEC
   STORE {} TO M.NUINI,NUFIN
   STORE "" TO M.QUEFEC
   IF QW_FEC(7,31,'FAX.EF')
      QUEFET=QUEFEC
      QUEFEC=QUEFE1
      TTFET='Fecha de Ingreso al Taller:'+TTFEC
      TTFEC=TTFE1
   ENDIF
   TTFEC='Fecha de Inicio de la O.C.:'+TTFEC
   ***** FISC
   FISC="EMPTY(FAX.SF) .AND. !EMPTY(FAX.EF)"
   FISC=qw_fisc(FISC,QUEPRC)
   FISC=qw_fisc(FISC,quemer)
   FISC=qw_FISC(FISC,quetal)
   FISC=qw_FISC(FISC,quefec)
   FISC=qw_FISC(FISC,quefet)
   tt1=""
   =fabntz()
   ****** TITULOS
   TTQUE=QW_TT(TTMER)+QW_TT(TTTAL)+QW_TT(TTFEC)+QW_TT(TTFET)+QW_TT(TTPRC)+qw_tt(tt1)
   =ACOPY(HABILITADO,HABILANT)
   TTORI=TTQUE
   FISC=QW_FISC(FISC,"FAX.TIPO='@'")
   DO WHILE CFGFAC()
	M.OPTAR=ALGUN(40," Orden del Listado ",;
	"\<N즡ero de Orden de Corte;"+;
	"\<Art죅ulo;"+;
	"\<Fecha")
	IF EMPTY(M.OPTAR)
	   EXIT
	ENDIF
      =WORKING()
      =DOTALK()
      SET ORDER TO TAG NUMERO IN CO1
      SET ORDER TO TAG NUMERO IN COR
      SET ORDER TO TAG TALCOD IN PER
      SET ORDER TO TAG ARTIRED IN MER
      SELE COR
      SET RELA TO NUMERO INTO CO1
      SET RELA TO ARTICULO INTO MER ADDI
      SELE FAX
      SET ORDER TO
      SET RELA TO NUMERO INTO COR ADDI
      SET RELA TO TALLER INTO PER ADDI
      SET ORDER TO
      TMP=GENTMP()
      if optar=1
      SORT ON NUMERO TO (TMP) FOR &FISC ;
        FIELD NUMERO,;
        REMITO,;
        COR.ARTICULO,;
        MER.MERCA,;
        PER.CLIENTE,;
        EF,;
        EEC
       TTQUE=TTORI+;
       CRLF+;
       "Ordenado por N즡ero de O.C."
      else
      if m.optar=2
         SORT ON MER.ARTICULO,NUMERO TO (TMP) FOR &FISC ;
        FIELD NUMERO,;
        REMITO,;
        COR.ARTICULO,;
        MER.MERCA,;
        PER.CLIENTE,;
        EF,;
        EEC
       TTQUE=TTORI+;
       CRLF+;
       "Ordenado por Art죅ulo"
        else
        SORT ON ef,NUMERO TO (TMP) FOR &FISC ;
        FIELD NUMERO,;
        REMITO,;
        COR.ARTICULO,;
        MER.MERCA,;
        PER.CLIENTE,;
        EF,;
        EEC
       TTQUE=TTORI+;
       CRLF+;
       "Ordenado por Fecha Recepci줻 Taller"
      endif
      endif
      SELE FAX
      USE (TMP) ALIAS FAX EXCL
      ACLA=HAZ_ACLA()
      M.LINEA=REPL("=",LEN(ACLA))
      TT="Listado de Estado de Ordenes de Fabricaci줻"+chr(13)+chr(10)+"Procesos no Terminados"+iif(!empty(ttque),ttque,"")
      STORE NUL TO CASOS
      STORE .F. TO TTL,CTRL,HAY	
      =TTLCHEQ(7)
      IF HAY
      STORE .F. TO CTRL[7]
      ENDIF
      =UNTALK()
      =UNWORK()
      =IIF(PPAN,LFABNTP(),LFABNTI())
      =OFF_TMP()
      =OPFAB()
      =ACOPY(HABILANT,HABILITADO)
*      RELE TTL,CTRL
 *     DIME ttl[CANT_MAX],ctrl[CANT_MAX]
   ENDDO
ENDIF
ACTI WIND LFABNT
CLEA
_CUROBJ=1
STORE 1 TO FILCOR,FILMER,FILTAL,FILFEC,FILPRC
STORE "" TO TTCOR,TTMER,TTTAL,TTFEC,FISC,TTQUE,TTPRC
STORE ".T." TO QUECOR,QUEMER,QUETAL,QUEFEC,QUEPRC
STORE 1 TO MINOBJ
STORE 2 TO MAXOBJ
STORE .F. TO HUBORES
RETURN SGET("LFABNT")
