#DEFINE ONE    1                                 && ONE
#DEFINE TWO    2                                 && TWO
#DEFINE NUL    0                                 && NUL
#DEFINE PAIP   "|"                               && PAIP

FUNCTION LPREV1
EXTERNAL ARRAY TOTLIN,TOTRUB,TOTTOT
	? PAIP
	?? ELART
	=IIF(LG_PORP,"",QOUT(PAIP+SAYGRL(ELART,"MER","ARTIRED","MER.MERCA")))
	?? PAIP
	STORE NUL TO TL
	SELE COR
	SET ORDER TO
	COUNT TO TOTLIN[1] FOR ARTICULO=ELART .AND. EMPTY(FECHAFAB)
	SELE FAX
	FOR X=1 TO MAXETA
		?? STR(TOTLIN[X],XACDIGI)
		?? PAIP
		TOTRUB[X]=TOTRUB[X]+TOTLIN[X]
		TOTTOT[X]=TOTTOT[X]+TOTLIN[X]
		TL=TL+TOTLIN[X]
	NEXT
	?? STR(TL,XACDIGI)
	?? PAIP
	STORE NUL TO TOTLIN
	ELART=FAX.AVI
RETURN .T.
