*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/29/96            IFIN_FAB.PRG               09:19:05 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("finfab",	INT((SROW()-19)/2), INT((SCOL()-61)/2), INT((SROW()-19)/2)+18, INT((SCOL()-61)/2)+60, ;
 " Finalizaci줻 de Orden "		,' '+janname+' ')		


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                IFIN_FAB/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

ULPR=HORA_ULP(PROGRAM())
IF CHEQSEG()
   SELE COR
   STORE .F. TO COMPLETA
   IF EMPTY(COR.FECHAFIN)
** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
#DEFINE ABA    "Abriendo Base de "               && ABA
#DEFINE NUL    0                                 && NUL
#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
#DEFINE PICUMA1 "9,999,999,999,999"              && PICUMA1
#DEFINE PAIP   "|"                               && PAIP
#DEFINE FOLC  ".F."                              && FOLC
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
#DEFINE FOLL  .F.                                && FOLL
#DEFINE TRUC  ".T."                              && TRUC
#DEFINE TRUL  .T.                                && TRUL
#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
#DEFINE ELYES  "SI"                              && ELYES
#DEFINE ELNOU  "NO"                              && ELNOU
#DEFINE ONE    1                                 && ONE
#DEFINE TWO    2                                 && TWO
#DEFINE THREE  3                                 && THREE
#DEFINE FOUR   4                                 && FOUR
#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
#DEFINE RH      36 								 && RH
#DEFINE RP 		47 								 && RP
#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE

** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end

      STORE .T. TO OK
      =MCORX(.f.,.t.)
      IF CONFIRMA("Ingresar datos a Orden de "+favri,.T.,20,0)
       =LOCK("COR") .OR. LOK("COR")
       SCAT MEMV
       SELE EST
       SET ORDER TO TAG ARTICULO
       IF SEEK (LEFT(COR.ARTICULO,10)+"/"+COR.ESTRUC)
		   STORE {} TO MAXFEC
    	   STORE NUL TO XTERM1, XTERM1L, XTERM2, XTERM2L, ;
          		XREINTEGRO, XPERDIDO, XCANTFIN, XREPROCESO
     		M.CANTFIN = M.TERM1+M.TERM2+M.TERM2E+M.TERM1L


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     IFIN_FAB/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("finfab")
	ACTIVATE WINDOW finfab SAME
ELSE
	ACTIVATE WINDOW finfab NOSHOW
ENDIF
@ 1,1 SAY "Fecha de Inicio" ;
	SIZE 1,15, 0
@ 2,1 SAY "Fecha de Finalizaci줻" ;
	SIZE 1,21, 0
@ 3,1 SAY "Cantidad Programada" ;
	SIZE 1,19, 0
@ 4,1 SAY "Cantidad Iniciada" ;
	SIZE 1,17, 0
@ 6,1 SAY "Productos de 1" ;
	SIZE 1,15, 0
@ 8,1 SAY "Productos de 2 Esp." ;
	SIZE 1,20, 0
@ 9,1 SAY "Productos de 2" ;
	SIZE 1,15, 0
@ 12,1 SAY "P굍dida Absoluta" ;
	SIZE 1,16, 0
@ 13,1 SAY "Cantidad Final" ;
	SIZE 1,14, 0
@ 7,1 SAY "Productos de 1 Local" ;
	SIZE 1,21, 0
@ 10,1 SAY "Reintegro" ;
	SIZE 1,9, 0
@ 11,1 SAY "Anulaci줻 Pedido" ;
	SIZE 1,16, 0
@ 1,25 GET m.fechaini ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN _rcj0jz0tj()
@ 2,25 SAY m.fechafin ;
	SIZE 1,8
@ 3,23 SAY m.cantcor ;
	SIZE 1,10
@ 4,23 SAY m.cantini ;
	SIZE 1,10
@ 6,23 GET m.Xterm1 ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN last()#27 .and. ok ;
	VALID posit(m.Xterm1) .AND. SGET("FINFAB") ;
	MESSAGE "Cantidad de Productos Terminados de Primera" ;
	ERROR nomenor("0")
@ 6,36 SAY m.term1 ;
	SIZE 1,10
@ 6,48 SAY m.term1+M.XTERM1 ;
	SIZE 1,10
@ 7,23 GET m.Xterm1l ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN last()#27 .and. ok ;
	VALID posit(m.Xterm1l) .AND. SGET("FINFAB") ;
	MESSAGE "Cantidad de Productos Terminados de Primera al Local" ;
	ERROR nomenor("0")
@ 7,36 SAY m.term1l ;
	SIZE 1,10
@ 7,48 SAY m.term1l+m.Xterm1l ;
	SIZE 1,10
@ 8,23 GET m.Xterm2e ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN last()#27 .and. ok ;
	VALID posit(m.Xterm2e) .AND. SGET("FINFAB") ;
	MESSAGE "Cantidad de Productos Terminados de Segunda Especial" ;
	ERROR nomenor("0")
@ 8,36 SAY m.term2e ;
	SIZE 1,10
@ 8,48 SAY m.term2e+m.Xterm2e ;
	SIZE 1,10
@ 9,23 GET m.Xterm2 ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN last()#27 .and. ok ;
	VALID posit(m.Xterm2) .AND. SGET("FINFAB") ;
	MESSAGE "Cantidad de Productos Terminados de Segunda" ;
	ERROR nomenor("0")
@ 9,36 SAY m.term2 ;
	SIZE 1,10
@ 9,48 SAY m.term2+m.Xterm2 ;
	SIZE 1,10
@ 10,23 GET m.Xreintegro ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN last()#27 .and. ok ;
	VALID posit(m.Xreintegro) .AND. SGET("FINFAB") ;
	MESSAGE "Cantidad de Productos a Reintegrados por los Talleres" ;
	ERROR nomenor("0")
@ 10,36 SAY m.reintegro ;
	SIZE 1,10
@ 10,48 SAY m.reintegro+m.Xreintegro ;
	SIZE 1,10
@ 11,23 GET m.XREPROCESO ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN last()#27 .and. ok ;
	VALID posit(m.Xreproceso) .AND. SGET("FINFAB") ;
	MESSAGE "Cantidad de Productos a Anulados por los Talleres" ;
	ERROR nomenor("0")
@ 11,36 SAY m.reproceso ;
	SIZE 1,10
@ 11,48 SAY m.reproceso+m.Xreproceso ;
	SIZE 1,10
@ 12,23 GET m.Xperdido ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN last()#27 .and. ok ;
	VALID posit(m.Xperdido) .AND. SGET("FINFAB") ;
	MESSAGE "Cantidad de Productos Perdidos por Completo" ;
	ERROR nomenor("0")
@ 12,36 SAY m.perdido ;
	SIZE 1,10
@ 12,48 SAY m.perdido+m.Xperdido ;
	SIZE 1,10
@ 13,23 GET m.Xcantfin ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN _rcj0jz1gi()
@ 13,36 SAY m.cantfin ;
	SIZE 1,10
@ 13,48 SAY m.cantfin+m.Xcantfin ;
	SIZE 1,10
@ 15,19 GET m.opcion ;
	PICTURE "@*HN \<Confirma;\?\<Anula" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _rcj0jz1mp() ;
	MESSAGE "Conrfirma los Datos de Finalizaci줻 de la Orden de Corte ?"

IF NOT WVISIBLE("finfab")
	ACTIVATE WINDOW finfab
ENDIF

READ CYCLE ;
	SHOW _rcj0jz1ua()

=RELEWIN("finfab")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     IFIN_FAB/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
      ELSE
         =CARTEL("LA ESTRUCTURA DEL ARTICULO "+ALLTRIM(EST.ARTICULO),;
           "NO HA SIDO ENCONTRADA",;
           "ES IMPOSIBLE CERRAR LA ORDEN DE CORTE SIN LA ESTRUCTURA",;
           "PULSE [ENTER] PARA CONTINUAR")
      ENDIF
   ENDIF
ELSE
   =CARTEL("LA ORDEN DE CORTE N "+ALLTRIM(STR(COR.NUMERO)),;
     "HA SIDO FINALIZADA EL DIA "+DTOC(COR.FECHAFIN),;
     "ES IMPOSIBLE HACER CORRECCIONES SOBRE LOS DATOS INGRESADOS",;
     "PULSE [ENTER] PARA CONTINUAR")
ENDIF
=RELEWIN("cor")
ELSE
=IAUDI()
ENDIF
UNLO ALL
=RELEWIN("FINFAB")
=RELEWIN("WIN1")
=RELEWIN("COR")
RETURN MEN_LIN(BOTOM) .AND. COMPLETA


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JZ0TJ           m.fechaini WHEN                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFIN_FAB,     Record Number:   14  
*        Variable:            m.fechaini                         
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jz0tj     &&  m.fechaini WHEN
#REGION 1
=WORKING()
SELE CO1
CALC SUM(CANTINI) FOR NUMERO=COR.NUMERO TO M.CANTINI
CALC SUM(CANTCOR) FOR NUMERO=COR.NUMERO TO M.CANTCOR
=UNWORK()
RETURN !SGET("FINFAB")


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JZ1GI           m.Xcantfin WHEN                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFIN_FAB,     Record Number:   39  
*        Variable:            m.Xcantfin                         
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jz1gi     &&  m.Xcantfin WHEN
#REGION 1
if last()=27 .or. !ok
   return .f.
endif
m.Xcantfin=m.Xterm1+m.Xterm2+m.Xterm2e+m.Xterm1l
return sget("finfab")

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JZ1MP           m.opcion VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFIN_FAB,     Record Number:   42  
*        Variable:            m.opcion                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jz1mp     &&  m.opcion VALID
#REGION 1
M.PARC=M.TERM1+M.TERM2E+M.TERM2+M.REINTEGRO+M.PERDIDO+M.TERM1L
IF M.OPCION=1
   IF CONFIRMA("Grabar las Modificaciones",.t.,20,10)
      M.TERM1=M.TERM1+M.XTERM1
      M.TERM2=M.TERM2+M.XTERM2
      M.REINTEGRO=M.REINTEGRO+M.XREINTEGRO
      M.PERDIDO=M.PERDIDO+M.XPERDIDO
      M.REPROCESO=M.REPROCESO+M.XREPROCESO
      =AGRABAR1("COR")
      =IAUD(STR(NUMERO))
      IF COR.CANTFIN+COR.PERDIDO+COR.REINTEGRO = COR.CANTINI
		STORE .T. TO COMPLETA
      ENDIF
   ENDIF
ENDIF
CLEA READ
RETURN .T.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JZ1UA           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFIN_FAB                           
*        Called By:           READ Statement                     
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jz1ua     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: IFIN_FAB
*
#REGION 1
IF SYS(2016) = "FINFAB" OR SYS(2016) = "*"
	ACTIVATE WINDOW finfab SAME
	@ 2,25 SAY m.fechafin ;
		SIZE 1,8, 0
	@ 3,23 SAY m.cantcor ;
		SIZE 1,10, 0
	@ 4,23 SAY m.cantini ;
		SIZE 1,10, 0
	@ 6,36 SAY m.term1 ;
		SIZE 1,10, 0
	@ 6,48 SAY m.term1+M.XTERM1 ;
		SIZE 1,10, 0
	@ 7,36 SAY m.term1l ;
		SIZE 1,10, 0
	@ 7,48 SAY m.term1l+m.Xterm1l ;
		SIZE 1,10, 0
	@ 8,36 SAY m.term2e ;
		SIZE 1,10, 0
	@ 8,48 SAY m.term2e+m.Xterm2e ;
		SIZE 1,10, 0
	@ 9,36 SAY m.term2 ;
		SIZE 1,10, 0
	@ 9,48 SAY m.term2+m.Xterm2 ;
		SIZE 1,10, 0
	@ 10,36 SAY m.reintegro ;
		SIZE 1,10, 0
	@ 10,48 SAY m.reintegro+m.Xreintegro ;
		SIZE 1,10, 0
	@ 11,36 SAY m.reproceso ;
		SIZE 1,10, 0
	@ 11,48 SAY m.reproceso+m.Xreproceso ;
		SIZE 1,10, 0
	@ 12,36 SAY m.perdido ;
		SIZE 1,10, 0
	@ 12,48 SAY m.perdido+m.Xperdido ;
		SIZE 1,10, 0
	@ 13,36 SAY m.cantfin ;
		SIZE 1,10, 0
	@ 13,48 SAY m.cantfin+m.Xcantfin ;
		SIZE 1,10, 0
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF