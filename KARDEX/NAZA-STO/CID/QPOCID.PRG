FUNCTION QPOCID
#DEFINE NUL    0                                 && NUL
STORE NUL TO M.RESPUESTA
DO CASE
CASE M.QP_CPO="TALLER"
   M.QP_SALIDA=IIF(ELIPRO(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
CASE LEFT(M.QP_CPO,4)="ARTI"
   DO CASE
   CASE TIPOMERCA="A"
      M.QP_SALIDA=IIF(ELIAVIS(Q_TEX,Q_REN,Q_COL),AVIS.AVICODPRO,"")
   CASE TIPOMERCA="T"
      M.QP_SALIDA=IIF(ELITELS(Q_TEX,Q_REN,Q_COL),TELS.TELCODPRO,"")
   CASE TIPOMERCA="C"
      M.QP_SALIDA=IIF(ELICOMS(Q_TEX,Q_REN,Q_COL),COMS.COMCODPRO,"")
   OTHERWISE
      M.QP_SALIDA=IIF(ELIOTRS(Q_TEX,Q_REN,Q_COL),OTRO.COMCODPRO,"")
   ENDCASE
ENDCASE
RETURN