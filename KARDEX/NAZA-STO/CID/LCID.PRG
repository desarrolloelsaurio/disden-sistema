PROCEDURE LCID
	#DEFINE PAIP '|'
	#DEFINE NUL  0
	#DEFINE BOTOM  "  "+repl("°",78)              && BOTOM
	EXTERNAL ARRAY ARTI
	EXTERNAL ARRAY DESCR
	EXTERNAL ARRAY CANTI
	EXTERNAL ARRAY UNID
	ULPR=HORA_ULP(PROG())
	=IMPRESOR()
	STOR NUL TO CASOS,LARGO,LARGOIM
	ACLA=PAIP+;
	PADC("ARTICULO",20)+PAIP+;
    PADC("DESCRIPCION",30)+PAIP+;
	PADC("CANTIDAD",12)+PAIP+;
	PADC("UNIDAD",11)+PAIP
	LINEA=REPL("=",LEN(ACLA))
	=CABPRI(2,"36",0)
	_PCOPIES=1
	PRINTJOB
	for i=1 to 5
		?
	next
	? DATECOMP(m.fechaem) AT 44
	for i=1 to 4
		?
	next
	? M.TALLER AT 8
	?? SAYPER(M.TALLER, "PROCOD") AT 20
	IF !EMPTY(M.CORTE)
		IF XSEEK(M.CORTE,"COR","NUMERO")
			M.DESC_ARTI=SAYGRL(COR.ARTICULO,"MER","ARTIRED","MER.ARTICULO")
			M.COD_ARTI =COR.ARTICULO
		ENDIF
		?? "O.Corte: " at 51
		?? M.CORTE
	ENDIF
	? PER.DOMICILIO AT 8
	IF !EMPTY(M.CORTE)
		?? "Artic. : " at 51
		?? M.COD_ARTI
	ENDIF
	IF EMPTY(PER.LOCALIDAD)
		?
	ELSE
		? "(" AT 8
		?? PER.LOCALIDAD
		?? ")"
		?? SAYMIX(PER.LOCALIDAD, "CIUCOD") AT 20
	ENDIF
	IF !EMPTY(M.CORTE)
		?? "Descr. : " at 51
		?? M.DESC_ARTI
	ENDIF
	? SAYMIX(PER.CONDIVA, "IVACOD") AT 5
	?? PER.NROIVA AT 47
	?
	? QMOV(m.CODMOV) AT 37
	?
	? LINEA
	? ACLA
	? LINEA
	M.LIN_FALTA=0
	FOR I=1 TO 5
		IF !EMPTY(ARTI[I])
			? PAIP
			?? PADR(ARTI[I],20)
			?? PAIP
			?? PADR(DESCR[I],30)
			?? PAIP
			?? CANTI[I] PICT "@Z 9,999,999.99"
			?? PAIP
			?? PADR(UNID[I],11)
			?? PAIP
		ELSE
			M.LIN_FALTA=M.LIN_FALTA+1
		ENDIF
	NEXT
	? LINEA
	?
	? "DETALLE : " AT 30
	?? M.DETALLE
	EJECT PAGE
	ENDP
	=FINIMP()
	=IAUD(STR(M.NUMERO))
RETURN MEN_LIN(BOTOM)
