PROCEDURE SINCONSU
	#DEFINE CRLF CHR(13)+CHR(10)                  && CRLF
	#DEFINE BOTOM  "  "+repl("°",78)              && BOTOM
	#DEFINE PAIP   "|"                            && PAIP
	PARAMETER PORPAN,QTIP,C_VALOR
	ULPR=HORA_ULP(PROGRAM())
	IF CHEQSEG()
		=OPTELS()
		=OPAVIS()
		=OPKARS()
		ACLA=PAIP

		CREATE CURSOR TEMPORAL ;
			(AVICODPRO C(20),;
			TELCODPRO C(20),;
			AVIO C(40),;
			TELA C(40),;
			MONTO N(14,2),;
			STOCK N(14,2))
		INDE ON AVICODPRO TAG AVICODPRO UNIQ
		INDE ON TELCODPRO TAG TELCODPRO UNIQ

		STORE {01/01/90} TO M.FECINI
		STORE DATE()     TO M.FECFIN
		IF ENTRE_FE(" a Listar")
			TMP=GENTMP()
			=WORKING()
			=DOTALK()

			ACLA=PAIP+;
				PADC(IIF(QTIP='A',"AVIO",'TELA') ,20)+PAIP+;
				PADC("DENOMINACION",IIF(PORPAN,15,40))+PAIP+;
				PADC("STOCK",XACDIGI)+PAIP+;
				PADC("PRECIO U.",XACDIGI)+PAIP+;
				PADC("TOTAL",XACDIGI+2)+PAIP
			IF QTIP="A"
				APPEND FROM (DBF("AVIS"))
				SELE KARS
				SORT ON AVICODPRO TO (TMP) FOR ;
					BETW(FECHAOP, M.FECINI, M.FECFIN) .AND. ;
					!EMPTY(SALIDA) .AND. !EMPTY(AVICODPRO)
				=PRXAREA(.T.)
				USE (TMP) ALIAS TMP
				INDE ON AVICODPRO TAG AVICODPRO UNIQ
				SET ORDER TO TAG AVICODPRO
				SELE TEMPORAL
				SET ORDER TO TAG AVICODPRO
				SET RELA TO AVICODPRO INTO TMP
				DELE FOR !EOF("TMP") OR EMPTY(STOCK)
				INDE ON AVIO TAG AVIO
				SET ORDER TO TAG avio
		ELSE
				APPEND FROM (DBF("TELS"))
				SELE KARS
				SORT ON TELCODPRO TO (TMP) FOR ;
					BETW(FECHAOP, M.FECINI, M.FECFIN) .AND. ;
					!EMPTY(SALIDA) .AND. !EMPTY(TELCODPRO)
				=PRXAREA(.T.)
				USE (TMP) ALIAS TMP
				INDE ON TELCODPRO TAG TELCODPRO UNIQ
				SET ORDER TO TAG TELCODPRO
				SELE TEMPORAL
				SET ORDER TO TAG TELCODPRO
				SET RELA TO TELCODPRO INTO TMP
				DELE FOR !EOF("TMP") OR EMPTY(STOCK)
				INDE ON TELa TAG TELa
				SET ORDER TO TAG tela
			ENDIF
			=UNTALK()
			=UNWORK()
		ENDIF
		TT="Listado de Art¡culos sin Consumo "+;
		CRLF+;
		"Desde el "+;
		dtoc(m.fecini)+;
		" al "+;
		dtoc(m.fecfin)
		=LGRL2(PORPAN, "TEMPORAL","LSCON0()",;
				"ENTRE "+DTOC(FECINI)+"-"+DTOC(FECFIN),;
				IIF(QTIP="A","LSCA","LSCT"),.T.,"99,999,999.99")
		=OFF_TMP()
ELSE
	=IAUDI()
ENDIF
RETURN MEN_LIN(BOTOM)
