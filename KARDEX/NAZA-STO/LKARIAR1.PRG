FUNCTION LKARIAR1
	STORE {} TO M.FECINI,M.FECFIN
	STORE .T. TO M.SALIDA
	IF FEC2
		M.SALIDA=ENTRE_FE("a Listar")
	ELSE
		M.FECINI=INFEC("WIN"," Fecha de Inicio ")
	ENDIF
	IF M.SALIDA .AND. ;
		LAST()#27 .AND. ;
		!EMPTY(M.FECINI)
		=WORKING()
		=DOTALK()
		SELE KARS
		TMP=GENTMP()
		SORT ON FECHAOP ;
		TO (TMP) FOR &FISC
		SELE KARS
		USE (TMP) ALIAS KARS
		STORE "" TO M.LINEA,M.CASOS
		TT="Listado de Kardex"+;
		crlf+;
		TT+;
		crlf+;
		"Detallado desde "+dtoc(m.fecini)
		IF FEC2
			TT=TT+" al "+dtoc(m.fecfin)
		ENDIF
		ACLA=PAIP+" FECHA  "+PAIP+;
		PADC("DETALLE",30)+PAIP+;
		PADC("COMPROBANTE",11)+PAIP+;
		PADC("ENTRADA",XACDIGI)+PAIP+;
		PADC("SALIDA",XACDIGI)+PAIP
		=UNWORK()
		=UNTALK()
		=IIF(PORPAN,;
			IIF(FEC2,LKAR2ARP(),LKAR1ARP()),;
			IIF(FEC2,LKAR2ARI(),LKAR1ARI()))
		=OPKARS(.T.)
	ENDIF
RETURN MEN_LIN(BOTOM)
