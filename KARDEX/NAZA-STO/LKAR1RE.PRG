FUNCTION LKAR1RE
#DEFINE BOTOM  "  "+repl("°",78)               && BOTOM
#DEFINE PAIP   "|"                             && PAIP
#DEFINE NUL    0                               && NUL
#DEFINE CRLF CHR(13)+CHR(10)                   && CRLF
 
=OPTELS()
=OPAVIS()
=OPKARS()
STORE NUL TO M.REMITO,M.RESPUESTA
M.REMITO=INFIC("Remito a Listar",99999999)
IF LAST()#27 .AND. !EMPTY(M.REMITO)
   =WORKING()
   =DOTALK()
   M.REMITO=ZERO(M.REMITO,8)
   TMP=GENTMP()
   SORT ON FECHAOP,;
     TELCODPRO,;
     AVICODPRO ;
     TO (TMP) FOR COMPR="RF" .AND. ;
     NUMERO=M.REMITO
   SELE KARS
   USE (TMP) ALIAS KARS
   SET ORDER TO TAG AVICODPRO IN AVIS
   SET ORDER TO TAG TELCODPRO IN TELS
   STORE "" TO M.LINEA,M.CASOS
   TT="Listado de Kardex"+;
     crlf+;
     "Remito N§ "+m.remito
   ACLA=" FECHA  "+PAIP+;
     PADC("CODIGO",20)+PAIP+;
     PADC("MATERIAL",30)+PAIP+;
     PADC("ENTRADA",XACDIGI)+PAIP+;
     PADC("SALIDA",XACDIGI)+PAIP+;
     "UNID"
   =UNWORK()
   =UNTALK()
   =XPRN1(4,"KARS","LKAR1OC0()",M.REMITO,"LKAR1RE")
   =OPKARS(.T.)
ENDIF
RETURN MEN_LIN(BOTOM)
