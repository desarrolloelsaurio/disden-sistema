FUNCTION INGDIA0
#DEFINE PAIP   "|"                               && PAIP
? PAIP
?? TMP.FECHAOP
?? PAIP
IF FECHAFECHA
   ?? TMP.FECHA
   ?? PAIP
ENDIF
DO CASE
CASE ELCOSO="A"
   ?? TMP.AVICODPRO
   ?? PAIP
   ?? LEFT(AVIS.AVIO,IIF(PORPAN,20,30))
   LAUN=SAYMIX(AVIS.UNIDAD,"MDDCOD",4)
CASE ELCOSO="T"
   ?? TMP.TELCODPRO
   ?? PAIP
   ?? LEFT(TELS.TELA,IIF(PORPAN,20,30))
   LAUN=SAYMIX(TELS.UNIDAD,"MDDCOD",4)
CASE ELCOSO="C"
   ?? COMS.COMCODPRO
   ?? PAIP
   ?? LEFT(COMS.COMPRA,IIF(PORPAN,20,30))
   LAUN=SAYMIX(COMS.UNIDAD,"MDDCOD",4)
CASE ELCOSO="O"
   ?? OTRS.OTRCODPRO
   ?? PAIP
   ?? LEFT(OTRS.OTRO,IIF(PORPAN,20,30))
   LAUN=SAYMIX(OTRS.UNIDAD,"MDDCOD",4)
ENDCASE
?? paip
IF !PORPAN
   ?? COMPR
   ?? " "
   ?? LEFT(NUMERO,10)
   ?? PAIP
   ?? LEFT(REFERENCIA,25)
   ?? PAIP
   ?? LEFT(TMP.DETALLE,25)
   ?? PAIP
ENDIF
?? STR(IIF(DECONSUMO,SALIDA,ENTRADA),XACDIGI,2)
?? PAIP
?? LAUN
?? PAIP
RETURN .T.
