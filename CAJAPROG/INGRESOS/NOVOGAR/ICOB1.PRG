********************************************************************************
*-- Programa: ICOB1.PRG
*-- Fecha   : 01/14/91
*-- Versi¢n : G. REINER
*-- Notas   : INGRESO COBROS de facturas directas
*-- VERSION NOVOGAR
*-- Modificacion GOYO 10-28-92 05:48pm
********************************************************************************
FUNCTION ICOB1
	PARAMETER TOMON
	STORE TOMON TO TOMONANT
	STORE .F. TO ICOB_SAL
	STORE NUL TO CHEQUES,EFECAUS,EFECDOL,SUMPAG,NAMONTO,VUELTO,REDONDEO
	STORE '999999999.99' TO PICU
	=MOVEWIN(10,10,15,60,"WIN1","FORMA DE PAGO")
	@ 1,1 say "MONTO DE LA DEUDA:"
	@ 1,30 GET TOMON PICT '999999999.99'
	CLEA GETS
	@ 2,1 SAY "REDONDEO:"
	@ 2,30 GET REDONDEO PICT '999999999.99'
	READ
	TOMON=TOMON-REDONDEO
	ZOOM WINDOW WIN1 NORM SIZE WROWS()+5,WCOLS()
	@ 1,1 SAY "MONTO DE LA DEUDA:"
	@ 1,30 GET TOMON PICT '999999999.99'
	CLEA GETS
	@ 4,1 SAY "PAGO EN "+ALLTRIM(UPPER(XAUSS))

	@ 5,1 SAY "PAGO EN "+ALLTRIM(UPPER(XADOLS))
	M.EFECAUS=TOMON
	@ 4,30 GET M.EFECAUS PICTURE PICU MESS 'Monto del Pago en '+xauss
	READ
	M.EFECDOL=TOMON-M.EFECAUS
	@ 5,30 GET M.EFECDOL PICTURE PICU MESS 'MONTO DEL PAGO EN '+XADOLS
	READ
	**
	** CALCULA VUELTO
	**
	IF !EMPTY(EFECAUS)
		IF M.EFECAUS>TOMON
			VUELTO=M.EFECAUS-TOMON
			M.EFECAUS=TOMON
		ENDIF
	ENDIF
	IF !EMPTY(EFECDOL)
		IF EMPTY(VUELTO)
			VUELTO=M.EFECDOL*XACOTIZ+M.EFECAUS-TOMON
			M.EFECDOL=EFECDOL-VUELTO
		ENDIF
	ENDIF
	ZOOM WINDOW WIN1 NORM SIZE WROWS()+5,WCOLS()
	NADA=EFECAUS+EFECDOL*XACOTIZ
	@ 7,1 SAY "TOTAL:"
	@ 7,30 GET NADA PICT PICU
	@ 8,1 SAY "VUELTO:"
	@ 8,30 GET VUELTO PICT PICU
	CLEA GETS
	***
	IF !EMPTY(NADA) .AND. confirm1('Los Datos Ingresados',.T.,20,38)
		IF TOMON=M.EFECAUS+M.EFECDOL*XACOTIZ-M.VUELTO
			STORE .T. TO ICOB_SAL
			SUMPAG=TOMON
			=ICOB0()
		ELSE
			=CARTEL("EL MONTO PAGADO","MO COINCIDE CON EL MONTO","DE LA DEUDA","POR FAVOR REINTENTE")
		ENDIF
	ENDIF
	=RELEWIN('WIN1')
RETURN ICOB_SAL
