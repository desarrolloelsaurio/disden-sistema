********************************************************************************
*-- Programa: ICOBCH.prg
*-- Fecha   : 01/14/91
*-- Versi¢n : G. REINER
*-- Notas   : INGRESO COBROS de facturas directas
*-- VERSION NOVOGAR
*-- Modificacion GOYO 10-28-92 05:48pm
*-- Modificaci¢n GOYO 11-04-92 02:31pm (icob1=>icobt)
********************************************************************************
FUNCTION ICOBCH
	parameter tomon
	STORE M.TOMON TO M.TOMONANT
	STORE .F. TO ICOB_SAL
	STORE NUL TO CHEQUES,EFECAUS,EFECDOL,SUMPAG,namonto,vuelto,REDONDEO,CHEQUES
	STORE '999999999.99' TO PICU
	=MOVEWIN(10,10,15,60,"WIN1","FORMA DE PAGO")
	@ 1,1 say "MONTO DE LA DEUDA:"
	@ 1,30 GET M.TOMON PICT '999999999.99'
	CLEA GETS
	@ 2,1 SAY "REDONDEO:"
	@ 2,30 GET REDONDEO PICT '999999999.99'
	READ
	M.TOMON=M.TOMON-REDONDEO
	ZOOM WINDOW WIN1 NORM SIZE WROWS()+6,WCOLS()
	@ 1,1 say "MONTO DE LA DEUDA:"
	@ 1,30 GET M.TOMON PICT '999999999.99'
	CLEA GETS
	@ 4,1 SAY "PAGO EN "+ALLTRIM(UPPER(XAUSS))

	@ 5,1 SAY "PAGO EN "+ALLTRIM(UPPER(XADOLS))

	@ 6,1 SAY "CHEQUES "
	M.EFECAUS=M.TOMON
	@ 4,30 GET M.EFECAUS PICTURE PICU MESS 'Monto del Pago en '+xauss	
	READ
    M.EFECDOL=(TOMON-EFECAUS)/XACOTIZ	
	@ 5,30 GET M.EFECdol PICTURE PICU MESS 'Monto del Pago en '+xadols	
	READ
    M.CHEQUES=TOMON-EFECAUS-EFECDOL*XACOTIZ
	@ 6,30 GET M.CHEQUES PICTURE PICU MESS 'Monto del Pago con CHEQUES de Cr‚dito'	
	READ
	**
	** CALCULA VUELTO
	**
	IF !EMPTY(EFECAUS)
		IF M.EFECAUS+M.CHEQUES>M.TOMON
			VUELTO=M.CHEQUES+M.EFECAUS-M.TOMON
			M.EFECAUS=M.TOMON
		ENDIF
	endif
	IF !EMPTY(EFECDOL)
		IF EMPTY(VUELTO)
			VUELTO=M.EFECDOL*XACOTIZ+M.EFECAUS+M.CHEQUES-M.TOMON
			M.EFECDOL=EFECDOL-VUELTO
		ENDIF
	ENDIF
	ZOOM WINDOW WIN1 NORM SIZE WROWS()+4,WCOLS()
	NADA=EFECAUS+EFECDOL*XACOTIZ+CHEQUES
	@ 7,1 SAY "TOTAL:"
	@ 7,30 GET NADA PICT PICU
	@ 8,1 SAY "VUELTO:"
	@ 8,30 GET VUELTO PICT PICU
	CLEA GETS
	***
	IF !EMPTY(NADA) .AND. confirm1('Los Datos Ingresados',.T.,20,38)
	IF TOMON=M.REDONDEO+EFECAUS+EFECDOL*XACOTIZ+M.CHEQUES
		STORE .T. TO ICOB_SAL
		=ICOB0()
		ICOB_SAL=IIF(ICOBC("CH",CHEQUES),.T.,ICOB_SAL)
	ELSE
		=CARTEL("EL MONTO PAGADO","MO COINCIDE CON EL MONTO","DE LA DEUDA","POR FAVOR REINTENTE")
	ENDIF
	ENDIF
	=relewin('win1')
RETURN ICOB_SAL
