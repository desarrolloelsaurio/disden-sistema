******************************************************************************
*-- Programa: LRECIU2.PRG
*-- Fecha   : 10-14-92 11:47am
*-- Version : G. REINER
*-- Notas   : IMPRESION DE FACTURAS, POR IMPRESORA - TIPO B
*-- MODIFICACION goyo ADAPTACION FACTURAS - RECIBOS (TIPO B)
*-- MODIFICACION GOYO / NOVOGAR
*-- PAGOS CUOTAS
*-- MODIFICACION PARA RAFULS
*-- RECIBO DE EXPENSAS
********************************************************************************
#DEFINE PICU "999,999,999.99"
#DEFINE NUL  0                                   && NUL
#DEFINE PAIP "|"                                 && PAIP
#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM

STORE HORA_ULP(PROGRAM()) TO ULPR
IF CHEQSEG()
	W=PAIP
	STOR NUL TO CASOS
	STOR 90 TO T1
	C1=2
	C2=18
	C7=48
	STORE 60 TO C3,C6
	C4=C3+10
	C5=55
	STORE "" TO NLQ1,NLQ2
	RELE LPT1,LPT2,LPT3
	=CABPRI3(2,36)
	ELCODCLI=PER.CODCLI
	PRINTJOB
	***************************************************
	M.EL_NUM=GETDOC((JANNRO-1)*20+11)
	M.ELNUM=Q_FAC(SUCU+"-"+ALLTRIM(STR(M.EL_NUM)))
	=CABEMP(M.ELNUM)
	?
	TT="RECIBI DEL SR. "+;
	ALLTRIM(SAYPER(PER.CODCLI,"CSSCOD"))+;
	" ,PROPIETARIO DEL INMUEBLE SITO EN CALLE "+;
	ALLTRIM(PER.DOMICILIO)+;
	" DE LA CIUDAD DE "+;
	ALLTRIM(SAYMIX(PER.LOCALIDAD,"CIUCOD"))+;
	", POR CUENTA Y ORDEN DEL CONSORCIO DEL EDIFICIO "
	=xseek(PER.CODCLI,"CNX","CODCLI")
	=XSEEK(CNX.CONCOD,"CNS","CONCOD")
	tt=tt+ALLTRIM(CNS.CONSORCIO)+;
	" LA CANTIDAD DE "+ALLTRIM(XAUSS)
	=AJUSTE(TT,80,"-","I")
	***
	IF USED("TMP1")
	SELE TMP1
	SCAN
		? PADR(TMP1.DETALLE,35)
		?? " "
		?? " VENC:"
		?? TMP1.VENCIM
		?? "  "
		?? TMP1.MONTO PICT PICU
		IF TMP1.DIASRET>0
			?? " RETR:"
			?? STR(TMP1.DIASRET,4)
			?? " D¡as"
		ENDIF
	ENDSCAN
    ENDIF
	***
	*TT=SAY_NUM(CCL.MONTO)
	TT=SAY_NUM(LAGUITA)
	IF LEN(TT)>80
		=AJUSTE(TT,80,"-","I")
	ELSE
		? PADR(TT,80,'-')
	ENDIF

	? XAUSS
	?? ':' AT 46
	?? LAGUITA PICT PICU
	? "TOTAL"
	?? ':' AT 46
	?? LAGUITA PICT PICU
	DO WHILE _PLINENO<25
	   ?
	ENDDO
	ELNOMLCI="PP/CONS. "+ALLTRIM(CNS.CONSORCIO)
	? PADC(DTOC(DATE())+SPACE(10)+ELNOMLCI,80)
	? PADC("--------"+SPACE(10)+REPL("-",LEN(ELNOMLCI)),80)
	_WRAP=.F.
	_LMARGIN=NUL
	EJECT PAGE
	ENDP
	=FINIMP()
	=IAUD(M.ELNUM)
	=SAVDOC((JANNRO-1)*20+11,M.EL_NUM+1)
	RELE LPT1,LPT2,LPT3
ELSE
	=IAUDI()
ENDI
RETURN MEN_LIN(BOTOM)
