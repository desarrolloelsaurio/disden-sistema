*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        08/12/96             ELIRECI.PRG               22:40:49 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        GOYO REINER                                             
*                                                                
*        Copyright (c) 1996 GOYO REINER                          
*        1 DE MAYO 2134 Dto 2                                   
*        ROSARIO, SF  2000                                       
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("fic") ;
	OR UPPER(WTITLE("FIC")) == "FIC.PJX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.SCX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.MNX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.PRG" ;
	OR UPPER(WTITLE("FIC")) == "FIC.FRX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.QPR"
	=MOVEWIX("fic",	INT((SROW()-5)/2), INT((SCOL()-50)/2), INT((SROW()-5)/2)+4, INT((SCOL()-50)/2)+49, ;
	 " BUSQUEDA DE RECIBOS "		,' '+JANNAME+' ')		
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 ELIRECI/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

=OPreci()
STORE "" TO M.REMI
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     ELIRECI/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("fic")
	ACTIVATE WINDOW fic SAME
ELSE
	ACTIVATE WINDOW fic NOSHOW
ENDIF
@ 1,18 GET m.remi ;
	SIZE 1,16 ;
	DEFAULT " " ;
	PICTURE REPL('!',14) ;
	VALID _rcx1cm1ka() ;
	MESSAGE "Ingrese N de Recibo a Procesar"
@ 0,40 GET M.OPCION ;
	PICTURE "@*VN \<OK;\<NO" ;
	SIZE 1,4,1 ;
	DEFAULT 1 ;
	VALID _rcx1cm1l6()
@ 1,1 SAY "N de Recibo :" ;
	SIZE 1,14, 0

IF NOT WVISIBLE("fic")
	ACTIVATE WINDOW fic
ENDIF

READ CYCLE

=RELEWIN("fic")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      ELIRECI/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
SELE RECI
SET ORDER TO TAG RECIBO
SET MESS TO LEFT(BOTOM,78)
RETURN LAST()#27 .AND. ;
RIGHT(M.REMI,8)#"00000000" .AND. ;
SEEK(M.REMI)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCX1CM1KA           m.remi VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIRECI,     Record Number:    2   
*        Variable:            m.remi                             
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcx1cm1ka     &&  m.remi VALID
#REGION 1
M.NETO=ALLTRIM(M.REMI)
M.ULTI=RIGHT(M.NETO,1)
SUCUC=SUCU
m.remi=q_fac(alltrim(m.remi))
return sget("fic")


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCX1CM1L6           M.OPCION VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIRECI,     Record Number:    3   
*        Variable:            M.OPCION                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcx1cm1l6     &&  M.OPCION VALID
#REGION 1
IF M.OPCION#1 .OR. LAST()=27
   STORE "00000000" TO M.REMI
ENDIF
CLEA READ
RETURN .T.