*****************************************************************************
*-- Programa: LCAJIX.PRG
*-- Fecha   : 05-13-92 04:41pm
*-- Version : G. REINER & R. 'EL BATA'
*-- Notas   : LISTADO DE RESUMEN DE SALDOS x Impre
********************************************************************************
STORE HORA_ULP(PROGRAM()) TO ULPR
IF CHEQSEG()
	=LCAJPX0()
	LNS=REPL("=",LEN(ACLA))
	TT=TTQUE
	=UNWORK()
	=CABPRI()
	_PCOPIES=1
	PRINTJOB
	=CABPRI1()
	=TIT_LNS(3)
	SELE CAJ
	STORE NUL TO GMONTOTO,MONTOTO
	PICU='99,999,999.99'
	GO TOP
	ELTEXTO=''
	ELCORTE=''
	=CORTA()
	SCAN
		IF YACORTO()
			=FLCAJIX()
		ENDIF
		IF _PLINENO>63
			IF TLCAJIX("SUBTOTAL")
				EJECT PAGE
				=CABPRI1()
				=TIT_LNS(4)
			ENDIF
		ENDIF
		MONTOTO=MONTOTO+ABS(MONTO)
	ENDSCAN
	ENDP
	=FLCAJIX()
	=TLCAJIX("TOTAL")
	?
	=FINIMP()
	=OPCAJ(JANNRO,.F.,.T.)
	=IAUD(FISC)
ELSE
	=IAUDI()
ENDIF
RETURN MEN_LIN(BOTOM)

FUNCTION TLCAJIX
	PARAMETER COSA
	PRIVATE COSA
	? LNS
	? PAIP
	?? PADR(COSA,IIF(FILFEC=3,8,IIF(FILGAS=3,20,30)))
	?? PAIP
	?? GMONTOTO PICT PICU
	?? PAIP
return(.t.)

function FLcajiX
	? PAIP
	?? ELTEXTO
	?? PAIP
	?? MONTOTO PICT PICU
	GMONTOTO=GMONTOTO+MONTOTO
	?? PAIP
	STORE NUL TO MONTOTO
	=CORTA()
RETURN .T.

FUNCTION YACORTO
	PRIV YA
	YA=IIF(FILFEC=3,ELCORTE=caj.FECHAOP,.F.)
	YA=IIF(FILCLI=3.OR.FILPRO=3,ELCORTE=caj.CODcli,YA)
	YA=IIF(FILGAS=3,ELCORTE=caj.GASTO,YA)
RETURN !YA

FUNCTION CORTA
	IF FILFEC=3
		ELTEXTO=caj.FECHAOP
		ELCORTE=caj.FECHAOP
	ENDIF
	IF FILPRO=3
		ELTEXTO=PRO.PROVEEDOR
		ELCORTE=CAJ.CODCLI
	ENDIF
	IF FILCLI=3
		ELTEXTO=PER.CLIENTE
		ELCORTE=CAJ.CODCLI
	ENDIF
	IF FILGAS=3
		ELTEXTO=MIX.TEXTO1
		ELCORTE=CAJ.GASTO
	ENDIF
RETURN
