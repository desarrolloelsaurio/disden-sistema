FUNCTION LHOR10
#DEFINE PAIP   "|"                               && PAIP
? PAIP
?? CODCLI
?? PAIP
IF !PORPAN
?? SAYPER(CODCLI,"EMPLCOD")
?? PAIP
ENDIF
SELE TEMPORIA
STORE 0 TO ELTOT,THOR
SCAN
STORE THOR+1 TO THOR
IF TEMPORIA.field_name="CODCLI"
   EXIT
ENDIF
SELE TMP1
CAMPO=EVAL(TEMPORIA.field_name)
ELTOT=SUMAHORA(CAMPO,ELTOT)
STORE SUMAHORA(TOTAL[THOR],CAMPO) TO TOTAL[THOR]
?? STR(CAMPO,XACDIGI,2)
?? PAIP
SELE TEMPORIA
ENDSCAN
?? STR(ELTOT,XACDIGI,2)
STORE SUMAHORA(ELTOT,TOTAL[TOTHOR]) TO TOTAL[TOTHOR]
?? PAIP
SELE TMP1
RETURN .T.