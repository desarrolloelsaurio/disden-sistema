FUNCTION SALDOCCB
	PARAMETER CCB_BAN,CCB_DEBE,CCB_HABER,CCB_DEB1,CCB_HAB1,CCB_FECHA
	#DEFINE NUL    0                              && NUL
	STORE NUL TO CCB_SALDO,CCB_DEBE,CCB_HABER
	SELE CCB
	SET ORDER TO
	CALC SUM(MONTO) TO CCB_DEBE FOR CODBAN=CCB_BAN .AND. MONTO>0
	CALC SUM(MONTO) TO CCB_HABER FOR CODBAN=CCB_BAN .AND. MONTO<0
	IF !EMPTY(CCB_FECHA)
		STORE NUL TO CCB_DEB1,CCB_HAB1,CCB_SFEC
		CALC SUM(MONTO) TO CCB_DEB1 FOR ;
			CODBAN=CCB_BAN .AND. ;
			MONTO>0 .AND. ;
			FECHADEP<=CCB_FECHA .AND. ;
			FECHAVEN+HORAS/24<=CCB_FECHA
		CALC SUM(MONTO) TO CCB_HAB1 FOR ;
			CODBAN=CCB_BAN .AND. ;
			MONTO<0 .AND. ;
			FECHADEP<=CCB_FECHA .AND. ;
			FECHAVEN+HORAS/24<=CCB_FECHA
		STORE CCB_DEB1+CCB_HAB1 TO CCB_SFEC
		RETURN CCB_SFEC
	ENDIF
RETURN CCB_DEBE+CCB_HABER
