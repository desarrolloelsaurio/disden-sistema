* ษอออออออออออออออออออออออออออออออออออออออออป
* บ  SISTEMA DE HORAS - NAZA                บ
* ศอออออออออออออออออออออออออออออออออออออออออผ
* ษอออออออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : INICIO.PRG              บ
* ฬอออออออออออออออออออออออออออออออออออออออออน
* บ AUTOR      : GOYO REINER                บ
* บ FECHA      : 21-10-95                   บ
* บ COPYRIGHT  : 1995 by GREGORIO REINER    บ
* ศอออออออออออออออออออออออออออออออออออออออออผ
SET TALK OFF
SET ESCA OFF
CLEA
=bigletT(2,1,'SUELDOS')
=bigchars(11,21,'NAZA',12)
STORE 0 TO NUL
=MEN_LIN("TECLA PARA CONTINUAR")
=INKEY(0,'HM')
DO WHILE !EMPTY(WONTOP())
   RELE WIND (WONTOP())
ENDDO
DO SUEL1
DO WHILE .T.
   ACTI MENU MAIN
   IF EMPTY(GETENV("EQUIPO")) .OR. GETENV("EQUIPO")="DESARROLLO" .OR. GETENV("USERNAME")="GOYO"
      EXIT
   ENDIF
ENDDO
RETURN

PROCEDURE SUEL1
*****************************************************************************
*-- Programa: SUEL1.PRG
*-- Fecha   : 07/01/91 10:55am
*-- Version : G. REINER
*-- Notas   : MENU SISTEMA DE SUELDOS / CONTROL DE HORAS
********************************************************************************
=SETEOS()
ULPR=PROGRAM()
RELE PATH,PATHPRO,PATHVEN,PATHCAJ
PUBL PATH,PATHPRO,PATHVEN,PATHCAJ

=GETPATH()
=GETLIB()
*************************** INICIO COMERCIALIZACION **************************
@ 0,0 SAY REPLICATE("",80) COLO W
@ 0,1 SAY PADC('Horas',20) COLO I
@ 0,23 SAY '|'
@ 0,25 SAY DATE() COLO I
@ 0,34 SAY '|'
@ 0,36 SAY TIME() COLO I
@ 0,45 SAY '|'
@ 0,47 SAY PADC("CONTOL DE HORAS",10) COLO I
@ 0,58 SAY '|'
SET SHAD ON
DO GENVAR
DO GENVAR1
STORE "" TO USN
IF GETENV("EQUIPO")='MARISA'
   COEFSEG=SEGURIC()
   USADOR=USN
   IF EMPTY(COEFSEG)
      QUIT
   ENDIF
ELSE
   USADOR=GETENV("USERNAME")   
ENDIF
=OPAUD()
=OPSEG()
=OPDOC()
=OPMIX()
XACDIGI=GETNU1(PADR(USADOR,10)+PADR("XACDIGI",20),"FOXPER")
ULPR=PROGRAM()
=IAUD("INGRESO AL SISTEMA")
=CABPAN1()
************************** INICIO COMERCIALIZACION
DEFI MENU MAIN MESSAGE 'MENU PRINCIPAL - SISTEMA DE HORAS TRABAJADAS' shad COLO SCHE 2
DEFI PAD varios OF MAIN PROM 'Va\<rios'     AT 01,00 COLO SCHE 2
DEFI PAD emplea OF MAIN PROM '\<Empleados'  AT 01,07 COLO SCHE 2
DEFI PAD horas  OF MAIN PROM '\<Horas'      AT 01,17 COLO SCHE 2
DEFI PAD variab OF MAIN PROM 'V\<ariables'  AT 01,64 COLO SCHE 2
DEFI PAD adios  OF MAIN PROM 'C\<hau'       AT 01,74 COLO SCHE 2

ON SELE PAD VARIOS OF MAIN ACTI POPU VARIOS
ON SELE PAD EMPLEA OF MAIN ACTI POPU EMPLEA
ON SELE PAD HORAS  OF MAIN ACTI POPU HORAS
ON SELE PAD VARIAB OF MAIN ACTI POPU VARIAB
ON SELE PAD ADIOS  OF MAIN QUIT

respuesta='varios#2#0#A/B/M/L Varios#3;
#\<Provincias;
#\<Ciudades;
#\<Tipo de Documento;
#\<Tipo de Hora;
#\<Secciขn;
#-;
#Con\<trol de Impresoras'
=defpop()

respuesta='emplea#2#7#A/B/M/L Empleados#3;
#\<Datos Administrativos;
#\<Legajo'
=defpop()

respuesta='horas#2#17#A/B/M/L Horas Trabajadas#3;
#\<Ingreso de Horas;
#\<Listados;
#-;
#\<Backup en disco;
#R\<ecupera Backup;
#\<Depura Archivo;
#Reinde\<xa Base'
=defpop()

RESPUESTA='VARIAB#2#50#Mantenimiento de variables del sistema#3;
#\<Popups a Utilizar;
#Ancho de la \<Impresora;
#Ancho de la \<Hoja;
#\<Cantidad de Dกgitos;
#\<Orden Listados'
=defpop()

respuesta='adios#2#53#Se va del Sistema#3;
#ษอออออออออออออออออออออป;
#บ         \<Chau        บ;
#ศอออออออออออออออออออออผ'
=DEFPOP()

ON SELE POPU VARIOS DO VARIOS
ON SELE POPU EMPLEA DO EMPL
ON SELE POPU HORAS  DO HORAS
ON SELE POPU VARIAB DO VARI
ON SELE POPU ADIOS  DO ADIOS

DO WHILE .T.
   ACTI MENU MAIN
   IF EMPTY(GETENV("EQUIPO")) .OR. GETENV("EQUIPO")="DESARROLLO" .OR. GETENV("USERNAME")="GOYO"
      EXIT
   ENDIF
ENDDO
RETURN

PROCEDURE GENVAR
* ษออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : GENVAR.PRG       บ
* บ COMENTARIO    : GENERA VARIABLES บ
* ศออออออออออออออออออออออออออออออออออผ
PUBL MERPOP,MERPOPC,MERPOPR,MERPOP1
STORE .T. TO MERPOP1
PUBL IPEDR,IPEDC,IPEDAN,IPEDLA
PUBL IREMC,IREMR,IREMAN,IREMLA
PUBL IFACC,IFACR,IFACAN,IFACLA
PUBL SRUPOP,SRUPOPC,SRUPOPR
PUBL MERPOP,MERPOPR,MERPOPC
PUBL MAXCIVA,UNID[30],XACIVA[15,7],XACI[3],XANUM[3,12]
PUBL RUVRO,RUVROS,LLINEA,LLINEAS,JANNAME,COEFSEG,USADOR,XACANCHO,XACHOJA,ACDIGI,XAUS,XAUSS,XACDIGI,KORTE,XANUMCOR
PUBL RH,RP,X10,X15,X20,X30,XADOL,XADOLS,XAMONEDA,XACOTIZ
PUBL XATALMIN,XATALMAX,XATALSTEP,XATALAN,XALIS1,XALIS2,XALIS3,XALIS4
PUBL XAP1,XAP2,XAP3,XAP4,XAS1,XAS2,XAS3,XAS4,XANULIS

RELEASE     ORDALI,ORDCOL,ORDGRU,ORDLIN,ORDMAR,ORDMER,ORDOPK,ORDPRO,ORDRUB,ORDSRU,ORDZON,ORDCIU,ORDPRV,ORDPAG,ORDCLI,ORDVIA
PUBLIC      ORDALI,ORDCOL,ORDGRU,ORDLIN,ORDMAR,ORDMER,ORDOPK,ORDPRO,ORDRUB,ORDSRU,ORDZON,ORDCIU,ORDPRV,ORDPAG,ORDCLI,ORDVIA
STOR .F. TO ORDALI,ORDCOL,ORDGRU,ORDLIN,ORDMAR,ORDMER,ORDOPK,ORDPRO,ORDRUB,ORDSRU,ORDZON,ORDCIU,ORDPRV,ORDPAG,ORDCLI,ORDVIA

RELE SSTM,ULPR,ESPERE,GRABANDO,TRATANDO,IMPRIMIENDO,LARGOIM,LINEA,LARGO,TEN,NLQ,OFFNLQ,UNDER,OFFUNDER,WIDE,OFFWIDE,BIAJA,BIAJAS,NUL,BOTOM,PAIP,TECMEN,SUCU,ENASCII,PROBE,PROBES,CANT_EMPRE,JANPOP,JANPOPR,JANPOPC,CANT_EMPRE,JANNRO,ESARROYO,TECMOD
PUBL SSTM,ULPR,ESPERE,GRABANDO,TRATANDO,IMPRIMIENDO,LARGOIM,LINEA,LARGO,TEN,NLQ,OFFNLQ,UNDER,OFFUNDER,WIDE,OFFWIDE,BIAJA,BIAJAS,NUL,BOTOM,PAIP,TECMEN,SUCU,ENASCII,PROBE,PROBES,CANT_EMPRE,JANPOP,JANPOPR,JANPOPC,CANT_EMPRE,JANNRO,ESARROYO,TECMOD

RELE SSTM1,TEX_EFES,ABA,SSTM2
PUBL SSTM1,TEX_EFES,ABA,SSTM2

RELE IVA09,IVA109,PC9,IVA18,IVA118,PC18,PC27,IVA127
PUBL IVA09,IVA109,PC9,IVA18,IVA118,PC18,PC27,IVA127

IVA09=10.5/100
IVA109=1+IVA09
PC9="10.5 %"
IVA18=21/100
IVA118=1+IVA18
PC18="21 %"
PC27="31.5 %"
IVA127=1.315

SSTM2="HORAS"

CANT_EMPRE=1
ABA="Abriendo Base de "
JANNRO=1
probe="Proveedor"
probes="Proveedores"
TECMOD='[TECLA] Y [ENTER] Para Modificar'

PAIP='|'
BOTOM="  "+REPL("ฐ",78)
TEX_EFES=" - [F2] Popup - [F3] Bฃsqueda"
SSTM=padc('CONTROL DE HORAS',19)
SSTM1="SUELDOS"
STORE 0 TO NUL
=SAYJANNA()
ESPERE=padc(' Espere por Favor - El archivo est siendo Utilizado por otro Usuario ',80,"ฐ")
GRABANDO=padc(' Grabando los datos ingresados - Espere por Favor ',80,"ฐ")
tratando=PADC(" Tratando de Bloquear el Registro a Utilizar ",80,"ฐ")
imprimiendo=PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'ฐ')
TEN='Existe - [ENTER] para Continuar'
TECMEN="[ENTER] para Menฃ"
nlq=chr(27)+chr(120)+chr(1)+chr(27)+chr(107)+chr(0)
offnlq=chr(27)+chr(120)+chr(0)+chr(18)+chr(27)+chr(113)+chr(0)
UNDER=CHR(27)+CHR(45)+CHR(1)
OFFUNDER=CHR(27)+CHR(45)+CHR(0)
WIDE=CHR(27)+CHR(87)+CHR(1)
OFFWIDE=CHR(27)+CHR(87)+CHR(0)
RETURN

PROCEDURE GENVAR1
* ษออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : GENVAR1.PRG      บ
* บ COMENTARIO    : GENERA VARIABLES บ
* ศออออออออออออออออออออออออออออออออออผ
=VAR_PRV()
=var_ciu()
=VAR_THO()
=var_dni()
=var_sec()
=VAR_PLE()
STORE 36 TO RH
STORE 47 TO RP
STORE REPL("!",10) TO X10
STORE REPL("!",15) TO X15
STORE X10+X10 TO X20
STORE X15+X15 TO X30
=GETGENE()
COEFSEG=1
USADOR=GETENV("USERNAME")
RELE PDS
PUBL PDS[2]
PDS[1]=132
PDS[2]=233
GENPED=.F.
GENREM=.F.
BIAJA='Vendedor'
BIAJAS='Vendedores'
RETURN
