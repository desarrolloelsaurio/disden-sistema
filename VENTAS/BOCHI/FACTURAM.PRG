*       *********************************************************
*       *
*       * 08/24/95            FACTURAM.MPR              18:35:11
*       *
*       *********************************************************
*       * Author's Name G. REINER
*       * Copyright (c) 1995 Company Name
*       * Address
*       * City,     Zip
*       * Description:
*       * This program was automatically generated by GENMENU.
*       *********************************************************

clea
=HAZBMP()
MODI WIND SCREEN TITL "FACTURACION MAYORISTA - DIS DEN ODONTOLOGIA / G. REINER"
MODI WIND SCREEN FONT "ARIAL",8
=seteos()
=GETPATH2()
RELE SSTM,JANNAME,USADOR,COEFSEG,XACANCHO,XACHOJA,SSTM1,LARGO,LARGOIM,SUCU
RELE IVA09,IVA18,IVA118,IVA109,PC9,PC18,PC27,IVA127
rele xacdigi,ULPR
PUBL SSTM,JANNAME,USADOR,COEFSEG,XACANCHO,XACHOJA,SSTM1,LARGO,LARGOIM,SUCU
RELE IVA09,IVA18,IVA118,IVA109,PC9,PC18,PC27,IVA127
publ xacdigi,ULPR
=OPMIX()
=OPAUD()
=OPSEG()
=OPDOC()
=var_prv()
=VAR_CLI()
=var_dni()
=var_iva()
=var_cag()
=VAR_PAG()
=VAR_MER()
=VAR_PRO()
IF GETENV("EQUIPO")="MICASA"
rest from d:\sistemas\ventas\novogar\posic ADDI
ELSE
   rest from posic ADDI
ENDIF
=GETPATH2()
*** DEFINICION DE VARIABLES
SSTM="VENTAS"
SSTM1="DIS-DEN"
JANNAME="DIS-DEN Odontología"
USADOR=GETENV("USERNAME")
LARGOIM=80
COEFSEG=1
XACANCHO=GETNU1(PADR(USADOR,10)+PADR("XACANCHO",20),"FOXPER")
XACHOJA=GETNU1(PADR(USADOR,10)+PADR("XACHOJA",20),"FOXPER")
SUCU="0001-"
IVA09=10.5/100
IVA109=1+IVA09
PC9="10.5 %"
IVA18=21/100
IVA118=1+IVA18
PC18="21 %"
PC27="31.5 %"
IVA127=1.315
STORE .T. TO CAGPOP,CIUPOP,CTDPOP,IVACOD,MERPOP,PRVPOP,PROPOP,DNIPOP,ZONPOP,AGEPOP
STORE .F. TO CLIPOP

*       *********************************************************
*       *
*       *                      Menu Definition
*       *
*       *********************************************************
*
SET SYSMENU OFF
DEFI MENU MAIN
DEFI PAD _r3113u5vv OF MAIN PROMPT "\<Varios" COLOR SCHEME 3
DEFI PAD _r3113u5wa OF MAIN PROMPT "\<Operaciones" COLOR SCHEME 3
DEFI PAD _r3113u5wo OF MAIN PROMPT "\<Clientes" COLOR SCHEME 3
DEFI PAD _r3113u5wz OF MAIN PROMPT "\<Precios" COLOR SCHEME 3
DEFI PAD _r3113u5xa OF MAIN PROMPT "V\<ariables" COLOR SCHEME 3
DEFI PAD _r3113u5xk OF MAIN PROMPT "\<Salida" COLOR SCHEME 3
ON PAD _r3113u5vv OF MAIN ACTIVATE POPUP varios
ON PAD _r3113u5wa OF MAIN ACTIVATE POPUP operacione
ON PAD _r3113u5wo OF MAIN ACTIVATE POPUP legajo
ON PAD _r3113u5wz OF MAIN ACTIVATE POPUP precios
ON PAD _r3113u5xa OF MAIN ACTIVATE POPUP variables
ON SELE PAD _r3113u5xk OF MAIN CANCEL

DEFI POPUP varios MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF varios PROMPT "\<Condiciones de Venta"
ON SELE BAR 1 OF varios DO PAG


DEFI POPU LASFACTU MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF LASFACTU PROMPT "Común   (al 21%)"
DEFI BAR 2 OF LASFACTU PROMPT "Especial (al 9.5%)"
ON SELE BAR 1 OF LASFACTU DO FAC.SPR WITH .T.
ON SELE BAR 2 OF LASFACTU DO FAC.SPR WITH .F.,.F.,.T.


DEFI POPUP operacione MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF operacione PROMPT "\<Factura"
DEFI BAR 2 OF operacione PROMPT "Factura de \<Bien de Uso"
DEFI BAR 3 OF operacione PROMPT "Nota de \<Crédito"
DEFI BAR 4 OF operacione PROMPT "Nota de \<Débito"
DEFI BAR 5 OF operacione PROMPT "\<Recibo" SKIP FOR .not. (USADOR="BOCHI" .OR. USADOR="GERMAN")
DEFI BAR 6 OF operacione PROMPT "\-" SKIP FOR .T.
DEFI BAR 7 OF operacione PROMPT "Listados por \<Pantalla"
DEFI BAR 8 OF operacione PROMPT "Listados por \<Impresora"
DEFI BAR 9 OF operacione PROMPT "\-" SKIP FOR .T.
DEFI BAR 10 OF operacione PROMPT "\<Históricos por Pantalla" 
DEFI BAR 11 OF operacione PROMPT "Hi\<stóricos por Impresora" skip for gete("ADELANTE")="SI"

ON SELE BAR 1 OF operacione DO FAC.SPR
ON BAR 2 OF operacione acti popu LASFACTU
ON BAR 3 OF operacione acti popu _r3993u63r
ON SELE BAR 4 OF operacione DO IDEB.SPR
ON SELE BAR 5 OF operacione DO RECIBO.SPR
ON BAR 7 OF operacione ACTIVATE POPUP listadospo
ON BAR 8 OF operacione ACTIVATE POPUP _qvl0lu44t
ON SELE BAR 10 OF OPERACIONE DO REIMFAC WITH .T.,"FA",.T.
ON SELE BAR 11 OF OPERACIONE DO REIMFAC WITH .F.,"FA",.T.

DEFI POPUP _r3993u63r MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF _r3993u63r PROMPT "\<Devolución"
DEFI BAR 2 OF _r3993u63r PROMPT "\<Importe"

ON SELE BAR 1 OF _r3993u63r DO _r3113u63j
ON SELE BAR 2 OF _r3993u63r DO _r3113u63r

DEFI POPUP listadospo MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF listadospo PROMPT "Visualiza Factura"
ON SELE BAR 1 OF listadospo DO REIMFAC WITH .T.,"FA"

DEFI POPUP _qvl0lu44t MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF _qvl0lu44t PROMPT "\<Reimprime Factura"
DEFI BAR 2 OF _qvl0lu44t PROMPT "Reimprime Nota de \<Crédito"
DEFI BAR 3 OF _qvl0lu44t PROMPT "Reimprime Nota de \<Débito"
DEFI BAR 4 OF _qvl0lu44t PROMPT "\-" SKIP FOR .T.
DEFI BAR 5 OF _qvl0lu44t PROMPT "\<Facturas del día" skip for gete("ADELANTE")="SI"
DEFI BAR 6 OF _qvl0lu44t PROMPT "F\<acturas entre Fechas" skip for gete("ADELANTE")="SI"
ON SELE BAR 1 OF _qvl0lu44t DO REIMFAC WITH .F.,"FA"
ON SELE BAR 2 OF _qvl0lu44t DO REIMFAC WITH .F.,"NC"
ON SELE BAR 3 OF _qvl0lu44t DO REIMFAC WITH .F.,"ND"
ON SELE BAR 5 OF _qvl0lu44t DO _r3113u68a
ON SELE BAR 6 OF _qvl0lu44t DO _r3113u698

DEFI POPUP legajo MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF legajo PROMPT "\<Datos Administrativos"
DEFI BAR 2 OF legajo PROMPT "\<Legajo del Cliente"
DEFI BAR 3 OF legajo PROMPT "Resumen de Cuenta por \<Pantalla"
DEFI BAR 4 OF legajo PROMPT "Resumen de Cuenta por \<Impresora"
DEFI BAR 5 OF legajo PROMPT "\<Agrupación"
ON SELE BAR 1 OF legajo do cli
ON SELE BAR 2 OF legajo do cli
ON SELE BAR 3 OF legajo DO CLI
ON BAR 4 OF legajo ACTIVATE POPUP resumendec
ON SELE BAR 5 OF legajo do cli

DEFI POPUP resumendec MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF resumendec PROMPT "Resumen de Cta \<un Cliente"
DEFI BAR 2 OF resumendec PROMPT "Análisis de un Cliente" skip for gete("ADELANTE")="SI"
ON SELE BAR 1 OF resumendec DO cli
ON SELE BAR 2 OF resumendec DO _r3113u6kd

DEFI POPUP precios MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF precios PROMPT "Por Rubro" 
DEFI BAR 2 OF precios PROMPT "Por Proveedor"
DEFI BAR 3 OF precios PROMPT "Por Teclado" 
DEFI BAR 4 OF precios PROMPT "Completo" 
ON SELE BAR 1 OF precios DO _r3113u6mt
ON SELE BAR 2 OF precios DO _r3113u6nq
ON SELE BAR 3 OF precios DO _r3113u6on
ON SELE BAR 4 OF precios DO _r3113u6pj

DEFI POPUP variables MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFI BAR 1 OF variables PROMPT "\<Popups a Utilizar"
DEFI BAR 2 OF variables PROMPT "Modifica \<Porcentajes" skip for gete("ADELANTE")="SI"
DEFI BAR 3 OF variables PROMPT "Cantidad de Dígitos"
DEFI BAR 4 OF variables PROMPT "Actualiza Nº de Factura"


ON SELE BAR 1 OF variables do acpopu.spr
ON SELE BAR 2 OF variables DO ACPORC.SPR
ON SELE BAR 3 OF variables do acdigi
ON SELE BAR 4 OF variables do xanum.spr

ON SELE POPUP listadospo DO _r3113u6sv

*       *********************************************************
*       *                 Cleanup Code & Procedures
*       *********************************************************
*
DO WHILE .T.
   IF LAST()=27 .AND. ;
      GETENV("USERNAME")="GOYO"
      IF INKEY(0)=27
         EXIT
      ENDIF
   ENDIF
   ACTI MENU MAIN
ENDDO
SET SYSM TO DEFA
RETURN

*       *********************************************************
*       * _R3113U63R  ON SELE BAR 3 OF POPUP operacione
*       * Procedure Origin:
*       * From Menu:  FACTURAM.MPR,            Record:   10
*       * Called By:  ON SELE BAR 3 OF POPUP operacione
*       * Prompt:     Nota de Crédito
*       * Snippet:    1
*       *********************************************************
*
PROCEDURE _r3113u63j
if !pideclav(2)
     return
endif
DO ICRE.SPR
=RELEWIN("IDEB")
return

PROCEDURE _r3113u63r
if !pideclav(2)
     return
endif
DO DEV.SPR
return




*       *********************************************************
*       *
*       * _R3113U68A  ON SELE BAR 2 OF POPUP _qvl0lu44t
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   26
*       * Called By:  ON SELE BAR 2 OF POPUP _qvl0lu44t
*       * Prompt:     Facturas del día
*       * Snippet:    3
*       *
*       *********************************************************
*
PROCEDURE _r3113u68a
=OPCLI()
=OPFAC()
TT="Listado de Facturas Emitidas"
tt1="del día "+dtoc(m.fecini)
repo form lfac1 for fechaem=date() ;
to prin ;
noconsole



*       *********************************************************
*       *
*       * _R3113U698  ON SELE BAR 3 OF POPUP _qvl0lu44t
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   27
*       * Called By:  ON SELE BAR 3 OF POPUP _qvl0lu44t
*       * Prompt:     Facturas entre Fechas
*       * Snippet:    4
*       *
*       *********************************************************
*
PROCEDURE _r3113u698
=OPCLI()
=OPFAC()
store {} to m.fecini,m.fecfin
if entre_fe("a Listar")
TT="Listado de Facturas Emitidas"
tt1="Entre el "+dtoc(m.fecini)+" y el "+dtoc(m.fecfin)
repo form lfac1 ;
to prin ;
noconsole ;
for fac.fechaem>=m.fecini .and. ;
fac.fechaem<=m.fecfin
endif

*       *********************************************************
*       *
*       * _R3113U6KD  ON SELE BAR 2 OF POPUP resumendec
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   36
*       * Called By:  ON SELE BAR 2 OF POPUP resumendec
*       * Prompt:     Análisis de un Cliente
*       * Snippet:    11
*       *
*       *********************************************************
*
PROCEDURE _r3113u6kd
=OPCLI()
=OPCCL()
DO LANACCLI

*       *********************************************************
*       *
*       * _R3113U6MT  ON SELE BAR 1 OF POPUP precios
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   40
*       * Called By:  ON SELE BAR 1 OF POPUP precios
*       * Prompt:     Por Rubro
*       * Snippet:    12
*       *
*       *********************************************************
*
PROCEDURE _r3113u6mt
=OPMER()
=OPRUB()
store nul to respuesta
if !empty(elirub("a Consultar",-1,1))
   sele mer
   fisc="mer.rubro='"+left(mix.texto2,3)+"'"
   tt=" Por Rubro: "+alltrim(mix.texto1)+" "
   do consmer1
endif



*       *********************************************************
*       *
*       * _R3113U6NQ  ON SELE BAR 2 OF POPUP precios
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   41
*       * Called By:  ON SELE BAR 2 OF POPUP precios
*       * Prompt:     Por Proveedor
*       * Snippet:    13
*       *
*       *********************************************************
*
PROCEDURE _r3113u6nq
=OPMER()
=OPPRO()
store nul to respuesta
if !empty(eliPRO("a Consultar",-1,1))
   sele mer
   fisc="mer.proveedor='"+per.codcli+"'"
   tt=" Por Proveedor: "+alltrim(per.cliente)+" "
   do consmer1
endif



*       *********************************************************
*       *
*       * _R3113U6ON  ON SELE BAR 3 OF POPUP precios
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   42
*       * Called By:  ON SELE BAR 3 OF POPUP precios
*       * Prompt:     Por Teclado
*       * Snippet:    14
*       *
*       *********************************************************
*
PROCEDURE _r3113u6on
=OPMER()
store "" to ELTEX
IF intex("Descripción a Listar",20)
   sele mer
   fisc="'"+alltrim(ELTEX)+"' $ mer.merca"
   tt=" Por Texto: "+alltrim(ELTEX)+" "
   do consmer1
endif



*       *********************************************************
*       *
*       * _R3113U6PJ  ON SELE BAR 4 OF POPUP precios
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   43
*       * Called By:  ON SELE BAR 4 OF POPUP precios
*       * Prompt:     Completo
*       * Snippet:    15
*       *
*       *********************************************************
*
PROCEDURE _r3113u6pj
=OPMER()
store nul to respuesta
if !empty(eliMER("a Consultar",-1,1))
   sele mer
   fisc=".T."
   tt=" Completo "
   do consmer1
endif



*       *********************************************************
*       *
*       * _R3113U6SV  ON SELE POPUP listadospo
*       *
*       * Procedure Origin:
*       *
*       * From Menu:  FACTURAM.MPR,            Record:   16
*       * Called By:  ON SELE POPUP listadospo
*       * Snippet:    16
*       *
*       *********************************************************
*
PROCEDURE _r3113u6sv
WAIT "ESTOY" WIND
=OPCLI()
=OPFAC()
