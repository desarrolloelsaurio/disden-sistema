*USE F:\SISTEMAS\VENTAS\VENTASA\CCCLI ALIAS CCL ORDE TAG CODCLI
USE C:\SIST2000\VENTAS\VENTASA\CCCLI ALIAS CCL ORDE TAG CODCLI
SELE CCL

      REPL ALL GY_DEBE WITH 0,GY_HABER WITH 0
      
	REPL GY_DEBE WITH COMISip FOR ;
	       COMPRRE='FA' .OR. ;
      	 COMPRRE='ND' .OR. ;
	       COMPRRE='SD' .OR. ;
      	 COMPRRE='AL'
      	 
      REPL GY_HABER WITH COMISIp FOR EMPTY(GY_DEBE)

      TMP1="C:\TEMP1"
*****      INDEX ON CODCLI TAG CODCLI
*****      SET ORDER TO TAG CODCLI

      TOTAL ON CODCLI FIELD GY_DEBE,GY_HABER TO (TMP1)
*****      DELE FOR COMPRRE="SA" .OR. COMPRRE="SD"
*****      PACK
      SELE 0
      USE (TMP1) ALIAS TMP1 EXCL
      INDEX ON CODCLI TAG CODCLI
      SET ORDER TO TAG CODCLI
      DELE FOR GY_DEBE=GY_HABER
      PACK
*      SELE CCL
*      DELE FOR FECHAOP<=M.FECINI
*      SCAT MEMV BLAN
*      M.FECHAOP=M.FECINI
*      M.FECHAVE=M.FECINI
*      M.DETALLE="Saldo al "+dtoc(m.fecini)
*      SELE TMP1
	REPLACE COMISIp WITH IIF (tmp1.gy_debe>tmp1.gy_haber, tmp1.gy_debe-tmp1.gy_haber,0) ALL
      USE F:\SISTEMAS\VENTAS\VENTASA\CCCLI ALIAS ORIGEN ORDE TAG CODCLI IN 0
      SELE ORIGEN
      REPLACE COMISIp WITH 0 FOR COMPRRE="SD" OR COMPRRE="SA"    
      SET RELA TO CODCLI INTO TMP1
      REPLACE COMISIp WITH TMP1.COMISIp FOR COMPRRE="SD" OR COMPRRE="SA" 
      