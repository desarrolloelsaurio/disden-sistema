***********************************************
*-- Programa: LIDATMER.PRG
*-- Fecha   : 26/9/89
*-- Version : G. REINER
*-- Notas   : DECIDE QUE HACER CON EL LISTADO DE MERCADERIAS
*             GENERA UN POUP CLI1
***********************************************
#DEFINE PAIP   "|"                               && PAIP
SELE PRO
SET ORDER TO TAG FIRMA
FINCLI=RECCOUNT('PER')
SELE MER
SET ORDER TO TAG ARTIC
GO TOP
DO CASE
CASE BAR()=1
   DEFI POPU CACA FROM 11,50
   DEFI BAR 1 OF CACA PROM ' Un S¢lo Producto '
   DEFI BAR 2 OF CACA PROM ' Todos'
   ON SELE POPU CACA DO RESP1
   ACTI POPU CACA
   DO CASE
   CASE BAR()=1
      DO INFIC WITH FINMER,'DE PRODUCTO A LISTAR '
      IF !EMPTY(RESPUESTA)
         GO RESPUESTA
         DEFI WIND WIN FROM 0,0 TO 24,79 NONE
         ACTI WIND WIN
         DO LIMERUN WITH RESPUESTA
         DEAC WIND ALL
      ENDI
   CASE BAR()=2
      DO LIMERPAO
   ENDC
CASE BAR()=2
   DEFI WIND CACA FROM 1,0 TO 5,79 DOUB
   ACTI WIND CACA
   DO TIT2 WITH 1,' LISTADO DE MERCADERIAS - Porc. de Ganancia ','I',78
   DEFI WIND WIN FROM 5,0 TO 21,79 DOUB
   SELE PRO
   SET ORDER TO TAG PROVEEDOR
   SELE MER
   BROWSE NOINIT NOFOLLOW NOAPPEND NOEDIT NODELETE COMPRESS FIELDS ARTIC,DETALLE,PRO.FIRMA /15,COSTO,COSTOR,MAY,MAY30,MIN,MIN30,MRK WIND WIN
   RELE WIND CACA
   SELE PRO
   SET ORDER TO TAG FIRMA
   SELE MER
CASE BAR()=3
   DEFI WIND WIN FROM 0,0 TO 24,79 ;
	 TITL ' LISTADO DE MERCADERIAS - Precios ' ;
	 FOOT JANNAME DOUB
	 ACTI WIND WIN
   SELE PRO
   SET ORDER TO TAG PROVEEDOR
   SELE MER
   BROW NOIN NOFO NOAP NOED NODE COMP IN WIN;
     FIEL ;
     PV=IIF(EMPTY(PRO.FIRMA),REPL("-",15),LEFT(PRO.FIRMA,15)):H=PADC("PROVEEDOR",15),;
     DETALLE,COSTO,COSTO_REAL=COSTO*(1+COSTOR/100),;
     MAYORISTA=COSTO*(1+COSTOR/100)*(1+MAY/100),;
     MAYOR_30=COSTO*(1+COSTOR/100)*(1+MAY30/100),;
     MINORISTA=COSTO*(1+COSTOR/100)*(1+MIN/100)*IIF(IVA="S",1.15,1),;
     MINOR_30=COSTO*(1+COSTOR/100)*(1+MIN30/100)*IIF(IVA="S",1.15,1),IVA
   SELE PRO
   SET ORDER TO TAG FIRMA
   SELE MER
   RELE WIND WIN
CASE BAR()=5
   DO LIDATMEI WITH 1
CASE BAR()=6
   DO LISDOL
CASE BAR()=7
   DO LIDATMEI WITH 2
CASE BAR()=8
   DO LIDATMEI WITH 3
CASE BAR()=9
   DO LIDATMEI WITH 4
CASE BAR()=10
   DEFI POPU PRIME FROM 12,45 MESS 'Listado de Mercader¡as Valor Dolar'
   DEFI BAR 1 OF PRIME PROM ' Lista Seis Totales'
   DEFI BAR 2 OF PRIME PROM ' Lista Precios de Costo'
   DEFI BAR 3 OF PRIME PROM ' Lista Precios Mayoristas'
   DEFI BAR 4 OF PRIME PROM ' Lista Precios Minoristas '
   DEFI BAR 5 OF PRIME PROM ' Lista un Total'
   DEFI BAR 6 OF PRIME PROM '\-' SKIP
   DEFI BAR 7 OF PRIME PROM ' Costo Real (Bochi)'
   DEFI BAR 8 OF PRIME PROM ' Lista 4 Totales (Bochi)'
	 DEFI BAR 9 OF PRIME PROM ' Lista Mayorista'
   DEFI BAR 10 OF PRIME PROM ' Lista Minorista'

   ON SELE POPU PRIME DO LIMERDOL
   ACTI POPU PRIME
CASE BAR()=12
   DEFI POPU drek FROM 17,45 MESS 'Listado de Mercader¡as Valor Dolar'
   DEFI BAR 1 OF drek PROM ' Precios'
   DEFI BAR 2 OF drek PROM ' Textos de Publicidad'
   on sele popu drek do lisofed
   acti popu drek
   rele popu drek
CASE BAR()=13
   DO LISCATE
CASE BAR()=15
   DO LISBLAN
CASE BAR()=16
   DO OPAUD
   DO OPSEG
   =WORKING()
   =DOTALK()
   SELE MER
   SORT ON ARTIC TO NADA FOR IMPORPROP
   SELE 27
   USE NADA ALIAS TMP
   TT="Listado de Mercader¡a de Importaci¢n Propia"
   acla=paip+;
   PADC("ARTICULO",15)+PAIP+;
   PADC("DESCRIPCION",40)+PAIP+;
   PADC("PROVEEDOR",20)+PAIP
   m.linea=repl("=",len(m.acla))
   STORE 80 TO M.XACANCHO,M.XACHOJA,m.largo
   m.largoim=len(acla)
   =UNTALK()
   =UNWORK()
   DO LGRLI WITH "TMP","LIMP0()","","LIMPP"
   SELE TMP
   USE
   ERASE NADA.DBF
ENDC
RETURN
