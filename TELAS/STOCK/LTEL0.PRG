FUNCTION LTEL0
EXTERNAL ARRAY TOTAL
#DEFINE PAIP   "|"                            && PAIP
? PAIP
=IIF(VARIABLE[1],QOUT(LEFT(TELS.TELCODPRO,TEXTO[1,2])+PAIP),'')
=IIF(VARIABLE[2],QOUT(left(TELS.TELA,texto[2,2])+PAIP),'')
=IIF(VARIABLE[3],QOUT(SAYPER(TELS.PROCOD,"PROCOD",texto[3,2])+PAIP),'')
=IIF(VARIABLE[4],QOUT(STR(TELS.MONTO,texto[4,2],2)+PAIP),'')
=IIF(VARIABLE[5],QOUT(SAYMIX(TELS.UNIDAD,"MDDCOD",texto[5,2])+PAIP),'')
=IIF(VARIABLE[6],QOUT(SAYMIX(TELS.COLOR,"SUECOD",texto[6,2])+PAIP),'')
=IIF(VARIABLE[7],QOUT(SAYMIX(TELS.APLICACION,"APLCOD",texto[7,2])+PAIP),'')
=IIF(VARIABLE[8],QOUT(SAYMIX(TELS.marca,"MARCOD",texto[8,2])+PAIP),'')
IF VIRTUAL
   =IIF(VARIABLE[9], QOUT(STR(TELS.STOCK,texto[9,2],2)+PAIP),'')
   =IIF(VARIABLE[10],QOUT(STR(TELS.STOCKRES,texto[10,2],2)+PAIP),'')
   =IIF(VARIABLE[11],QOUT(STR(TELS.STOCK-STOCKRES,texto[11,2],2)+PAIP),'')
   =IIF(VARIABLE[12],QOUT(STR(TELS.STKRESPEN,texto[12,2],2)+PAIP),'')
   =IIF(VARIABLE[13],QOUT(STR(IIF(SEEK(TELS.TELCODPRO+STR(1),'TMP3'),TMP3.PEDIDO-TMP3.RECIBIDO,0),texto[13,2],2)+PAIP),'')
   =IIF(VARIABLE[14],QOUT(STR(IIF(SEEK(TELS.TELCODPRO+STR(2),'TMP3'),TMP3.PEDIDO-TMP3.RECIBIDO,0),texto[14,2],2)+PAIP),'')
   =IIF(VARIABLE[15],QOUT(STR(IIF(SEEK(TELS.TELCODPRO+STR(3),'TMP3'),TMP3.PEDIDO-TMP3.RECIBIDO,0),texto[15,2],2)+PAIP),'')
ELSE
IF DESTOCK
   IF VARIABLE[9]
      =QOUT(STR(TELS.STOCK,texto[9,2],2)+PAIP)
      IF EMPTY(DIFERENCIA)
         IF ISARRAY(@TOTAL)
            STORE TOTAL[1]+TELS.STOCK TO TOTAL[1]
         ELSE
            STORE TOTAL+TELS.STOCK TO TOTAL
         ENDIF
         IF TYPE("STOTAL")#"U"
            STORE STOTAL+TELS.STOCK TO STOTAL
         ENDIF
      ENDIF
   ENDIF
   =IIF(VARIABLE[10],QOUT(STR(TELS.STOCKMAX,texto[10,2],2)+PAIP),'')
   =IIF(VARIABLE[11],QOUT(STR(TELS.STOCKMIN,texto[11,2],2)+PAIP),'')
   =IIF(VARIABLE[12],QOUT(STR(TELS.STOCKUSO,texto[12,2],2)+PAIP),'')
   =IIF(VARIABLE[13],QOUT(STR(TELS.STOCKRES,texto[13,2],2)+PAIP),'')
   IF !EMPTY(DIFERENCIA)
      DO CASE
      CASE DIFERENCIA=1                         && STOCK MENOR QUE EL MINIMO
         =IIF(VARIABLE[14],QOUT(STR(TELS.STOCKMIN-TELS.STOCK,texto[14,2],2)+PAIP),'')
      CASE DIFERENCIA=2                      && STOCK MAYOR QUE EL MAXIMO
         =IIF(VARIABLE[14],QOUT(STR(TELS.STOCK-TELS.STOCKMAX,texto[14,2],2)+PAIP),'')
      CASE DIFERENCIA=3
         =IIF(VARIABLE[14],QOUT(STR(TELS.STOCK*TELS.MONTO,texto[14,2],2)+PAIP),'')
         DO CASE
         CASE ISARRAY(@TOTAL)
            STORE TOTAL[1]+TELS.STOCK*TELS.MONTO TO TOTAL[1]
         CASE TYPE("STOTAL")#"U"
            STORE STOTAL+TELS.STOCK*TELS.MONTO TO STOTAL
         OTHERWISE
            STORE TOTAL+TELS.STOCK*TELS.MONTO TO TOTAL
         ENDCASE
      ENDCASE
   ENDIF
ENDIF
ENDIF
CASOS=CASOS+1
RETURN .T.
