* 旼 PROGRAMA 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커
*   APLICACION: SISTEMAS VARIOS                                             
*     ARCHIVO : Q_CUOT.PRG                                                  
*        AUTOR: G. REINER                                                   
*  DATE CREATED: 11-12-92                                                   
*  TIME CREATED: 12:55:51PM                                                 
*     COPYRIGHT: 1992 BY SISTEMAS INFORMATICOS S.R.L.                       
* 읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
* PARAMETROS (PARA LA GILADA)
* XMONTO=MONTO TOTAL DE LA DEUDA (NUMERICO)
* VENTANA=TRABAJA DENTRO DE VENTANA ? (LOGICO)
* REN=RENGLON INICIAL DE LA VENTANA (NUMERICO)
* COL=COLUMNA INICIAL DE LA VENTANA (NUMERICO)
* ANCHOR=ANCHO DE LA VENTANA (NUMERICO)
* ENTERO=CANTIDAD DE CIFRAS ENTERAS DEL MONTO
* DECIMAL=CANTIDAD DE CIFRAS DECIMALES DEL MONTO
* NUEVOCRIT USA EL NUEVO CRITERIO DE CALCULO DE CALCULO DE PLAZOS
FUNCTION Q_CUOT
	PARAMETER Q_MONTO,Q_VENTANA,Q_REN,Q_COL,Q_ANCHOR,Q_ENTERO,Q_DECIMAL,NUEVOCRIT
	PRIVATE Q_MONTO,Q_VENTANA,Q_REN,Q_COL,Q_ANCHOR,Q_ENTERO,Q_DECIMAL,X,Q_RENIMP,UNA,NUEVOCRIT
	Q_MONTO=ROUND(Q_MONTO,2)
	XCUOT=ALEN(FECHAS,1)
	Q_ENTERO=IIF(TYPE('Q_ENTERO')#'N',11,Q_ENTERO)
	Q_DECIMAL=IIF(TYPE('Q_DECIMAL')#'N',2,Q_DECIMAL)
	UNA=ROUND(Q_MONTO/XCUOT,Q_DECIMAL)
	MONTOCUOT=UNA
	MONTOCUOT[1]=IIF(UNA*XCUOT=Q_MONTO,0,Q_MONTO-UNA*XCUOT)+UNA
	IF PARAMETER()#1
		IF Q_VENTANA
			=MOVEWIN(Q_REN,Q_COL,Q_REN+XCUOT+3,Q_COL+Q_ANCHOR,'CUOTAS','CUOTAS')
		ENDIF
		Q_RENIMP=IIF(Q_VENTANA,1,XXTONUM(Q_REN))
		Q_COL=IIF(Q_VENTANA,1,XXTONUM(Q_COL))
		Q_ANCHOR=IIF(Q_VENTANA,Q_COL+10,IIF(!EMPTY(XXTONUM(Q_ANCHOR)),Q_ANCHOR,10))
		=TQ_CUOT(XCUOT,Q_RENIMP,Q_COL,Q_ANCHOR)
		CLEA GETS
		DO WHILE .T.
			=TQ_CUOT(XCUOT,Q_RENIMP,Q_COL,Q_ANCHOR)
			IF COEFSEG<3
				READ
			ELSE
				CLEA GETS
			ENDIF
			IF AR_SUM("MONTOCUOT",1)=Q_MONTO
				EXIT
			ENDIF
		ENDDO
		IF Q_VENTANA
			=RELEWIN('CUOTAS')
		ENDIF
	ENDIF
RETURN .T.

FUNCTION TQ_CUOT
	PARAMETER F,R,C,CP
	PRIVATE F,R,C,CP,PIX,X
	PIX=RIGHT('999,999,999,999,999',Q_ENTERO)+'.'+REPL("9",Q_DECIMAL)
	FOR X=1 TO F
		@ R,C SAY "CUOTA "+ALLTRIM(STR(X)) COLO SCHE 3
		@R,C+8 GET FECHAS[X]
		@R,C+CP+8 GET MONTOCUOT[X] PICT PIX
		R=R+1
	NEXT 
RETURN .T.
