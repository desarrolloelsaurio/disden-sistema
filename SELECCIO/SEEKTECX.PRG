* ษออออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : SEEKTECX.PRG         บ
* ฬออออออออออออออออออออออออออออออออออออออน
* บ AUTOR      : GOYO REINER             บ
* บ FECHA      : 11-02-93                บ
* บ HORA       : 08:10:24pm              บ
* บ COPYRIGHT  : 1993 by GREGORIO REINER บ
* ศออออออออออออออออออออออออออออออออออออออผ
* S_LARGO  -> CANTIDAD DE CARACTERES A INGRESAR
* LABASE   -> BASE SOBRE LA QUE SE EFECTUA LA BUSQUEDA
* LOBUSCO  -> NOMBRE DEL CAMPO QUE SE BUSCA (PER.CLIENTE)
* LOBUSCO1 -> CAMPO QUE DEVUELVE (EL QUE SE USARA EN EL SEEK DE VALIDACION)
* ELORDENX  -> ORDER TAG DEL CAMPO DE BUSQUEDA (LOBUSCO)
* BASEANT  -> BASE A LA QUE SE DEBE VOLVER
* ORDENANT -> ORDER TAG DE LA BASE BASEANT
* S_REN    -> RENGLON PARA ESCRIBIR EL TEXTO
* S_COL    -> COLUMNA INICIAL DE INPUT DE TEXTO
* S_NOK    -> MANDA UN ENTER DE COLITA ?
* EN_VENTANA -> HACE EL INGRESO EN UNA VENTANA
FUNCTION SEEKTECX
PARAMETER S_LARGO,LABASE,LOBUSCO,LOBUSCO1,ELORDENX,BASEANT,ORDENANT,S_REN,S_COL,S_NOK,EN_VENTANA
#DEFINE NUL    0                                 && NUL
S_VENTANA=WONTOP()
#IF "Wind" $ VERS()
   ACTI SCRE
   =MOVEWIN(10,10,15,SCOLS()-10,"SEEKTEC","B๚squeda por Teclado","","Courier New",16, "C:\WINDOWS\BMP\miel.bmp")
   STORE 1 TO M.RNN,M.CLL
#ELSE
   WAIT "TECLEE EL TEXTO / [] Prขx [] Ant [PgDn] Prขx 20 [PgUp] Ant 20" WIND NOWA
   IF EN_VENTANA
      =MOVEWIN(10,10,14,70,"SEEKTEC","Bฃsqueda por Teclado","")
      STORE 1 TO M.CLL
      STORE NUL TO M.RNN
   ELSE
      RNN=IIF(EMPTY(S_REN),ROW(),S_REN)
      CLL=IIF(EMPTY(S_COL),COL(),S_COL)
   ENDIF
#ENDIF
STORE '' TO LEER
SET CONF OFF
SET NEAR ON
SET EXACT OFF
SET BELL OFF
IF PARAMETER()>3
   BASEANT=ALIAS()
   IF PARAMETER()>4
      ORDENANT=ORDER()
   ELSE
      ORDENANT=''
   ENDIF
ELSE
   BASEANT=''
ENDIF
SELE (LABASE)
SET ORDER TO TAG (ELORDENX)
IF EMPTY(S_VENTANA)
   DEFI WIND SEEKTEC FROM RNN,CLL TO RNN,CLL+S_LARGO NONE
   ACTI WIND SEEKTEC
   STORE NUL TO cll,RNN
ENDIF
#IF "Wind" $ VERS()
**   @ RNN,CLL SAY LEER PICT "X" COLOR I STYLE "T"
   @ RNN,CLL SAY LEER PICT "X" 
#ELSE
   @ RNN,CLL GET LEER PICT "X" DISABLE
#ENDIF
FOR A=1 TO S_LARGO
   LEER1=SUBSTR(EVAL(LOBUSCO),A,1)
   #IF "Wind" $ VERS()
**      @ RNN,CLL-1+A GET LEER1 PICT 'X' COLOR I STYLE "T"
      @ RNN,CLL-1+A GET LEER1 PICT 'X' COLOR I 
   #ELSE
      @ RNN,CLL-1+A GET LEER1 PICT 'X'
   #ENDIF
   READ
   DO CASE
   CASE LAST()=3
      SKIP 20
      A=IIF(A>=1,A-1,1)
      LEER=EVAL(LOBUSCO)
   CASE LAST()=5
      LEER=EVAL(LOBUSCO)
      DO WHILE  LEER=EVAL(LOBUSCO)
	      SKIP -1
      ENDDO
      A=IIF(A>=1,A-1,1)
      LEER=EVAL(LOBUSCO)
   CASE LAST()=18
      SKIP -20
      A=IIF(A>=1,A-1,1)
      LEER=EVAL(LOBUSCO)
   CASE LAST()=24
      IF !EOF()
         LEER=EVAL(LOBUSCO)
         DO WHILE  LEER=EVAL(LOBUSCO)
              SKIP 
         ENDDO
         A=IIF(A>=1,A-1,1)
         LEER=EVAL(LOBUSCO)
      ELSE
         WAIT "FIN DE ARCHIVO" WIND NOWA
      ENDIF
   CASE (LAST()>31 .AND. LAST()<123)
      LEER=LEER+LEER1
   CASE LAST()#13
      LEER=LEFT(LEER,LEN(LEER)-1)
      A=LEN(LEER)-1
      A=IIF(A>=0,A,0)
   ENDCASE
   =SEEK(LEER)
   NADA=EVAL(LOBUSCO)
   #IF "Wind" $ VERS()
*      @ RNN,CLL SAY NADA COLOR I STYLE "Q"
      @ RNN,CLL SAY NADA 
   #ELSE
      @ RNN,CLL GET NADA DISABLE
   #ENDIF
   IF LAST()=13 .OR. LAST()=27
      EXIT
   ENDIF
ENDF
RESPUESTA=IIF(LAST()#27,EVAL(LOBUSCO1),'')
SET CONF ON
SET EXACT ON
SET BELL ON
SET NEAR OFF
IF !EMPTY(BASEANT) .AND. !S_NOK
   SELE (BASEANT)
   IF !EMPTY(ORDENANT)
      SET ORDER TO TAG (ORDENANT)
   ENDIF
ENDIF
=RELEWIN("SEEKTEC") .AND. IIF(WONTOP()="FIC",RELEWIN("FIC"),.T.)
IF !S_NOK .AND. LAST()#27
   KEYB CHR(13)
ENDIF
=RELEWIN("SEEKTEC")
RETURN IIF(S_NOK,!EMPTY(RESPUESTA),RESPUESTA)


