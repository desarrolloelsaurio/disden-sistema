* V_LIMPIA  : HACE CLEAR READ
* V_SUMA    : LA CANTIDAD DE REGISTROS QUE SE LE SUMA A MINOBJ
* V_NUMKRES : EL NUMERO DE OBJETO QUE TIENE EL RESUMEN
FUNCTION VAL_OBJ
PARAMETER V_LIMPIA,V_SUMA,V_NUMKRES
IF READKEY()=15 .OR. READKEY()=271
   IF TYPE("V_LIMPIA")="N"
      STORE V_LIMPIA TO V_SUMA
      STORE .F. TO V_LIMPIA
   ELSE
      STORE IIF(EMPTY(V_SUMA),3,V_SUMA) TO V_SUMA
   ENDIF
   IF V_LIMPIA
      CLEA READ
   ELSE
      STORE IIF(EMPTY(V_NUMKRES),0,V_NUMKRES) TO V_NUMKRES
      STORE MAXOBJ+1+IIF(HUBORES,1,0) TO MINOBJ
      STORE MINOBJ+V_SUMA-1 TO MAXOBJ
      HUBORES=IIF(HUBORES,.T.,_CUROBJ=V_NUMKRES)
      IF HUBORES
         IF !EMPTY(V_NUMKRES)
            STORE MAXOBJ-1 TO MAXOBJ
         ENDIF
      ENDIF
      STORE MINOBJ TO _CUROBJ
   ENDIF
ENDIF
RETURN .T.
