   FUNCTION QUEPOPUP
   PARAMETER Q_TEX,Q_REN,Q_COL,Q_ESPECIAL
   PRIVATE QP_CPO,QP_SALIDA,QP_VAR
#DEFINE NUL    0                              && NUL
   PUSH KEY CLEAR
   STORE "" TO M.QP_SALIDA
   M.QP_PROG=PROGRAM()
   =SWAP(@ULPR,@M.QP_PROG)
   M.QP_CPO=UPPER(SYS(18))
   M.QP_WIND=WONTOP()
*   WAIT "ELCAMPO: "+M.QP_CPO WIND
*   WAIT "LAVENTANA:"+M.QP_WIND WIND
   STORE NUL TO RESPUESTA
   DO CASE
   CASE LEFT(M.QP_CPO,5)="C_AG("
      IF ELICAG(Q_TEX,Q_REN,Q_COL)
         M.QP_SALIDA=LEFT(MIX.TEXTO2,2)
      ENDIF
#IF "PROD" $ CURD()
   CASE M.QP_CPO=="TALL"
      M.QP_SALIDA=IIF(!EMPTY(ELICUR("a Listar",-1,1)),cur.curva,"")
   CASE LEFT(M.QP_CPO,5)="ARTI(" .OR. ;
        M.QP_CPO="CODPRO"
      DO CASE
      CASE TIPOMERCA="T"
         M.QP_SALIDA=IIF(ELITELS(Q_TEX,Q_REN,Q_COL),TELS.TELCODPRO,"")
      CASE TIPOMERCA="A"
         M.QP_SALIDA=IIF(ELIAVIS(Q_TEX,Q_REN,Q_COL),AVIS.AVICODPRO,"")
      CASE TIPOMERCA="C"
         M.QP_SALIDA=IIF(ELICOMS(Q_TEX,Q_REN,Q_COL),COMS.COMCODPRO,"")
      CASE TIPOMERCA="O"
         M.QP_SALIDA=IIF(ELIOTRS(Q_TEX,Q_REN,Q_COL),OTRS.OTRCODPRO,"")
      ENDCASE
   CASE M.QP_CPO="SUELA"
      M.QP_SALIDA=IIF(ELISUE(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#ENDIF
#IF "EXPENSAS" $ CURDIR()
   CASE WEXIST("CNX")
      M.QP_SALIDA=IIF(ELICSS(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
#ENDIF
#IF "FELIX" $ CURDIR()
   CASE WEXIST("VIA") .OR. WEXIST("IFACD")
      =QPOVIA()
#ENDIF
#IF "STOCK" $ CURD()
   CASE WEXIST("CID")
      =QPOCID()
#ENDIF
   CASE M.QP_CPO="BANCO" .OR. M.QP_CPO="CODBAN"
      M.QP_SALIDA=IIF(ELIBAN(Q_TEX,Q_REN,Q_COL),MIX.NU1,NUL)
   CASE M.QP_CPO="CAR1" .OR. ;
        M.QP_CPO="CAR2" .OR. ;
        M.QP_CPO="CAR3"
      M.QP_SALIDA=IIF(!EMPTY(ELICAR(Q_TEX,Q_REN,Q_COL)),LEFT(MI1.TEXTO2,2),"")
   CASE WEXIST("MIX")
      IF WEXIST("XWIN")
         DO CASE
         CASE M.QP_CPO="CODCLI"
            M.QP_SALIDA=IIF(ELIUSU(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
         CASE M.QP_CPO="PROCOD"
            M.QP_SALIDA=IIF(ELIPRO(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
         ENDCASE
      ELSE
         DO CASE
         CASE M.QP_CPO="TPR"
            =V_TPR()
#IF "LABORA" $ CURDIR()
         CASE M.QP_CPO="PRACTIC1"
            M.QP_SALIDA=IIF(ELIPRA(Q_TEX,Q_REN,Q_COL,M.TPR),PRA.CODPRA,"")
         CASE M.QP_CPO="PRXCOD1"
            M.QP_SALIDA=IIF(ELIPRX(Q_TEX,Q_REN,Q_COL,Q_ESPECIAL),PRX.CODPRX,"")
#ENDIF
         OTHERWISE
            V_VAR="ELI"+M.QP_PROG+"(Q_TEX,Q_REN,Q_COL)"
            M.QP_SALIDA=IIF(EVAL(V_VAR),IIF(M.QP_CPO="TEXTO1",MIX.TEXTO1,LEFT(MIX.TEXTO2,2)),"")
         ENDCASE
      ENDIF
   CASE M.QP_CPO="CONDPAGO"
      M.QP_SALIDA=IIF(ELIPAG(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="GASTO" .OR. M.QP_CPO="GASCOD"
      M.QP_SALIDA=IIF(ELIGAS(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,11),"")
   CASE WEXIST("MI1")
      V_VAR="ELI"+M.QP_PROG+"(Q_TEX,Q_REN,Q_COL)"
      M.QP_SALIDA=IIF(EVAL(V_VAR),IIF(M.QP_CPO="TEXTO1",MI1.TEXTO1,LEFT(MI1.TEXTO2,2)),"")
   CASE WEXIST("PER") .AND. ;
        (M.QP_CPO="CLIENTE" .OR. M.QP_CPO="CODCLI")
      V_VAR="ELI"+M.QP_PROG+"(Q_TEX,Q_REN,Q_COL)"
      M.QP_SALIDA=IIF(EVAL(V_VAR),IIF(M.QP_CPO="CLIENTE",PER.CLIENTE,PER.CODCLI),"")
   CASE WEXIST("PER") .AND. ;
        !WEXIST("XPER") .AND. ;
        M.QP_CPO="TEXTO1"
      IF TYPE("TEXTEX")="C"
         IF TEXTEX="ZONTEX"
         M.QP_SALIDA=IIF(ELIZON(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")         
         ELSE
         M.QP_SALIDA=IIF(ELISEC(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
         ENDIF
      ENDIF
   CASE WEXIST("XPER")
      DO CASE
      CASE M.QP_CPO="ARTICULO"
         M.QP_SALIDA=IIF(EMPTY(ELIMER(Q_TEX,Q_REN,Q_COL)),"",MER.ARTICULO)
      CASE M.QP_PROG="MED"
#IF "LABORA" $ CURDIR()
         DO CASE
         CASE M.QP_CPO="TEXTO1"
            M.QP_SALIDA=IIF(ELISAN(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
         CASE M.QP_CPO="TEXTO2"
            M.QP_SALIDA=IIF(ELIESP(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
         ENDCASE
#ENDIF
#IF "SUELDO" $ CURD()
      CASE LEFT(M.QP_CPO,3)="THO"
         M.QP_SALIDA=IIF(EMPTY(ELITHO(Q_TEX,Q_REN,Q_COL)),"",LEFT(MIX.TEXTO2,2))
#ENDIF
      CASE M.QP_PROG="PAC"
#IF "LABORA" $ CURDIR()
         DO CASE
         CASE M.QP_CPO="TEXTO1"
            M.QP_SALIDA=IIF(ELIMUT(Q_TEX,Q_REN,Q_COL),MUT.CODMUT,"")
         CASE M.QP_CPO="TEXTO2"
            M.QP_SALIDA=IIF(ELIPLAN(Q_TEX,Q_REN,Q_COL,M.TEXTO1),MUT.CODPLAN,"")
         ENDCASE
#ENDIF
      OTHERWISE
#IF "ALQU" $ CURDIR()
         IF M.QP_CPO="CODCLI"
            M.QP_SALIDA=IIF(ELIINQ(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
         ENDIF
#ENDIF
#IF "CAJAS" $ CURDIR()
         M.QP_SALIDA=IIF(ELIOPE(Q_TEX,Q_REN,Q_COL),OPE.CODCLI,"")
#ENDIF
      ENDCASE
#IF "ALQUI" $ CURDIR() .OR. "EXPEN" $ CURDIR()
   CASE WEXIST("XINM")
      DO CASE
      CASE M.QP_CPO="CODCLI"
         M.QP_SALIDA=IIF(ELIINQ(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
      CASE LEFT(M.QP_CPO,6)="CODGAR"
         M.QP_SALIDA=IIF(ELIGAR(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
      CASE M.QP_CPO="CODINM" .OR. M.QP_CPO="DOMICILIO"
         M.QP_SALIDA=IIF(ELIINM(Q_TEX,Q_REN,Q_COL),IIF(M.QP_CPO="CODINM" ,INM.CODINM,INM.DOMICILIO),"")
      ENDCASE
#ENDIF
#IF "LABORA" $ CURDIR()
   CASE WEXIST("ARA")
      DO CASE
      CASE M.QP_CPO="TEXTO1"
         M.QP_SALIDA=IIF(ELITAR(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
      CASE M.QP_CPO="TEXTO2"
         M.QP_SALIDA=IIF(ELIUNI(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
      OTHERWISE
         M.QP_SALIDA=IIF(ELIARA(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
      ENDCASE
#ENDIF
#IF "PRODUC" $ CURDIR()
   CASE M.QP_CPO="AVICODPRO" .OR. ;
        M.QP_CPO="AVIO" .OR. ;
        M.QP_CPO=="AVI"
      M.QP_SALIDA=IIF(ELIAVIS(Q_TEX,Q_REN,Q_COL),AVIS.AVICODPRO,"")
   CASE M.QP_CPO="TELCODPRO" .OR. ;
        M.QP_CPO=="TEL"
      M.QP_SALIDA=IIF(ELITELS(Q_TEX,Q_REN,Q_COL),TELS.TELCODPRO,"")
   CASE M.QP_CPO="TELA"
      IF WEXIST("MER")
         M.QP_SALIDA=IIF(ELITEL(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
      ELSE
         M.QP_SALIDA=IIF(ELITELS(Q_TEX,Q_REN,Q_COL),TELS.TELCODPRO,"")
      ENDIF
   CASE M.QP_CPO="COMCODPRO" .OR. ;
        M.QP_CPO="COMPRA"
      M.QP_SALIDA=IIF(ELICOMS(Q_TEX,Q_REN,Q_COL),COMS.COMCODPRO,"")
   CASE M.QP_CPO="OTRCODPRO" .OR. ;
        M.QP_CPO="OTRO"
      M.QP_SALIDA=IIF(ELIOTRS(Q_TEX,Q_REN,Q_COL),OTRS.OTRCODPRO,"")
#ENDIF
   CASE M.QP_CPO="ARTICULO"
#IF "PRODUC" $ CURDIR()   
      DO CASE
      CASE TYPE("ESAVIO")="U"
         M.QP_SALIDA=IIF(EMPTY(ELIMER(Q_TEX,Q_REN,Q_COL)),"",MER.ARTICULO)
      CASE ESAVIO
         M.QP_SALIDA=IIF(ELIAVIS(Q_TEX,Q_REN,Q_COL),AVIS.AVICODPRO,"")
      OTHERWISE
         M.QP_SALIDA=IIF(ELITELS(Q_TEX,Q_REN,Q_COL),TELS.TELCODPRO,"")
      ENDCASE
#ELSE 
    IF SSTM2="COMPRAS"
      IF M.QP_WIND="REQINSA"
       M.QP_SALIDA=IIF(ELIMER(Q_TEX,Q_REN,Q_COL,.T.),MER1.ARTICULO,"")
      ENDIF
    ELSE
       M.QP_SALIDA=IIF(ELIMER(Q_TEX,Q_REN,Q_COL),MER.ARTICULO,"")
    ENDIF
#ENDIF      
   CASE WEXIST("FAC") .AND. ;
        M.QP_CPO="CODCLI" .AND. ;
        ESREMITO .AND. TIPOREMITO=2
      M.QP_SALIDA=IIF(ELISUC(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,4),"")
   CASE M.QP_CPO="CODCLI"
      M.QP_SALIDA=IIF(ELICLI(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
#IF  "ALQU" $ CURDIR() .OR. "NOVO" $  CURDIR()
   CASE LEFT(M.QP_CPO,6)="CODGAR"
      M.QP_SALIDA=IIF(ELIGAR(Q_TEX,Q_REN,Q_COL),PER.CODGAR,"")
#ENDIF
#IF "ALQU" $ CURDIR() .OR. "EXPE" $ CURDIR() .OR. "RAFUL" $ CURDIR()
   CASE M.QP_CPO="CODINM" .OR. M.QP_CPO="DOMICILIO"
      M.QP_SALIDA=IIF(ELIINM(Q_TEX,Q_REN,Q_COL),IIF(M.QP_CPO="CODINM",INM.CODINM,INM.DOMICILIO),"")
#ENDIF
#IF "LABORA" $ CURDIR()
   CASE M.QP_CPO="CODMUT" .OR. M.QP_CPO="MUTUAL" .OR. M.QP_CPO="MUTUALABR"
      M.QP_SALIDA=IIF(ELIMUT(Q_TEX,Q_REN,Q_COL),IIF(M.QP_CPO="CODMUT" ,MUT.CODMUT,MUT.MUTUAL),"")
   CASE M.QP_CPO="CODPLAN" .OR. M.QP_CPO="PLAN"
      M.QP_SALIDA=IIF(ELIPLAN(Q_TEX,Q_REN,Q_COL,M.CODMUT),MUT.CODPLAN,"")
#ENDIF
   CASE M.QP_CPO="ESTRUC"
      M.QP_SALIDA=IIF(ELITST(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="COLOR"
#IF "NOVOGAR" $ CURDIR()
      M.QP_SALIDA=IIF(ELICOL(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#ELSE "PROD" $ CURDIR()
      IF TYPE("CONESTRUC")#"U" .AND. CONESTRUC
         M.QP_SALIDA=IIF(ELITST(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
      ELSE
         M.QP_SALIDA=IIF(ELISUE(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
      ENDIF
#ENDIF
   CASE M.QP_CPO="CONDIVA"
      IF TYPE("CONDIVA")="C"
         M.QP_SALIDA=IIF(ELIIVA(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
      ELSE
         M.QP_SALIDA=ELIIVA(Q_TEX,Q_REN,Q_COL)
      ENDIF
   CASE M.QP_CPO="ENCARPAG"
      M.QP_SALIDA=IIF(ELIAGE(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
#IF "PROD" $ CURDIR()
   CASE M.QP_CPO="ETAPA"
      M.QP_SALIDA=IIF(ELIETA(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#ENDIF
   CASE M.QP_CPO="ESTADO"
      M.QP_SALIDA=IIF(ELIEST(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="GRUPO"
      M.QP_SALIDA=IIF(ELIGRU(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="LOCALIDAD"
      M.QP_SALIDA=IIF(ELICIU(Q_TEX,Q_REN,Q_COL),SUBST(MIX.TEXTO2,7,6),NUL)
#IF "LABORA" $ CURDIR()
   CASE M.QP_CPO="MEDICO" .OR. M.QP_CPO="ENCARMED"
      M.QP_SALIDA=IIF(ELIMED(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
#ENDIF
   CASE M.QP_CPO="OPK"
      M.QP_SALIDA=IIF(ELIOPK(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#IF "ALQUI" $ CURDIR() .OR. "EXPEN" $ CURDIR() .OR. "IMPU" $ CURDIR()
   CASE M.QP_CPO="PARTIDA"
      M.QP_SALIDA=IIF(ELIINM(Q_TEX,Q_REN,Q_COL),EVAL(M.NOMCAMPO),"")
#ENDIF
   CASE M.QP_CPO="PROCOD" .OR. ;
        M.QP_CPO="PROVEEDOR" .OR. ;
        M.QP_CPO="PRO1" .OR. ;
        M.QP_CPO="PRO2" .OR. ;
        M.QP_CPO="PRO3"
      IF SSTM1="ADMIN"
         IF M.QP_PROG="IFACD"
            M.QP_SALIDA=IIF(ELIPRO(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
         ELSE
#IF "ALQU" $  CURDIR() .OR. "EXPE" $ CURDIR()
            M.QP_SALIDA=IIF(ELIPRP(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
#ENDIF
         ENDIF
      ELSE
         M.QP_SALIDA=IIF(ELIPRO(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
      ENDIF
#IF EMPTY(AT("LABOR",CURDIR()))
   CASE M.QP_CPO="RUBRO" .OR. ;
        M.QP_CPO="CODRUB" .OR. ;
        M.QP_CPO="RUB"
#IF "PRODUC" $ CURDIR() .AND. "STOC" $ CURDIR()
      IF WEXIST("IDATOTAL")
         M.QP_SALIDA=IIF(ELIRUB(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,3),"")
      ELSE
         M.QP_SALIDA=IIF(ELIRUS(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,3),"")
      ENDIF
#ELSE
      IF Q_ESPECIAL
         IF ELIMER(Q_TEX,Q_REN,Q_COL)
            M.RUBRO=MER.RUBRO
            M.SUBRUBRO=MER.SUBRUBRO
            M.MODELO=MER.MODELO
            M.ARTICULO=MER.ARTICULO
         ENDIF
      ELSE
         M.QP_SALIDA=IIF(ELIRUB(Q_TEX,Q_REN,Q_COL),IIF(USED("RUB"),RUB.CODRUB,LEFT(MIX.TEXTO2,3)),"")
      ENDIF
#ENDIF
   CASE M.QP_CPO="SUBRUBRO"
      M.QP_SALIDA=IIF(TYPE("M.RUBRO")="U",;
        IIF(ELISRU(Q_TEX,Q_REN,Q_COL),RUB.CODSRUB,""),;
        IIF(ELISRU1(Q_TEX,Q_REN,Q_COL,M.RUBRO),RUB.CODSRUB,""))
#ENDIF
   CASE M.QP_CPO="TALLER" .OR. M.QP_CPO="TALCOD"
      M.QP_SALIDA=IIF(EMPTY(ELITALS(Q_TEX,Q_REN,Q_COL)),"",PER.CODCLI)
   CASE M.QP_CPO="TAR" .OR. ;
        M.QP_CPO="TARJETA"
      M.QP_SALIDA=IIF(ELITAR(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="TPR"
      =V_TPR()
   CASE M.QP_CPO="TIPOUNID"
      M.QP_SALIDA=IIF(ELITIP(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="TIPODOC"
      M.QP_SALIDA=IIF(ELIDNI(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="TIPO"
      M.QP_SALIDA=IIF(ELITIP(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,3),"")
   CASE M.QP_CPO="TFA"
      M.QP_SALIDA=IIF(ELITFA(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#IF "LABORA" $ CURDIR()
   CASE M.QP_CPO="PRACTICA" .OR. ;
        QP_CPO="CODPRA" .OR. ;
        QP_CPO="UNIPRA"
      IF ELIPRA(Q_TEX,Q_REN,Q_COL,IIF(WEXIST("LIQ"),M.TPR,""))
         M.QP_SALIDA=IIF(M.QP_CPO="PRACTICA" .AND. !WEXIST("LIQ"),PRA.PRACTICA,PRA.CODPRA)
      ENDIF
   CASE M.QP_CPO="CODPRX"
      M.QP_SALIDA=IIF(ELIPRX(Q_TEX,Q_REN,Q_COL,M.CODPRA),PRX.CODPRX,"")
   CASE M.QP_CPO="PACIENTE"
      M.QP_SALIDA=IIF(ELIPAC(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
   CASE M.QP_CPO="PRXCOD"
      M.QP_SALIDA=IIF(ELIPRX(Q_TEX,Q_REN,Q_COL,Q_ESPECIAL),PRX.CODPRX,"")
   CASE M.QP_CPO="INTERNO"
      M.QP_SALIDA=IIF(ELIINTER(Q_TEX,Q_REN,Q_COL),PER.CODCLI,"")
   CASE M.QP_CPO="UNIDAD1" .OR. M.QP_CPO="UNIDAD2"
      M.QP_SALIDA=IIF(ELIUNI(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="UNIDAD3"
      M.QP_SALIDA=IIF(ELIRAD(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#ENDIF
#IF "PRODUC" $ CURDIR() .AND. "STOCK" $ CURDIR()
   CASE M.QP_CPO="UNIDAD"
      M.QP_SALIDA=IIF(ELIMDD(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="APLICACION"
      M.QP_SALIDA=IIF(ELIAPL(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#ELSE
      M.QP_SALIDA=IIF(ELIUNIX(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
#ENDIF
   CASE M.QP_CPO="MARCA"
      IF ELIMAR(Q_TEX,Q_REN,Q_COL)
#IF "PRODUC" $ CURDIR()
         STORE LEFT(MIX.TEXTO2,2) TO M.QP_SALIDA
#ELIF "NOVO" $ CURD()
         STORE LEFT(MI1.TEXTO2,2) TO M.QP_SALIDA
#ENDIF
      ENDIF
#IF "PROD" $ CURD()
   CASE M.QP_CPO="CODMADRE"
      M.QP_SALIDA=IIF(ELITMA(Q_TEX,Q_REN,Q_COL),TMA.CODMADRE,"")
   CASE M.QP_CPO="MATERIAL"
      M.QP_SALIDA=IIF(ELIMAT(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="PROCFAB" .OR. M.QP_CPO="PRCCOD"
      M.QP_SALIDA=IIF(EMPTY(ELIPRC(Q_TEX,Q_REN,Q_COL)),"",PRC.PRCCOD)
#ENDIF
#IF "NOVO" $ CURD() .OR. "PROD" $ CURD()
   CASE M.QP_CPO="LINEA"
      M.QP_SALIDA=IIF(ELILIN(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   CASE M.QP_CPO="ALIM"
      M.QP_SALIDA=IIF(EMPTY(ELIALI(Q_TEX,Q_REN,Q_COL)),"",LEFT(MI1.TEXTO2,2))
#ENDIF
   ENDCASE
   =SWAP(@ULPR,@M.QP_PROG)
   =SGET(M.QP_WIND)
   POP KEY 
   KEYB CHR(13)
   RETURN M.QP_SALIDA
 
   FUNCTION V_TPR
   M.QP_SALIDA=IIF(ELITPR(Q_TEX,Q_REN,Q_COL),LEFT(MIX.TEXTO2,2),"")
   RETURN
