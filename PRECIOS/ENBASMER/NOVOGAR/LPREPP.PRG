********************************************************************************
*-- Programa: LMERPP.PRG
*-- Fecha   : 06/13/91
*-- Version : G. REINER
*-- Notas   : LISTADO DE MERCADERIAS,SIN DENOMINACION COMERCIAL, POR PANTALLA
*-- Modificaci¢n GOYO 05-29-92 00:56am
********************************************************************************
STORE HORA_ULP(PROGRAM()) TO ULPR
IF CHEQSEG()
	SET ORDER TO TAG MARCOD IN MI1
	SET ORDER TO TAG RUBRO IN RUB
	SELE mer
	SET ORDER TO TAG ARTICULO
	SET RELA TO MARCA INTO MI1
	=win0()
	stor 1 TO VEZ
	stor nul TO casos,PAG
	=cabpan()
	acla=PAIP+padc('ARTICULO',20)+paip+PADC('DETALLE',30)+paip
	IF DIJO1=1 .or. dijo1=6
		acla=PADC('DETALLE',30)+paip+PADC("COSTO",XACDIGI)+PAIP
	ENDIF
	IF DIJO1=1 .OR. DIJO1=2 .OR. DIJO1=6
		ACLA=ACLA+PADC(XALIS1,XACDIGI)+PAIP
	ENDIF
	IF DIJO1=1 .OR. DIJO1=3 .OR. DIJO1=6
		ACLA=ACLA+PADC(XALIS2,XACDIGI)+PAIP
	ENDIF
	IF DIJO1=1 .OR. DIJO1=4 .OR. DIJO1=6
		ACLA=ACLA+PADC(XALIS3,XACDIGI)+PAIP
	ENDIF
	IF DIJO1=1 .OR. DIJO1=5 .OR. DIJO1=6
		ACLA=ACLA+PADC(XALIS4,XACDIGI)+PAIP
	ENDIF
	lns=REPL("=",LEN(acla))
	TT=tt+'-'+TTU
	=TIT_LNS(1)
	stor nul TO RUBR,SUBRUBR
	stor '                                         //' TO XRUBR,XSUBRUBR
	SCAN FOR &fisc
		IF RUBR#MER.RUBRO .OR. SUBRUBR#MER.SUBRUBRO
			IF VEZ=1
				VEZ=2
			ELSE
				!FIN_LNS(1,NUL)
				EXIT
			ENDIF
		ENDIF
		IF RUBR#MER.RUBRO
			=XSEEK(STR(MER.RUBRO),'RUB','CODRUB')
			XRUBR=RUB.RUBRO
			RUBR=MER.RUBRO
		ENDIF
		IF SUBRUBR#MER.SUBRUBRO
			SELE RUB
			SET order to tag todos
			=BUSSRU(MER.RUBRO,MER.SUBRUBRO)
			XSUBRUBR=RUB.RUBRO
			SUBRUBR=MER.SUBRUBRO
		ENDIF
		CLEA
		STOR pag+1 TO pag
		=cabpan()
		_WRAP=.T.
		? tt
		_WRAP=.F.
		DO LMERPP1
		? LNS
		? ACLA
		? LNS
		SELE MER
	ENDIF
	IF ROW()=21
		IF !FIN_LNS(1,NUL)
			EXIT
		ENDIF
		CLEA
		STOR pag+1 TO pag
		=cabpan()
		_WRAP=.T.
		? TT
		_WRAP=.F.
		DO LMERPP1
		? LNS
		? ACLA
		? LNS
	ENDIF
	IF DIJO1=1 .or. dijo1=6
		? MERCA
		?? PAIP
		?? STR(COSTO,XACDIGI,2)
		?? PAIP
	ELSE
		? PAIP
		?? ARTICULO
		?? PAIP
		?? MERCA
		?? PAIP
	ENDIF
	IF DIJO1=1 .OR. DIJO1=2
		?? STR(PORCEN(COSTO,PRECIO1),XACDIGI,2)
		?? PAIP
	ELSE
		IF DIJO1=6
			?? STR(PRECIO1,XACDIGI,2)
			?? PAIP
		ENDIF
	ENDIF
	IF DIJO1=1 .OR. DIJO1=3
		?? STR(PORCEN(COSTO,PRECIO2),XACDIGI,2)
		?? PAIP
	ELSE
		IF DIJO1=6
			?? STR(PRECIO2,XACDIGI,2)
			?? PAIP
		ENDIF
	ENDIF
	IF DIJO1=1 .OR. DIJO1=4
		?? STR(PORCEN(COSTO,PRECIO3),XACDIGI,2)
		?? PAIP
	ELSE
		IF DIJO1=6
			?? STR(PRECIO3,XACDIGI,2)
			?? PAIP
		ENDIF
	ENDIF
	IF DIJO1=1 .OR. DIJO1=5
		?? STR(PORCEN(COSTO,PRECIO4),XACDIGI,2)
		?? PAIP
	ELSE
		IF DIJO1=6
			?? STR(PRECIO4,XACDIGI,2)
			?? PAIP
		ENDIF
	ENDIF
	stor casos+1 TO casos
ENDSCAN
=fin_lns(2,casos)
=RELEWIN("win")
=IAUD(FISC)
ELSE
	=IAUDI()
ENDIF
SET RELA TO
=MEN_LIN(BOTOM)
RETURN
PROCEDURE LMERPP1
	? 'RUBRO   :'+XRUBR
	? "SUBRUBRO:"+XSUBRUBR
RETURN
