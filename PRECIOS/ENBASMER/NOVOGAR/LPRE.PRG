******************************************************************
*-- Programa: LPREP.PRG
*-- Fecha   : 08/26/91 11:18am
*-- Version : G. REINER
*-- Notas   : DERIVA A lista de precios
*-- Modificaci¢n 05-16-92 01:19am GOYO
*-- VERSION NOVOGAR
********************************************************************************
PARAMETER PORPAN,EJECTAR

#DEFINE NUL    0                                 && NUL

CANT_MAX=13
DIME TEXTO[CANT_MAX,3],VARIABLE[CANT_MAX],Habilitado[CANT_MAX],habilant[cant_max]
*
TEXTO[1,1]='ARTICULO'
TEXTO[2,1]='DENOMINACION'
TEXTO[3,1]='MARCA'
TEXTO[4,1]='COSTO'
TEXTO[5,1]='% '+UPPER(XALIS1)
TEXTO[6,1]='% '+UPPER(XALIS2)
TEXTO[7,1]='% '+UPPER(XALIS3)
TEXTO[8,1]='% '+UPPER(XALIS4)
TEXTO[9,1]='Pcio. '+UPPER(XALIS1)
TEXTO[10,1]='Pcio. '+UPPER(XALIS2)
TEXTO[11,1]='Pcio. '+UPPER(XALIS3)
TEXTO[12,1]='Pcio. '+UPPER(XALIS4)
TEXTO[13,1]=''
*
TEXTO[1,2]=LEN(MER.ARTICULO)
TEXTO[2,2]=30
TEXTO[3,2]=IIF(PORPAN,10,20)
TEXTO[4,2]=XACDIGI
TEXTO[5,2]=XACDIGI
TEXTO[6,2]=XACDIGI
TEXTO[7,2]=XACDIGI
TEXTO[8,2]=XACDIGI
TEXTO[9,2]=XACDIGI
TEXTO[10,2]=XACDIGI
TEXTO[11,2]=XACDIGI
TEXTO[12,2]=XACDIGI
TEXTO[13,2]=XACDIGI
*
TEXTO[1,3]='MER.ARTICULO'
TEXTO[2,3]='MER.MERCA'
TEXTO[3,3]=''
TEXTO[4,3]=''
TEXTO[5,3]='MER.PRECIO1'
TEXTO[6,3]='MER.PRECIO2'
TEXTO[7,3]='MER.PRECIO3'
TEXTO[8,3]='MER.PRECIO4'
TEXTO[9,3]='MER.PRECIO1'
TEXTO[10,3]='MER.PRECIO2'
TEXTO[11,3]='MER.PRECIO3'
TEXTO[12,3]='MER.PRECIO4'
TEXTO[13,3]='MER.PRECIO1,MER.PRECIO2,MER.PRECIO3,MER.PRECIO4'
*
STORE "" TO FISC,SOBRECUAL,NOM_LISTA,TTQUE
STORE NUL TO PORCENTAJE
STORE .T. TO HABILITADO
STORE 1 TO FILMER,FILPRE,FILART
=ACOPY(HABILITADO,HABILANT)
DO WHILE QUERYPRE(PORPAN)
   =ACOPY(HABILITADO,HABILANT)
   DO WHILE CFGFAC()
      TT=ALLTRIM('Lista de Precios '+TTQUE)
      M.PORDONDE=XPRN(4)
      DO CASE
      CASE M.PORDONDE=3
      DO XASCII
      =LPREI(EJECTAR)
      CASE M.PORDONDE=4
      DO XANUIM
      =LPREI(EJECTAR)
      CASE M.PORDONDE=7
      STORE .F. TO M.ENASCII
      RELE PORBASE
      STORE .T. TO M.PORBASE
      =LPREI(EJECTAR)
      CASE M.PORPAN .OR. M.PORDONDE=1
      =LPREP()
      CASE !M.PORPAN .OR. M.PORDONDE=2
      =LPREI(EJECTAR)
      ENDCASE
      STORE .F. TO VARIABLE
      ENDDO
   STORE .F. TO VARIABLE
   =ACOPY(HABILANT,HABILITADO)
ENDDO
RETURN
