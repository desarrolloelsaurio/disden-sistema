********************************************************************************
*-- Programa: LAGRI.PRG
*-- Fecha   : 09-07-92 03:03am
*-- Version : G. REINER
*-- Notas   : LISTADO DE CUENTA CORRIENTE DE CLIENTES AGRUPADO
********************************************************************************
ULPR=HORA_ULP(PROGRAM())
IF CHEQSEG()
	#DEFINE BOTOM  "  "+repl("°",78)               && BOTOM
	#DEFINE NUL    0                               && NUL
	#DEFINE PAIP   "|"                             && PAIP
	STORE NUL TO TDEBE,THABER,CDEBE,CHABER
	STORE NUL TO DEBE,HABER,CREDITO,ELCLIENTE,ELCODIGO,LAFACTURA,LAFACT1
	STORE "" TO TTU,ACLA,LINEA,CASOS,LAFECHA
	=LAGR0()
	=CABPRI()
	_PCOPIES=1
	PRINTJOB
	=CABPRI1()
	=LAGRO()
	=LAGRO1()
	=TIT_LIN(3)
	SCAN
		IF _PLINENO>63
			CORTE=PAIP+PADC("SUBTOTAL",20)+PAIP+SPACE(8)+PAIP+STR(CDEBE,XACDIGI,2)+PAIP+STR(CHABER,XACDIGI,2)+PAIP+STR(CDEBE-CHABER,XACDIGI,2)+PAIP
			=FIN_LIN(3,NUL,CORTE)
			=cabpri1()
			=TIT_LIN(4)
		ENDIF
		IF CCL.COMPR#LAFACTURA
			=LAGRO(.T.)
		ENDIF
		IF CCL.CODCLI#ELCODIGO
			=LAGRO1(.T.)
			CORTE=PAIP+PADC("SUBTOTAL",20)+PAIP+SPACE(8)+PAIP+STR(TDEBE,XACDIGI,2)+PAIP+STR(THABER,XACDIGI,2)+PAIP+STR(TDEBE-THABER,XACDIGI,2)+PAIP
			=FIN_LIN(3,NUL,CORTE)
			=CABPRI1()
			=TIT_LIN(3)
		ENDIF
		IF ESDEBE(CCL.COMPRRE)
			DEBE=DEBE+ABS(MONTO)
		ELSE
			HABER=HABER+ABS(MONTO)
		ENDIF
	ENDSCAN
	=LAGRO(.T.)
	CORTE=PAIP+PADC("TOTAL",20)+PAIP+SPACE(8)+PAIP++STR(TDEBE,XACDIGI,2)+PAIP+STR(THABER,XACDIGI,2)+PAIP+STR(TDEBE-THABER,XACDIGI,2)+PAIP
	=FIN_LIN(4,CASOS,CORTE)
	ENDP
	=FINIMP()
	=IAUD(FISC)
	=REOPCCL()
ELSE
	=IAUDI()
ENDIF
RETURN MEN_LIN(BOTOM)
