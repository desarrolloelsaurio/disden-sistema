* MANDA A HISTORICO MOVIMIENTOS 
* DE CLIENTES CON SALDO 0
#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
#DEFINE NUL    0                                 && NUL
PROCEDURE CCLH0
if !pideclav(1)
	return
endif
ULPR=HORA_ULP(PROGRAM())
IF CONFIRMA("Mandar a Histórico Clientes con Saldo 0",.t.,10,5)
    =WORKING()
    =DOTALK()
    =OPPER()
    =OPCCL()
    =OPCCLH()
    SELE CCL
    SET ORDER TO
    TMP=GENTMP()
    TMP1=GENTMP()
    =FLOCK() .OR. FLOK()
    SORT ON CODCLI TO (TMP)
    =PRXAREA(.T.)
    USE (TMP) ALIAS TMP EXCL
    REPL ALL GY_DEBE WITH NUL,GY_HABER WITH NUL
    REPL GY_DEBE WITH MONTO FOR ESDEBE(COMPRRE)
    REPL GY_HABER WITH MONTO FOR EMPTY(GY_DEBE)
    TOTAL ON CODCLI FIELD GY_DEBE,GY_HABER TO (TMP1)
    =PRXAREA(.T.)
    USE (TMP1) ALIAS SUMA EXCL
    DELE FOR GY_DEBE#GY_HABER
    PACK
    SELE SUMA
    INDEX ON CODCLI TAG CODCLI
    SET ORDER TO TAG CODCLI
    SELE CCL
    SET RELA TO CODCLI INTO SUMA
    =FLOCK() .OR. FLOK()
    TMP2=GENTMP()
    COPY TO (TMP2) FOR !EMPTY(SUMA.CODCLI)
    =UNLO_PRX("CCL",TMP2,"CCLPASA")
    SELE CCLPASA
    DELE FOR COMPRRE="SD" .OR. COMPRRE="SA"
    PACK
    SELE CCLH
    APPE FROM DBF("CCLPASA")
    SELE CCL
    =FLOCK() .OR. FLOK()
    DELE FOR !EMPTY(SUMA.CODCLI)
    SET ORDER TO TAG CODCLI IN PER
    SELE SUMA
**    SET RELA TO CODCLI INTO PER    
**    SCAN
**           SELE PER
**           SCAT MEMV MEMO 
**           M.LEGAJO=M.LEGAJO+REPL("-",68)+CHR(13)+CHR(10)+"SALDADO OPERACIONES EN CERO/"+DTOC(DATE())
**	    =AGRABAR1("PER")
**           SELE SUMA
**    ENDSCAN
    =UNTALK()
    =UNWORK()
    =OFF_TMP()
ENDIF
RETURN MEN_LIN(BOTOM)
