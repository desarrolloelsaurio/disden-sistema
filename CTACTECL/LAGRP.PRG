********************************************************************************
*-- Programa: LAGRP.PRG
*-- Fecha   : 09-05-92 02:48pm
*-- Version : GOYO REINER
*-- Notas   : LISTADO DE ESTADO PATRIMONIAL CLIENTES POR PANTALLA
********************************************************************************
IF CHEQSEG()
   STORE NUL TO TDEBE,THABER,CDEBE,CHABER
   STORE NUL TO DEBE,HABER,CREDITO,ELCLIENTE,ELCODIGO,LAFACTURA,LAFACT1
   STORE "" TO TTU,ACLA,LINEA
	=LAGR0()
	=WIN0()
	PAG=1
	=CABPAN()
	STOR NUL TO CASOS
	=TIT_LIN(1)
	SCAN
		IF ROW()>21
			CORTE=PAIP+PADC("SUBTOTAL",15)+PAIP+STR(CDEBE,XACDIGI,2)+PAIP+STR(CHABER,XACDIGI,2)+PAIP+STR(CDEBE-CHABER,XACDIGI,2)+PAIP
			IF !FIN_LIN(1,NUL,CORTE)
				EXIT
			ENDIF
			CLEA
			STOR PAG+1 TO PAG
			=CABPAN()
			=TIT_LIN(2)
		ENDIF
		IF VAL(SUBSTR(CCL.COMPR,7))#LAFACTURA
			=LAGRO(.T.)
		ENDIF
		IF CCL.CODCLI#ELCODIGO
			=LAGRO1(.T.)
			IF !FIN_LIN(1,NUL)
				EXIT
			ENDIF
			CLEA
			STOR pag+1 TO pag
			=cabpan()
			=TIT_LIN(1)
		ENDIF
		=lagr1()
	ENDSCAN
	IF LAST()#27
		=LAGRO(.T.)
		CORTE=PAIP+PADC("TOTAL",15)+PAIP+STR(TDEBE,XACDIGI,2)+PAIP+STR(THABER,XACDIGI,2)+PAIP+STR(TDEBE-THABER,XACDIGI,2)+PAIP
		=FIN_LIN(2,CASOS,CORTE)
	ENDIF
	=RELEWIN("win")
	=REOPCCL()
	=IAUD(FISC)
ELSE
	=iaudI()
ENDIF
RETURN MEN_LIN(BOTOM)
