********************************************************************************
*-- Programa: LPATP.PRG
*-- Fecha   : 09-05-92 02:48pm
*-- Version : GOYO REINER
*-- Notas   : LISTADO DE ESTADO PATRIMONIAL CLIENTES POR PANTALLA
********************************************************************************
IF CHEQSEG()
	STORE NUL TO TDEBE,THABER,TCREDITO
	STORE NUL TO DEBE,HABER,CREDITO,ELCLIENTE,ELCODIGO
	STORE "" TO ACLA,LINEA
	=LPAT0()
	=win0()
	pag=1
	=cabpan()
	stor nul TO casos
	=TIT_LIN(1)
	SCAN
		IF ROW()>21
			CORTE=PAIP+PADC("SUBTOTAL",10)+PAIP+SPACE(30)+PAIP+STR(TDEBE,XACDIGI,2)+PAIP+STR(THABER,XACDIGI,2)+PAIP+STR(TDEBE-THABER,XACDIGI,2)+PAIP+STR(TCREDITO,XACDIGI,2)+PAIP+STR(TCREDITO+TDEBE-THABER,XACDIGI,2)+PAIP
			IF !FIN_LIN(1,NUL,CORTE)
				EXIT
			ENDIF
			CLEA
			STOR pag+1 TO pag
			=cabpan()
			=TIT_LIN(2)
		ENDIF
		=LPAT1()
	ENDSCAN
	IF LAST()#27
		=LPATO(.T.)
		CORTE=PAIP+PADC("TOTAL",10)+PAIP+SPACE(30)+PAIP+STR(TDEBE,XACDIGI,2)+PAIP+STR(THABER,XACDIGI,2)+PAIP+STR(TDEBE-THABER,XACDIGI,2)+PAIP+STR(TCREDITO,XACDIGI,2)+PAIP+STR(TCREDITO+TDEBE-THABER,XACDIGI,2)+PAIP
		=FIN_LIN(2,CASOS,CORTE)
	ENDIF
	=RELEWIN("win")
	=REOPCCL()
ELSE
	=iaudI()
ENDIF
RETURN MEN_LIN(BOTOM)
