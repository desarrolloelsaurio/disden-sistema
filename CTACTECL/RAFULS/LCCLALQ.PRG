#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
#DEFINE PAIP   "|"                               && PAIP
FUNCTION LCCLALQ
PARAMETER PORPAN
EXTERNAL PROCEDURE LCCLALQ0.PRG
	=OPINQ()
	=OPINM()
	=OPCCL()
	=WORKING()
	=DOTALK()
	SELE CCL
	=FLOCK() .OR. FLOK()
	SET ORDER TO TAG CODCLI
	TMP1=GENTMP()
	TMP2=GENTMP()
	TMP3=GENTMP()
	TMP4=GENTMP()
	TOTAL ON CODCLI FOR LEFT(DETALLE,3)="ALQ" .AND. (COMPRRE="FA" .OR. COMPRRE="ND") .AND. !EMPTY(CODINM) TO (TMP1) FIELD MONTO
	TOTAL ON CODCLI FOR LEFT(DETALLE,3)="ALQ" .AND. !(COMPRRE="FA" .OR. COMPRRE="ND") .AND. !EMPTY(CODINM) TO (TMP2) FIELD MONTO
	TOTAL ON CODCLI FOR LEFT(DETALLE,3)#"ALQ" .AND. (COMPRRE="FA" .OR. COMPRRE="ND") .AND. !EMPTY(CODINM) TO (TMP3) FIELD MONTO
	TOTAL ON CODCLI FOR LEFT(DETALLE,3)#"ALQ" .AND. !(COMPRRE="FA" .OR. COMPRRE="ND") .AND. !EMPTY(CODINM) TO (TMP4) FIELD MONTO
	=PRXAREA(.T.)
	USE (TMP1) ALIAS TMP1
	INDEX ON CODCLI TAG CODCLI
	SET ORDER TO TAG CODCLI
	=PRXAREA(.T.)
	USE (TMP2) ALIAS TMP2
	INDEX ON CODCLI TAG CODCLI
	SET ORDER TO TAG CODCLI
	=PRXAREA(.T.)
	USE (TMP3) ALIAS TMP3
	INDEX ON CODCLI TAG CODCLI
	SET ORDER TO TAG CODCLI
	=PRXAREA(.T.)
	USE (TMP4) ALIAS TMP4
	INDEX ON CODCLI TAG CODCLI
	SET ORDER TO TAG CODCLI
	=PRXAREA(.T.)
	CREATE CURSOR TEMPORAL ;
		(CODCLI C(10),;
		CLIENTE C(30),;
		ALQUILERES N(12,2),;
		IMPUESTOS N(12,2),;
		PAGOS N(12,2))
	SELE PER
	SET RELA TO CODCLI INTO TMP1
	SET RELA TO CODCLI INTO TMP2 ADDI
	SET RELA TO CODCLI INTO TMP3 ADDI
	SET RELA TO CODCLI INTO TMP4 ADDI
	SCAN
		M.CODCLI=PER.CODCLI
		M.CLIENTE=PER.CLIENTE
		M.ALQUILERES=TMP1.MONTO
		M.IMPUESTOS=TMP3.MONTO-TMP4.MONTO
		M.PAGOS=TMP2.MONTO
		SELE TEMPORAL
		INSERT INTO TEMPORAL FROM MEMV
		SELE PER
	ENDSCAN
	TT="Cuenta Corriente de Inquilinos"
	ACLA=PAIP+;
		IIF(PORPAN,"",PADC("CODIGO",10)+PAIP)+;
		PADC("INQUILINO",IIF(PORPAN,15,30))+PAIP+;
		PADC("ALQUILERES",XACDIGI)+;
		PAIP+;
		PADC("IMPUESTOS",XACDIGI)+;
		PAIP+;
		PADC("PAGOS",XACDIGI)+;
		PAIP+;
		PADC("SALDO",XACDIGI)+;
		PAIP
		SELE TEMPORAL
		DELE FOR EMPTY(ALQUILERES+IMPUESTOS-PAGOS)
	=UNTALK()
	=UNWORK()
	=LGRL2(PORPAN,"TEMPORAL","LCCLALQ0()","","LCCLALQ",4,RIGHT("999,999,999,999.99",XACDIGI))
	=OFF_TMP()
    =OFF_RELA()
RETURN MEN_LIN(BOTOM)
