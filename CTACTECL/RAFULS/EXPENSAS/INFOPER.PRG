PROCEDURE INFOPER
PARAMETER PORPAN
#DEFINE PAIP   "|"                               && PAIP
EXTERNAL PROCEDURE INFOPER0.PRG

=OPCSS()
=OPCCL()
LA_EPOCA=MESANIO("Mes y A¤o a Listar",.t.,.t.)
IF LAST()#27 .AND. ;
CONFIRMA("Per¡odo de Listado",.t.,15,10)
=WORKING()
=DOTALK()
EL_MES=VAL(LEFT(LA_EPOCA,2))
EL_ANO=VAL(RIGHT(LA_EPOCA,2))
FISC="EXP"+STR(EL_MES,2)+STR(EL_ANO,2)
****
TMP=GENTMP()
SELE CCL
=FLOCK() .OR. FLOK()
SORT ON CODCLI TO (TMP) FOR LEFT(DETALLE,7)=FISC
UNLO IN CCL
=PRXAREA(.T.)
USE (TMP) ALIAS TMP EXCL
REPL ALL EQUIVALE WITH 0
REPL ALL EQUIVALE WITH MONTO FOR COMPRRE="RE"
REPL ALL MONTO WITH 0 FOR COMPRRE="RE"
TMP=GENTMP()
TOTAL ON CODCLI TO (TMP)
=PRXAREA(.T.)
USE (TMP) ALIAS TMP1
REPL ALL DETALLE WITH SAYPER(CODCLI,"CSSCOD")
INDEX ON DETALLE TAG DETALLE
TT="Informe Expensas "+qmes(el_mes)+" " +RIGHT(LA_EPOCA,4)
acla=paip+;
padc("CONSORCISTA",30)+;
PAIP+;
PADC("DEUDA",XACDIGI)+;
PAIP+;
PADC("PAGOS",XACDIGI)+;
PAIP+;
PADC("SALDO",XACDIGI)+PAIP
=UNTALK()
=UNWORK()
=LGRL2(PORPAN,"TMP1","INFOPER0()","FISC","INFOPER",3,RIGHT("999,999,999.99",XACDIGI))
ENDIF
=OFF_TMP()
=RELEWIN("WIN")
RETURN MEN_LIN(BOTOM)