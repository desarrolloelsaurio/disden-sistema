********************************************************************************
*-- Programa: LAGRI.PRG
*-- Fecha   : 09-07-92 03:03am
*-- Version : G. REINER
*-- Notas   : LISTADO DE CUENTA CORRIENTE DE CLIENTES AGRUPADO
********************************************************************************
ulpr=hora_ulp(program())
IF cheqseg()
	STORE NUL TO TDEBE,THABER,CDEBE,CHABER
	STORE NUL TO DEBE,HABER,CREDITO,ELCLIENTE,ELCODIGO,LAFACTURA,LAFACT1
	STORE "" TO ttu,ACLA,LINEA
	=LAGR0()
	STOR NUL TO CASOS
	=CABPRI()
	_PCOPIES=1
	PRINTJOB
	=CABPRI1()
	=TIT_LIN(3)
	? LINEA
	?
	? ELCLIENTE+" ("+ALLTRIM(ELCODIGO)+")"
	=_LIN(.T.)
	SCAN
		IF _PLINENO>66
			CORTE=PAIP+PADC("SUBTOTAL",15)+PAIP+STR(TDEBE,XACDIGI,2)+PAIP+STR(THABER,XACDIGI,2)+PAIP+STR(TDEBE-THABER,XACDIGI,2)+PAIP
			=FIN_LIN(3,NUL,CORTE)
			EJECT PAGE
			=CABPRI1()
			=TIT_LIN(4)
		ENDIF
		IF val(SUBSTR(CCL.COMPR,7))#LAFACTURA
			=LAGRO(.T.)
		ENDIF
		IF CCL.CODCLI#ELCODIGO
			=LAGRO1(.T.)
			?
			? LINEA
			? ELCLIENTE+" ("+ALLTRIM(ELCODIGO)+")"
			=_LIN(.T.)
		ENDIF
		=lagr1()
	ENDSCAN
	=LAGRO(.T.)
	CORTE=PAIP+PADC("TOTAL",15)+PAIP+STR(TDEBE,XACDIGI,2)+PAIP+STR(THABER,XACDIGI,2)+PAIP+STR(TDEBE-THABER,XACDIGI,2)+PAIP
	=FIN_LIN(4,CASOS,CORTE)
	ENDP
	=FINIMP()
	=iaud(FISC)
	=REOPCCL()
ELSE
	=iaudI()
ENDIF
RETURN MEN_LIN(BOTOM)
