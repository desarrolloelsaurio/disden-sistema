***************************************************
*-- Programa: LCCL.PRG
*-- Fecha   : 05-20-92 01:45pm
*-- Version : G. REINER
*-- Notas   : DERIVA A LISTADO DE CTA CTE CLIENTES
***************************************************
PARAMETER PORPAN,SOLOONE,HISTORICO
PRIVATE PORPAN

#DEFINE NUL    0                                 && NUL
#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
#DEFINE FOLL  .F.                                && FOLL
#DEFINE TRUL  .T.                                && TRUL
PRIVATE CANT_MAX,TEXTO,VARIABLE,HABILITADO,HABILANT
CANT_MAX=12
DIME TEXTO[CANT_MAX,2], VARIABLE[CANT_MAX], Habilitado[CANT_MAX],habilant[cant_max]
TEXTO[1,1]=IIF(SSTM1#"ADMIN","CLIENTE",IIF(SSTM2="EXPENSAS","CONSORCISTA","INQUILINO"))
TEXTO[2,1]='FECHA OPERACION'
TEXTO[3,1]='FECHA VENCIMIENTO'
TEXTO[4,1]='DETALLE'
TEXTO[5,1]='COMPROBANTE'
TEXTO[6,1]='NUMERO'
TEXTO[7,1]='ORIGEN'
TEXTO[8,1]='MONTO'
TEXTO[9,1]='MONEDA'
TEXTO[10,1]='EQUIV DOLAR'
TEXTO[11,1]='PAGADA'
TEXTO[12,1]='USUARIO'
TEXTO[1,2]=15
TEXTO[2,2]=8
TEXTO[3,2]=8
TEXTO[4,2]=15
TEXTO[5,2]=2
TEXTO[6,2]=10
TEXTO[7,2]=15
TEXTO[8,2]=XACDIGI
TEXTO[9,2]=2
TEXTO[10,2]=XACDIGI
TEXTO[11,2]=2
TEXTO[12,2]=10
IF !SOLOONE
	STORE '' TO FISC,TTQUE
	STORE TRUL TO HABILITADO
	STORE 1 TO FILCLI,FILFEC,FILCPB,FILDOL,FILMON,FILEMP
	DO WHILE QUERYCCL(PORPAN)
		DO CASE
		CASE FILCLI=4
			IF SSTM2="EXPENSAS"
				STORE NUL TO RESPUESTA
				IF !EMPTY(ELICNS("a Listar",-1,1))
					FISC=QW_FISC(FISC,'CNX.CONCOD="'+CNS.CONCOD+'"')
					=IIF(M.PORPAN,LCCLPR(),LCCLIR())
				ENDIF
			ENDIF
		CASE FILCLI=3 .OR. FILFEC=3 .OR. FILCPB=3
			=IIF(M.PORPAN,IIF(FILCLI=3,LCCLPR1(.T.),LCCLPX()),IIF(FILCLI=3,LCCLPR1(),LCCLIX()))
*			=IIF(M.PORPAN,IIF(FILCLI=3,LCCLPR1(.T.),LCCLPX()),IIF(FILCLI=3,LCCLIR(),LCCLIX()))			
            =OFF_TMP()
		OTHERWISE
			=ACOPY(HABILITADO,HABILANT)
			DO WHILE CFGFAC()
				=IIF(PORPAN,LCCLPZ(),LCCLIZ())
				STORE FOLL TO VARIABLE
			ENDDO
			STORE FOLL TO VARIABLE
			=ACOPY(HABILANT,HABILITADO)
			=KTRUCH()
		ENDCASE
	ENDDO
ELSE
	STORE TRUL TO VARIABLE[2],VARIABLE[4],VARIABLE[8]
	=IIF(PORPAN,LCCLPZ(),LCCLIZ())
ENDIF
RETURN MEN_LIN(BOTOM)
