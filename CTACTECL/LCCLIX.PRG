********************************************************************************
*-- Programa: LCCLIX.PRG
*-- Fecha   : 05-25-92 11:54pm
*-- Version : G. REINER
*-- Notas   : LISTADO DE CUENTA CORRIENTE / RESUMEN POR FECHA
********************************************************************************
STORE HORA_ULP(PROGRAM()) TO ULPR
IF CHEQSEG()
	=working()
	NADA=GENTMP()
	SET ORDER TO CODCLI IN PER
	SELE CCL
	SET RELA TO CODCLI INTO PER
	DO CASE
	CASE ".T."=FISC
		INDE ON DTOS(FECHAOP) TO (NADA) COMP
	OTHERWISE
		INDE ON DTOS(FECHAOP) TO (NADA) FOR EVAL(FISC) COMP
	ENDCASE
	IF FILFEC=3
		ACLA=PAIP+PADC("FECHA",8)+PAIP+PADC("DEBE",13)+PAIP+PADC("HABER",13)+PAIP+PADC("SALDO",13)+PAIP
	ENDIF
	LNS=REPL("=",LEN(ACLA))
	TT='Listado de Saldos'+ttque
	=UNWORK()
	STOR NUL TO CASOS
	=CABPRI()
	_PCOPIES=1
	PRINTJOB
	=CABPRI1()
	=TIT_LNS(3)
	SELE CCL
	STORE NUL TO GDEBE,GHABER,DEBE,HABER
	PICU='99,999,999.99'
	GO TOP
	IF FILFEC=3
		ELTEXTO=CCL.FECHAOP
		ELCORTE=CCL.FECHAOP
	ENDIF
	SCAN
		IF ELCORTE#CCL.FECHAOP
			=FLCCLIX1()
		ENDIF
		IF _PLINENO>63
			=TLCCLiX1("SUBTOTAL")
			EJECT PAGE
			=CABPRI1()
			=TIT_LNS(4)
		ENDI
		IF COMPR='NC' .OR. COMPR='RE'
			HABER=HABER+MONTO
		ELSE
			DEBE=DEBE+MONTO
		ENDIF
	ENDSCAN
	=FLCCLIX1()
	=TLCCLIX1("TOTAL")
	ENDP
	=FINIMP()
	=IAUD(FISC)
	=REOPCCL()
ELSE
	=IAUDI()
ENDIF
RETURN MEN_LIN(BOTOM)

FUNCTION TLCCLIX1
	PARAMETER COSA
	PRIVATE COSA
	? LNS
	? PAIP
	?? PADR(COSA,IIF(FILFEC=3,8,30))
	?? PAIP
	?? GDEBE PICT PICU
	?? PAIP
	?? GHABER PICT PICU
	?? PAIP
	?? GDEBE-GHABER PICT PICU
	?? PAIP
RETURN .T.

FUNCTION FLCCLIX1
	? PAIP
	?? ELTEXTO
	?? PAIP
	?? DEBE PICT PICU
	GDEBE=GDEBE+DEBE
	?? PAIP
	?? HABER PICT PICU
	GHABER=GHABER+HABER
	?? PAIP
	?? DEBE-HABER PICT PICU
	?? PAIP
	STORE NUL TO DEBE,HABER
	ELTEXTO=CCL.FECHAOP
	ELCORTE=CCL.FECHAOP
RETURN .T.
