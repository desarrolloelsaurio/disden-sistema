#DEFINE NUL    0                                 && NUL
function imputaut
STORE NUL TO M.ELPAGO,M.LACOMPRA
SCAN WHILE CCL.CODCLI=PER.CODCLI
	IF CCL.COMPRRE="NC" .OR. ;
		CCL.COMPRRE="RE" .OR. ;
		CCL.COMPRRE="SA" 
		M.ELPAGO=M.ELPAGO+CCL.MONTO
	ELSE
		=LOCK("CCL") .OR. LOK("CCL")
		M.LACOMPRA=M.LACOMPRA+CCL.MONTO
		REPL CCL.PAGADA WITH .F.
		REPL CCL.CUOTA WITH 0
		UNLO IN CCL
	ENDIF
ENDSCAN
IF M.ELPAGO>=M.LACOMPRA
   WAIT "CLIENTE:"+ALLTRIM(PER.CLIENTE)+" SIN DEUDA EN Cta. Cte." WIND NOWA
   =FLOCK("CCL") .OR. FLOK("CCL")
   REPL PAGADA WITH .T. ,;
	   CUOTA WITH MONTO ;
	   FOR CODCLI=PER.CODCLI
	   UNLO IN CCL
ELSE
	=SEEK(PER.CODCLI)
   WAIT "REIMPUTANDO PAGOS CLIENTE:"+ALLTRIM(PER.CLIENTE) WIND NOWA
	SCAN WHILE CCL.CODCLI=PER.CODCLI
		IF CCL.COMPRRE="FA" .OR. ;
			CCL.COMPRRE="ND" .OR. ;
			CCL.COMPRRE="SD" 
			IF M.ELPAGO>=CCL.MONTO
			   =FLOCK("CCL") .OR. FLOK("CCL")
			   REPL PAGADA WITH .T.
			   REPL CUOTA WITH MONTO
			   M.ELPAGO=M.ELPAGO-CCL.MONTO 
			   UNLO IN CCL
			ELSE
			   =FLOCK("CCL") .OR. FLOK("CCL")
			   REPL PAGADA WITH .F.
			   REPL CUOTA WITH M.ELPAGO
			   UNLO IN CCL
			   EXIT
			ENDIF
		ENDIF
	ENDSCAN
	UNLO ALL
ENDIF
