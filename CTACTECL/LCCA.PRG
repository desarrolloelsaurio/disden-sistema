*********************************************************************************
*-- Programa: LCCA.PRG
*-- Fecha   : 05-20-92 01:45pm
*-- Version : G. REINER
*-- Notas   : DERIVA A LISTADO DE CTA CTE CLIENTES
********************************************************************************
parameter porpan
private porpan
CANT_MAX=7
DIME TEXTO[CANT_MAX,2], VARIABLE[CANT_MAX], Habilitado[CANT_MAX],habilant[cant_max]
TEXTO[1,1]='CLIENTE'
TEXTO[2,1]='FECHA OPERACION'
TEXTO[3,1]='DETALLE'
TEXTO[4,1]='COMPROBANTE'
TEXTO[5,1]='NUMERO'
TEXTO[6,1]='ORIGEN'
TEXTO[7,1]='MONTO'
TEXTO[1,2]=30
TEXTO[2,2]=8
TEXTO[3,2]=15
TEXTO[4,2]=2
TEXTO[5,2]=10
TEXTO[6,2]=15
TEXTO[7,2]=XACDIGI
STORE '' TO FISC,TTQUE
STORE .T. TO HABILITADO
STORE 1 TO FILCLI,FILFEC,FILCPB,FILDOL,FILMON,FILEMP
DO WHILE QUERYCCL(PORPAN)
	=MEN_LIN("ESPERE POR FAVOR")
	TMP=GENTMP()
	SELE 25
	SELECT CCL.CODCLI,CCL.FECHAOP,CCL.DETALLE,;
		CCL.COMPR,CCL.COMPRRE+' N§ '+STR(CCL.NUMERORE) AS COMPRRE,;
		SUM(CCL.MONTO) AS MONTO;
		FROM CCL;
		INTO TABLE (tmp);
		GROUP BY 5
	USE
	SELE 11
	USE (TMP)
	IF FILCLI=3 .OR. FILFEC=3 .OR. FILCPB=3
		=IIF(M.PORPAN,IIF(FILCLI=3,LCCLPR(),LCCLPX()),IIF(FILCLI=3,LCCLIR(),LCCLIX()))
	ELSE
		=ACOPY(HABILITADO,HABILANT)
		DO WHILE CFGFAC()
			=IIF(PORPAN,LCCLPZ(),LCCLIZ())
			STORE .F. TO VARIABLE
		ENDDO
		STORE .F. TO VARIABLE
		=ACOPY(HABILANT,HABIITADO)
	ENDIF
ENDDO
RETURN
