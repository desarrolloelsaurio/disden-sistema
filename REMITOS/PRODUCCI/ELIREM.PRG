*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/29/96             ELIREM.PRG                09:14:56 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("fic",	INT((SROW()-5)/2), INT((SCOL()-50)/2), INT((SROW()-5)/2)+4, INT((SCOL()-50)/2)+49, ;
 " BUSQUEDA DE REMITOS "		,' '+JANNAME+' ')		


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 ELIREM/MS-DOS Setup Code - SECTION 2           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=OPREM()
STORE "" TO M.REMI
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      ELIREM/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("fic")
	ACTIVATE WINDOW fic SAME
ELSE
	ACTIVATE WINDOW fic NOSHOW
ENDIF
@ 1,3 SAY "N de Remito :" ;
	SIZE 1,14, 0
@ 1,22 GET m.remi ;
	SIZE 1,17 ;
	DEFAULT " " ;
	PICTURE REPL('!',15) ;
	VALID _rcj0jto0w() ;
	MESSAGE "Ingrese N de Remito a Procesar"

IF NOT WVISIBLE("fic")
	ACTIVATE WINDOW fic
ENDIF

READ

=RELEWIN("fic")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      ELIREM/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
SELE REM
SET ORDER TO TAG REMITO
SET MESS TO LEFT(BOTOM,78)
RETURN LAST()#27 .AND. ;
RIGHT(M.REMI,8)#"00000000" .AND. ;
SEEK(M.REMI) .AND. ;
!DELE()

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JTO0W           m.remi VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIREM,     Record Number:    3    
*        Variable:            m.remi                             
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jto0w     &&  m.remi VALID
#REGION 1
M.NETO=ALLTRIM(M.REMI)
M.ULTI=RIGHT(M.NETO,1)
SUCUC=SUCU
DO CASE
CASE UPPER(LEFT(M.NETO,1))="D"
   M.REMI=ALLTRIM(Q_FAC("D1-"+SUBSTR(M.REMI,2)))
   M.REMI=IIF(ISDIGIT(M.ULTI),M.REMI,M.REMI+M.ULTI)
CASE UPPER(LEFT(M.NETO,1))="R"
   M.REMI=ALLTRIM(Q_FAC("R1-"+SUBSTR(M.REMI,2)))
   M.REMI=IIF(ISDIGIT(M.ULTI),M.REMI,M.REMI+M.ULTI)
CASE UPPER(LEFT(M.NETO,1))="M"
      M.REMI=ALLTRIM(Q_FAC("M0-"+SUBSTR(M.REMI,2)))
      M.REMI=IIF(ISDIGIT(M.ULTI),M.REMI,M.REMI+M.ULTI)
CASE !ISDIGIT(M.ULTI)
         DO CASE
         CASE LEFT(M.NETO,2)="0-"
            FIN=AT(M.ULTI,M.NETO)
            LARGO=FIN-3
            M.REMI=" 0000-"+ZERO(VAL(SUBSTR(M.NETO,3,LARGO)),8)+M.ULTI
         CASE LEFT(M.NETO,3)="X31"
            FIN=AT(M.ULTI,M.NETO)
            LARGO=FIN-4
            M.REMI="X0031-"+ZERO(VAL(SUBSTR(M.NETO,4,LARGO)),8)+M.ULTI
         OTHERWISE
            m.remi=q_fac(alltrim(SUCUC+"-"+SINULT(ALLTRIM(m.remi))))+M.ULTI
         ENDCASE
OTHERWISE
         m.remi=q_fac(alltrim(m.remi))
ENDCASE
SHOW GETS
return .t.
