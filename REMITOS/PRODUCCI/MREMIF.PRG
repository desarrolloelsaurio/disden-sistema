*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 12/13/95             MREMIF.PRG                14:52:50 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 1995 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ

PARAMETERS numerem

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є          MREMIF/MS-DOS Setup Code - SECTION 1           є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
#DEFINE NUL    0                                 && NUL
#DEFINE PAIP   "|"                               && PAIP
PUSH KEY CLEA
if used('PER')
	m.ordperant=ORDE('PER')
endif
=OPCOR()
=OPMER()
=OPREQ()
=OPTALS()
=OPAVIS()
=OPTELS()
=OPCOMS()
=OPOTRS()
IF CHEQSEG()
	IF XSEEK(NUMEREM,"REM","REMITO")
		IF EMPTY(REM.NUMOT)
			M.TIPOREM=2
			M.CARTREM="DEVOLUCION A PROVEEDOR"
			=XSEEK(REM.NUMREQ,"REQ","NUMERO")
		ELSE
			M.TIPOREM=1
			M.CARTREM="ENVIO A TALLER"
			=XSEEK(REM.NUMOT,"COR","NUMERO")
			=XSEEK(COR.ARTICULO,"MER","ARTICULO"), .T.)
		ENDIF
		SELE REX
		ARCHIVO=GENTMP()
		IF SEEK(REM.REMITO)
			=FLOCK() .AND. FLOK()
			COPY TO (ARCHIVO) WHILE REMITO=REM.REMITO
			UNLO IN REX
		ENDIF
		SELE 0
		USE (ARCHIVO) ALIAS TMPREM
		GO TOP
		DO CASE
		CASE !EMPTY(TMPREM.AVICODPRO)
			INDE ON AVICODPRO TAG AVICODPRO
			M.TIPOMERCA=1
		CASE !EMPTY(TMPREM.TELCODPRO)
			INDE ON TELCODPRO TAG TELCODPRO
			M.TIPOMERCA=2
		CASE !EMPTY(TMPREM.COMCODPRO)
			INDE ON COMCODPRO TAG COMCODPRO
			M.TIPOMERCA=3
		CASE !EMPTY(TMPREM.OTRCODPRO)
			INDE ON OTRCODPRO TAG OTRCODPRO
			M.TIPOMERCA=4
		ENDCASE
		SHOW GETS
	ELSE
		WAIT "ERROR EN REMITO"+NUMEREM WIND
	ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

IF NOT WEXIST("_r640vw7l0")
	DEFINE WINDOW _r640vw7l0 ;
		FROM INT((SROW()-22)/2),INT((SCOL()-77)/2) ;
		TO INT((SROW()-22)/2)+21,INT((SCOL()-77)/2)+76 ;
		TITLE ' REMITO Nш '+NUMEREM+' ' ;
		FOOTER ' '+janname+' ' ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		COLOR SCHEME 1
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є               MREMIF/MS-DOS Screen Layout               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("_r640vw7l0")
	ACTIVATE WINDOW _r640vw7l0 SAME
ELSE
	ACTIVATE WINDOW _r640vw7l0 NOSHOW
ENDIF
@ 2,5 SAY "FECHA" ;
	SIZE 1,5, 0
@ 4,5 SAY "TALLER" ;
	SIZE 1,6, 0
@ 3,5 SAY "ARTICULO" ;
	SIZE 1,8, 0
@ 1,5 SAY "REMITO" ;
	SIZE 1,6, 0
@ 7,7 SAY "CODIGO" ;
	SIZE 1,6, 0
@ 7,54 SAY "CANTIDAD" ;
	SIZE 1,8, 0
@ 7,66 SAY "UNIDAD" ;
	SIZE 1,6, 0
@ 6,0 TO 16,21
@ 6,21 TO 16,52
@ 8,0 TO 8,74
@ 6,52 TO 16,63
@ 6,63 TO 16,74
@ 6,63 SAY CHR(194) ;
	SIZE 1,1, 0
@ 16,63 SAY CHR(193) ;
	SIZE 1,1, 0
@ 8,63 SAY CHR(197) ;
	SIZE 1,1, 0
@ 8,74 SAY CHR(180) ;
	SIZE 1,1, 0
@ 8,52 SAY CHR(197) ;
	SIZE 1,1, 0
@ 6,52 SAY CHR(194) ;
	SIZE 1,1, 0
@ 16,52 SAY CHR(193) ;
	SIZE 1,1, 0
@ 8,21 SAY CHR(197) ;
	SIZE 1,1, 0
@ 8,0 SAY CHR(195) ;
	SIZE 1,1, 0
@ 6,21 SAY CHR(194) ;
	SIZE 1,1, 0
@ 16,21 SAY CHR(193) ;
	SIZE 1,1, 0
@ 1,35 SAY "р" ;
	SIZE 1,1, 0
@ 1,62 SAY "р" ;
	SIZE 1,1, 0
@ 1,16 SAY rem.remito ;
	SIZE 1,15
@ 1,38 SAY m.cartrem ;
	SIZE 1,23 ;
	PICTURE "@I"
@ 2,16 SAY rem.fecha ;
	SIZE 1,8
@ 2,34 SAY IIF(m.tiporem=1,"ORDEN DE CORTE N§","ORDEN DE REQ. N§") ;
	SIZE 1,19
@ 2,54 SAY IIF(M.TIPOREM=1,cor.numero,rem.numreq) ;
	SIZE 1,10
@ 3,16 SAY MER.articulo ;
	SIZE 1,15
@ 3,34 SAY mer.merca ;
	SIZE 1,30
@ 4,16 SAY per.codcli ;
	SIZE 1,10
@ 4,34 SAY SAYPER(REM.TALLER, 'PROCOD') ;
	SIZE 1,30
@ 7,27 SAY IIF(M.TIPOMERCA=1,"AVЎO",IIF(M.TIPOMERCA=2,"TELA",IIF(M.TIPOMERCA=3,"COMPRA","OTRO PROD."))) ;
	SIZE 1,20 ;
	PICTURE "@I"
@ 18,43 GET m.ok ;
	PICTURE "@*HN \<Mas" ;
	SIZE 1,12,1 ;
	DEFAULT 1 ;
	WHEN _r640vwa09() ;
	VALID _r640vwa4b()

IF NOT WVISIBLE("_r640vw7l0")
	ACTIVATE WINDOW _r640vw7l0
ENDIF

READ CYCLE ;
	SHOW _r640vwa9z()

RELEASE WINDOW _r640vw7l0

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є               MREMIF/MS-DOS Cleanup Code                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
ELSE
	=IAUDI()
ENDIF
POP KEY
set orde to tag (m.ordperant) in per
RETURN OFF_TMP(Q_AREA('TMPREM')) .AND. MEN_LIN(BOTOM)



*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є   MREMIF/MS-DOS Supporting Procedures and Functions     є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
FUNCTION PAGINATE
#DEFINE C1 1
#DEFINE C2 22
#DEFINE C3 53
#DEFINE C4 64

M.DESDE = 9
SELE TMPREM
SCAN WHILE !EOF() .AND. M.DESDE<16
DO CASE
	CASE TIPOMERCA=1
		=XSEEK(TMPREM.AVICODPRO,'AVIS','AVICODPRO')
		@ DESDE, C1 SAY TMPREM.AVICODPRO
		@ DESDE, C2 SAY LEFT(AVIS.AVIO,30)
		@ DESDE, C3 SAY STR(TMPREM.CANTIDAD,10,2)
		@ DESDE, C4 SAY SAYMIX(AVIS.UNIDAD,"MDDCOD",10)
	CASE TIPOMERCA=2
		=XSEEK(TMPREM.TELCODPRO,'TELS','TELCODPRO')
		@ DESDE, C1 SAY TMPREM.TELCODPRO
		@ DESDE, C2 SAY LEFT(TELS.TELA,30)
		@ DESDE, C3 SAY STR(TMPREM.CANTIDAD,10,2)
		@ DESDE, C4 SAY SAYMIX(TELS.UNIDAD,"MDDCOD",10)
	CASE TIPOMERCA=3
		=XSEEK(TMPREM.COMCODPRO,'COMS','COMCODPRO')
		@ DESDE, C1 SAY TMPREM.COMCODPRO
		@ DESDE, C2 SAY LEFT(COMS.COMPRA,30)
		@ DESDE, C3 SAY STR(TMPREM.CANTIDAD,10,2)
		@ DESDE, C4 SAY SAYMIX(COMS.UNIDAD,"MDDCOD",10)
	CASE TIPOMERCA=4
		=XSEEK(TMPREM.OTRCODPRO,'OTRS','OTRCODPRO')
		@ DESDE, C1 SAY TMPREM.OTRCODPRO
		@ DESDE, C2 SAY LEFT(OTRS.OTRO,30)
		@ DESDE, C3 SAY STR(TMPREM.CANTIDAD,10,2)
		@ DESDE, C4 SAY SAYMIX(OTRS.UNIDAD,"MDDCOD",10)
	ENDCASE
	M.DESDE=M.DESDE+1
ENDSCAN
DO WHILE M.DESDE<16
	@ DESDE, C1 SAY SPACE(10)
	@ DESDE, C2 SAY SPACE(30)
	@ DESDE, C3 SAY SPACE(10)
	@ DESDE, C4 SAY SPACE(10)
	M.DESDE=M.DESDE+1
ENDDO
RETURN EOF('TMPREM')

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _R640VWA09           m.ok WHEN                          є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         MREMIF,     Record Number:   37    є
*       є Variable:            m.ok                               є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _r640vwa09     &&  m.ok WHEN
#REGION 1
=PAGINATE()
RETURN .T.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _R640VWA4B           m.ok VALID                         є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         MREMIF,     Record Number:   37    є
*       є Variable:            m.ok                               є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _r640vwa4b     &&  m.ok VALID
#REGION 1
IF LAST()=27 .OR. EOF('TMPREM')
	=OFF_TMP(Q_AREA('TMPREM'))
	CLEAR READ
ENDIF
RETURN .T.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _R640VWA9Z           Read Level Show                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         MREMIF                             є
*       є Called By:           READ Statement                     є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _r640vwa9z     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: MREMIF
*
#REGION 1
IF SYS(2016) = "_R640VW7L0" OR SYS(2016) = "*"
	ACTIVATE WINDOW _r640vw7l0 SAME
	@ 1,16 SAY rem.remito ;
		SIZE 1,15, 0
	@ 1,38 SAY m.cartrem ;
		SIZE 1,23, 0 ;
		PICTURE "@I"
	@ 2,16 SAY rem.fecha ;
		SIZE 1,8, 0
	@ 2,34 SAY IIF(m.tiporem=1,"ORDEN DE CORTE N§","ORDEN DE REQ. N§") ;
		SIZE 1,19, 0
	@ 2,54 SAY IIF(M.TIPOREM=1,cor.numero,rem.numreq) ;
		SIZE 1,10, 0
	@ 3,16 SAY MER.articulo ;
		SIZE 1,15, 0
	@ 3,34 SAY mer.merca ;
		SIZE 1,30, 0
	@ 4,16 SAY per.codcli ;
		SIZE 1,10, 0
	@ 4,34 SAY SAYPER(REM.TALLER, 'PROCOD') ;
		SIZE 1,30, 0
	@ 7,27 SAY IIF(M.TIPOMERCA=1,"AVЎO",IIF(M.TIPOMERCA=2,"TELA",IIF(M.TIPOMERCA=3,"COMPRA","OTRO PROD."))) ;
		SIZE 1,20, 0 ;
		PICTURE "@I"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF