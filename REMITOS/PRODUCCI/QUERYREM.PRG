*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/29/96            QUERYREM.PRG               09:14:59 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS porpan

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                QUERYREM/MS-DOS Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
STORE "" TO TTREM,TTFEC,TTTAL,TTCOR
STORE 1  TO FILREM,FILFEC,FILTAL,FILCOR
STORE "" TO QUEREM,QUEFEC,QUETAL,QUECOR
STORE SPACE(20) TO SHREM,SHFEC,SHTAL,SHCOR
store 1 to minobj
store 3 to maxobj
store .f. to fin,HUBORES

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("queryrem") ;
	OR UPPER(WTITLE("QUERYREM")) == "QUERYREM.PJX" ;
	OR UPPER(WTITLE("QUERYREM")) == "QUERYREM.SCX" ;
	OR UPPER(WTITLE("QUERYREM")) == "QUERYREM.MNX" ;
	OR UPPER(WTITLE("QUERYREM")) == "QUERYREM.PRG" ;
	OR UPPER(WTITLE("QUERYREM")) == "QUERYREM.FRX" ;
	OR UPPER(WTITLE("QUERYREM")) == "QUERYREM.QPR"
	=MOVEWIX("queryrem",	INT((SROW()-13)/2), INT((SCOL()-80)/2), INT((SROW()-13)/2)+12, INT((SCOL()-80)/2)+79, ;
	 " L죑ites del Listado de Remitos "		,' '+janname+' ')		
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     QUERYREM/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("queryrem")
	ACTIVATE WINDOW queryrem SAME
ELSE
	ACTIVATE WINDOW queryrem NOSHOW
ENDIF
@ 1,2 GET m.filrem ;
	PICTURE "@*RVN \<Todos los Remitos;\<Un Remito;\<Opciones" ;
	SIZE 1,21,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID _rcj0jtqmo()
@ 1,27 GET m.filfec ;
	PICTURE "@*RVN \<Todas las Fechas;\<Entre Fechas;\<Resumen por Fecha" ;
	SIZE 1,21,0 ;
	DEFAULT 1 ;
	WHEN M.FILREM=3 .AND. betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ()
@ 1,52 GET m.filtal ;
	PICTURE "@*RVN \<Todos los Talleres;\<Opciones;\<Resumen por Taller" ;
	SIZE 1,22,0 ;
	DEFAULT 1 ;
	WHEN M.FILREM=3 .AND. betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ()
@ 6,27 GET m.filcor ;
	PICTURE "@*RVN \<Todas las O. Corte;\<Una O. Corte;\<Resumen por O. Corte" ;
	SIZE 1,24,0 ;
	DEFAULT 1 ;
	WHEN M.FILREM=3 .AND. betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ(.T.)

IF NOT WVISIBLE("queryrem")
	ACTIVATE WINDOW queryrem
ENDIF

READ CYCLE


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     QUERYREM/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF LAST()#27
   FISC=".T."
   IF FILREM=1
      TTQUE=CHR(13)+CHR(10)+"Todos los Remitos"
   ELSE
      STORE DATE() TO FECINI,FECFIN
      STORE FILFEC TO FECANT
      STORE IIF(FILFEC#1,2,1) TO FILFEC
      =qw_fec(4,27,'rem.fechaop')
      STORE FECANT TO FILFEC
      =qw_talS(4,52,'rem.taller')
      STORE NUL TO M.NUINI,NUFIN
      =qw_cor(9,27,'rem.numot')
      ***** FISC
      FISC=qw_fisc(FISC,quefec)
      FISC=qw_FISC(FISC,quetal)
      FISC=qw_FISC(FISC,quecor)
      FISC=IIF(EMPTY(FISC),'.T.',FISC)
      ***** TITULOS
      store "Resumen por " to ressu
      TTQUE=QW_TT(TTfec)+QW_TT(TTtal)+QW_TT(TTcor)
   ENDIF
   **** AL FIN LISTADOS
   RELE WIND QUERYREM
   IF FILFEC=3
      =WORKING()
      TT=ttque
      sele rem
      SELE REM
      SET ORDER TO TAG REMITO
      set order to tag TALCOD in PER
      set relation to REM.TALLER INTO PER
      IF ".T."=FISC
         INDE ON fechaop TO (SYS(3)+".TMP") COMP
      ELSE
         INDE ON fechaop TO (SYS(3)+".TMP") FOR EVAL(FISC) COMP
      ENDIF
      IF PORPAN
         =REPORTE("lremPrf")
      ELSE
         repo form lremIrf TO PRIN NOCONSOLE PDSETUP
      ENDIF
   ELSE
      IF FILTAL=3
         =WORKING()
         TT=ttque
         sele rem
         SELE REM
         SET ORDER TO TAG REMITO
         set order to tag TALCOD in PER
         set relation to REM.TALLER INTO PER
         IF TYPE("ordtal")#'L' .OR. ordtal
            IF ".T."=FISC
               INDE ON TALLER TO (SYS(3)+".TMP") COMP
            ELSE
               INDE ON TALLER TO (SYS(3)+".TMP") FOR EVAL(FISC) COMP
            ENDIF
         ELSE
            IF ".T."=FISC
               INDE ON PER.CLIENTE TO (SYS(3)+".TMP") COMP
            ELSE
               INDE ON PER.CLIENTE TO (SYS(3)+".TMP") FOR EVAL(FISC) COMP
            ENDIF
         ENDIF
         IF PORPAN
            =REPORTE("lremPrT")
         ELSE
            repo form lremirT TO PRIN NOCONSOLE PDSETUP
         ENDIF
      ELSE
         IF FILCOR=3
            =WORKING()
            TT=ttque
            sele rem
            SELE REM
            SET ORDER TO TAG REMITO
            set order to tag TALCOD in PER
            set relation to REM.TALLER INTO PER
               IF ".T."=FISC
                  SET ORDER TO TAG NUMOT
               ELSE
                  INDE ON NUMOT TO (SYS(3)+".TMP") FOR EVAL(FISC) COMP
               ENDIF
            IF PORPAN
            =REPORTE("lremPrO")
            ELSE
               repo form lremirO TO PRIN NOCONSOLE PDSETUP
            ENDIF
         ELSE
            IF PORPAN
               DO LREMPZ
            ELSE
               DO LREMIZ
            ENDIF
         ENDIF
      ENDIF
   ENDIF
   =KTRUCH()
   =REOPREM()
ELSE
   RELE WIND QUERYREM
ENDIF
RETURN LAST()#27


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JTQMO           m.filrem VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QUERYREM,     Record Number:    2  
*        Variable:            m.filrem                           
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jtqmo     &&  m.filrem VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   if _curobj=2
      IF ELIREM()
         ELREMITO=REM.REMITO
         SELE REX
         SET ORDER TO TAG REMITO
         SEEK REM.REMITO
         =iif(porpan,mrem(),lremif())
      ENDIF
   else
      MINOBJ=CEIL(_CUROBJ/3)*3+1
      MAXOBJ=MINOBJ+2
      _CUROBJ=MINOBJ
   endif
ENDIF
RETURN .T.