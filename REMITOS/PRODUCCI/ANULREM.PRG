#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
FUNCTION ANULREM
PARAMETER NUM_REMITO
ULPR=HORA_ULP(PROGRAM())
IF ESJEFE()
   IF REM.TALANT="NOAUTOR   "
	      =CARTEL("EL REMITO "+NUMEREM+" DEBE SER ANULADO DESDE LA OPCION",;
	      "DE REMITOS A PROVEEDORES POR LA SECCION COMPRAS",;
	      "REINTENTE DESDE ESA OPCION DEL PROGRAMA",;
	      ENTERCON)
          RETURN MEN_LIN(BOTOM)      
   ENDIF
   IF CONFIRMA("BORRAR REMITO "+NUM_REMITO,.T.,10,0)
   =WORKING()
   =DOTALK()
   SELE REX
   SET ORDER TO TAG REMITO
   IF SEEK(NUM_REMITO)
      SCAN WHILE REX.REMITO=NUM_REMITO
         IF EMPTY(TELCODPRO)
            IF XSEEK(REX.AVICODPRO,"AVIS","AVICODPRO")
               REPL AVIS.STOCK WITH AVIS.STOCK+REX.CANTIDAD
            ENDIF
         ELSE
            IF XSEEK(REX.TELCODPRO,"TELS","TELCODPRO")
               REPL TELS.STOCK WITH TELS.STOCK+REX.CANTIDAD
            ENDIF
         ENDIF
         SELE REX
         DELE         
      ENDSCAN
      SELE REM
      SET ORDER TO TAG REMITO
      if seek(NUM_REMITO)
         DELE
      endif
      =OPKARS()
      elnumero=SUBSTR(NUMREMITO,AT("-",NUM_REMITO)+1)
      set order to tag numero
      if seek(elnumero)
      SCAN WHILE KARS.NUMERO=M.ELNUMERO
         IF COMPR="RF"
            DELE 
         ENDIF
      ENDSCAN
      endif
      =IAUD(NUM_REMITO)
      =WNCL("REMITO "+NUM_REMITO+" BORRADO")
   ELSE
      =WNCL("REMITO NO ENCONTRADO")
   ENDIF
   ELSE
   =WNCL("BORRADO ANULADO")
   ENDIF
ELSE
   =IAUDI()
ENDIF
=UNTALK()
=UNWORK()
RETURN MEN_LIN(BOTOM)
