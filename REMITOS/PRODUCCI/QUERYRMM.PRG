*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        07/29/96            QUERYRMM.PRG               09:15:11 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS porpan

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                QUERYRMM/MS-DOS Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
	
STORE "" TO TTREM,TTFEC,TTTAL,TTCOR
STORE 1  TO FILREM,FILFEC,FILTAL,FILCOR
STORE "" TO QUEREM,QUEFEC,QUETAL,QUECOR
STORE SPACE(20) TO SHREM,SHFEC,SHTAL,SHCOR
store 1 to minobj
store 3 to maxobj
STORE .F. TO M.HUBORES

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("queryrem",	INT((SROW()-13)/2), INT((SCOL()-77)/2), INT((SROW()-13)/2)+12, INT((SCOL()-77)/2)+76, ;
 " L죑ites del Listado "		,' '+JANNAME+' ')		


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     QUERYRMM/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("queryrem")
	ACTIVATE WINDOW queryrem SAME
ELSE
	ACTIVATE WINDOW queryrem NOSHOW
ENDIF
@ 1,2 GET m.filrem ;
	PICTURE "@*RVN \<Todos los Remitos;\<Un Remito;\<Opciones" ;
	SIZE 1,21,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID _rcj0jtzqe()
@ 1,27 GET m.filfec ;
	PICTURE "@*RVN \<Todas las Fechas;\<Entre Fechas;\<Resumen por Fecha" ;
	SIZE 1,21,0 ;
	DEFAULT 1 ;
	WHEN M.FILREM=3 .AND. betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ()
@ 1,52 GET m.filtal ;
	PICTURE "@*RVN \<Todos los Talleres;\<Opciones;\<Resumen por Taller" ;
	SIZE 1,22,0 ;
	DEFAULT 1 ;
	WHEN M.FILREM=3 .AND. betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ()
@ 6,27 GET m.filcor ;
	PICTURE "@*RVN \<Todas las O. Corte;\<Una O. Corte;\<Resumen por O. Corte" ;
	SIZE 1,24,0 ;
	DEFAULT 1 ;
	WHEN M.FILREM=3 .AND. betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ(.T.)

IF NOT WVISIBLE("queryrem")
	ACTIVATE WINDOW queryrem
ENDIF

READ CYCLE


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     QUERYRMM/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF LAST()#27
   FISC=".T."
   IF FILREM=1
      TTQUE=CHR(13)+CHR(10)+"Todos los Remitos"
   ELSE
      =qw_fec(4,27,'rem.fechaop')
      =qw_talS(4,52,'rem.taller')
      STORE NUL TO M.NUINI,NUFIN
      =qw_cor(9,27,'rem.numot')
      ***** FISC
      FISC=qw_fisc(FISC,quefec)
      FISC=qw_FISC(FISC,quetal)
      FISC=qw_FISC(FISC,quecor)
      FISC=IIF(EMPTY(FISC),'.T.',FISC)
      ***** TITULOS
      store "Resumen por " to ressu
      ttFEC=iif(filFEC=3,RESSU+'Fecha',ttfec)
      tttal=iif(filtal=3,RESSU+'Taller',tttal)
      ttcor=iif(filcor=3,RESSU+'O. '+korte,ttcor)
      TTQUE=QW_TT(TTfec)+QW_TT(TTtal)+QW_TT(TTcor)
   ENDIF
   **** AL FIN LISTADOS
   RELE WIND QUERYREM
   IF FILFEC=3 .OR. FILTAL=3 .OR. FILCOR=3
      TT='Listado de Remitos de Producci줻'
      IF FILFEC=3
         CANT_MAX=2
         DIME TEXTO[2,3],VARIABLE[CANT_MAX]
         STORE .T. TO VARIABLE
         TEXTO[1,1]='FECHA'
         TEXTO[1,2]=8
         texto[1,3]="eltexto"
         TEXTO[2,1]='CANTIDAD'
         TEXTO[2,2]=10
         texto[2,3]="TOTAL"
         TT=TT+ttque
         sele rem
         IF PORPAN
            DO LRESP WITH "LREMPZR","REM","REM.FECHAOP","REM.FECHAOP","REM.FECHAOP",'"|"+STR(GTOTAL)+"|"'
         ELSE
            DO LRESI WITH "LREMPZR","REM","REM.FECHAOP","REM.FECHAOP","REM.FECHAOP",'"|"+STR(GTOTAL)+"|"'
         ENDIF
      ELSE
         IF FILCOR=3
            CANT_MAX=2
            DIME TEXTO[2,3],VARIABLE[CANT_MAX]
            STORE .T. TO VARIABLE
            TEXTO[1,1]='N O. '+favri
            TEXTO[1,2]=10
            texto[1,3]="eltexto"
            TEXTO[2,1]='CANTIDAD'
            TEXTO[2,2]=10
            texto[2,3]="TOTAL"
            TT=TT+ttque
            sele rem
            IF PORPAN
               DO LRESP WITH "LREMPZR","REM","REM.numot","REM.numot","str(REM.numot,10)",'"|"+STR(GTOTAL)+"|"'
            ELSE
               DO LRESI WITH "LREMPZR","REM","REM.numot","REM.numot","str(REM.numot,10)",'"|"+STR(GTOTAL)+"|"'
            ENDIF
         ELSE
            CANT_MAX=3
            DIME TEXTO[3,3],VARIABLE[CANT_MAX]
            STORE .T. TO VARIABLE
            TEXTO[1,1]="CODIGO"
            TEXTO[1,2]=10
            texto[1,3]="elCORTE"
            TEXTO[2,1]="TALLER"
            TEXTO[2,2]=30
            texto[2,3]="eltexto"
            TEXTO[3,1]='CANTIDAD'
            TEXTO[3,2]=10
            texto[3,3]="TOTAL"
            TT=TT+ttque
            SET ORDER TO TAG TALCOD IN PER
            sele rem
            SET RELA TO TALLER INTO PER
            IF PORPAN
               DO LRESP WITH "LREMPZR","REM","REM.TALLER","REM.TALLER","PER.CLIENTE",'"|"+STR(GTOTAL)+"|"'
            ELSE
               DO LRESI WITH "LREMPZR","REM","REM.TALLER","REM.TALLER","PER.CLIENTE",'"|"+STR(GTOTAL)+"|"'
            ENDIF
         ENDIF
      ENDIF
   ELSE
      IF PORPAN
         DO LREMPZ
      ELSE
         DO LREMIZ
      ENDIF
   ENDIF
   =KTRUCH()
   =reoprem()
ELSE
   RELE WIND QUERYREM
ENDIF
SET MESS TO LEFT(BOTOM,78)
RETURN LAST()#27 .AND. FILREM#2


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCJ0JTZQE           m.filrem VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QUERYRMM,     Record Number:    2  
*        Variable:            m.filrem                           
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcj0jtzqe     &&  m.filrem VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   if _curobj=2
      IF ELIREM()
         ELREMITO=REM.REMITO
         SELE REX
         SET ORDER TO TAG REMITO
         SEEK REM.REMITO
         do lremiF
      ENDIF
   else
      MINOBJ=CEIL(_CUROBJ/3)*3+1
      MAXOBJ=MINOBJ+2
      _CUROBJ=MINOBJ
   endif
ENDIF
RETURN .T.