*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        08/12/96             ELIREM.PRG                22:39:48 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        GOYO REINER                                             
*                                                                
*        Copyright (c) 1996 GOYO REINER                          
*        1 DE MAYO 2134 Dto 2                                   
*        ROSARIO, SF  2000                                       
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS el_mess,el_tipo

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 ELIREM/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
EL_TIPO=IIF(EMPTY(EL_TIPO),"",EL_TIPO)
STORE SPACE(14) TO M.REMITO
** NOVOGAR
* TIPO="R" -> REMITO PARA FACTURAR
STORE SPACE(14) TO M.EL_SALIDA

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("fic",	INT((SROW()-5)/2), INT((SCOL()-38)/2), INT((SROW()-5)/2)+4, INT((SCOL()-38)/2)+37, ;
 " ELIJA EL REMITO "		)	


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      ELIREM/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("fic")
	ACTIVATE WINDOW fic SAME
ELSE
	ACTIVATE WINDOW fic NOSHOW
ENDIF
@ 1,2 SAY "Remito" ;
	SIZE 1,6, 0
@ 1,12 GET m.remito ;
	SIZE 1,14 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	VALID _rcx1ckpvd() ;
	MESSAGE "Ingrese N de Remito "+el_mess
@ 0,30 GET M.OPCION ;
	PICTURE "@*VN \<OK;\<NO" ;
	SIZE 1,4,1 ;
	DEFAULT 1 ;
	VALID _rcx1ckpw6()

IF NOT WVISIBLE("fic")
	ACTIVATE WINDOW fic
ENDIF

READ


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      ELIREM/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
RELE WIND FIC
RETURN M.EL_SALIDA


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCX1CKPVD           m.remito VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIREM,     Record Number:    3    
*        Variable:            m.remito                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcx1ckpvd     &&  m.remito VALID
#REGION 1
M.REMITO=ALLTRIM(M.REMITO)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _RCX1CKPW6           M.OPCION VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIREM,     Record Number:    4    
*        Variable:            M.OPCION                           
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _rcx1ckpw6     &&  M.OPCION VALID
#REGION 1
STORE .F. TO M.EL_SALIDA
IF LAST()#27 .AND. !EMPTY(M.REMITO)
   IF !EMPTY(VAL(RIGHT(M.REMITO,8)))
      M.REMITO1=Q_FAC(M.REMITO,"","X",M.SUCU,.T.)
      IF XSEEK(M.REMITO,"REM","REMITO") .OR. ;
      XSEEK(M.REMITO1,"REM","REMITO")
         IF EMPTY(M.EL_TIPO) .OR. REM.TIPO=M.EL_TIPO
            STORE .T. TO M.EL_SALIDA
         ELSE
            WAIT "REMITO "+ALLTRIM(M.REMITO)+" ENCONTRADO, PERO ES "+QTIP_REM(M.EL_TIPO) WIND NOWA
         ENDIF
      ELSE
         WAIT "REMITO "+ALLTRIM(M.REMITO)+" NO EXISTE" WIND NOWA
         STORE SPACE(14) TO M.REMITO
         _CURUBJ=1
         RETURN SGET("FIC")
      ENDIF
   ENDIF
ENDIF
CLEA READ