*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        12/02/96             ELIREC.PRG                13:50:33 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("elirec") ;
	OR UPPER(WTITLE("ELIREC")) == "ELIREC.PJX" ;
	OR UPPER(WTITLE("ELIREC")) == "ELIREC.SCX" ;
	OR UPPER(WTITLE("ELIREC")) == "ELIREC.MNX" ;
	OR UPPER(WTITLE("ELIREC")) == "ELIREC.PRG" ;
	OR UPPER(WTITLE("ELIREC")) == "ELIREC.FRX" ;
	OR UPPER(WTITLE("ELIREC")) == "ELIREC.QPR"
	=MOVEWIX("elirec",	INT((SROW()-6)/2), INT((SCOL()-63)/2), INT((SROW()-6)/2)+5, INT((SCOL()-63)/2)+62," Remito de Compras  "		,' '+janname+' ')		
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 ELIREC/MS-DOS Setup Code - SECTION 2           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

=OPPRO()
=OPREC()
** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
#DEFINE ABA    "Abriendo Base de "               && ABA
#DEFINE NUL    0                                 && NUL
#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
#DEFINE PAIP   "|"                               && PAIP
#DEFINE FOLC  ".F."                              && FOLC
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
#DEFINE FOLL  .F.                                && FOLL
#DEFINE TRUC  ".T."                              && TRUC
#DEFINE TRUL  .T.                                && TRUL
#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
#DEFINE ELYES  "SI"                              && ELYES
#DEFINE ELNOU  "NO"                              && ELNOU
#DEFINE ONE    1                                 && ONE
#DEFINE TWO    2                                 && TWO
#DEFINE THREE  3                                 && THREE
#DEFINE FOUR   4                                 && FOUR
#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
#DEFINE RH      36 								 && RH
#DEFINE RP 		47 								 && RP
#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE

** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end

SELE REC
SCAT MEMV BLAN MEMO
SCAT TO RESPALDO BLAN
RELE MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD,MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
PUBL MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD,MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
STORE 1 TO M.PRIOBJ
STORE 0 TO M.FF
STORE .F. TO M.CAMBIO,M.ENCONTRE

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      ELIREC/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("elirec")
	ACTIVATE WINDOW elirec SAME
ELSE
	ACTIVATE WINDOW elirec NOSHOW
ENDIF
@ 2,1 SAY "N de Remito" ;
	SIZE 1,12, 0
@ 1,1 SAY "Proveedor" ;
	SIZE 1,9, 0
@ 1,16 GET m.procod ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN PER_F2("M.PROCOD","del Remito",1,16,"PER.CODCLI","PROVEEDO",1,29)    ;
	VALID _r7v0to49e() ;
	MESSAGE "Ingrese Proveedor"+tex_efes ;
	ERROR "PROVEEDOR NO EXISTE"
@ 1,29 SAY iif(empty(m.procod),"",sayper(m.procod,"procod")) ;
	SIZE 1,31 ;
	PICTURE "@!"
@ 2,16 GET m.remito ;
	SIZE 1,14 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN _r7v0to4cp() ;
	VALID _r7v0to4f6() ;
	MESSAGE "N de Remito - [F4] para Lista de Remitos" ;
	ERROR "REMITO INEXISTENTE"

IF NOT WVISIBLE("elirec")
	ACTIVATE WINDOW elirec
ENDIF

READ CYCLE ;
	SHOW _r7v0to4j3()

=RELEWIN("elirec")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      ELIREC/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
   RELE MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD,MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
RETURN ENCONTRE



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*          ELIREC/MS-DOS Supporting Procedures and Functions     
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
PROCEDURE BROREC
=MOVECENT(0,0,10,60,"BROREC"," Remitos de "+alltrim(sayper(m.procod,"PROCOD"))+' ')
sele rec
=MEN_LIN("[ENTER] para Seleccionar Remito - [ESC] Anula")
on key label ENTER KEYB CHR(23)
brow FIEL ;
REMITO:H="REMITO":R, ;
FECHAOP:H="FECHA":R, ;
COSA=LEFT(LEGAJO,20):H="LEGAJO":R ;
for procod=m.procod
ON KEY LABEL ENTER
=RELEWIN("BROREC")
IF LAST()=23
   M.REMITO=REC.REMITO
   RETURN SGET("ELIREC")
ENDIF
RETURN



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7V0TO49E           m.procod VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIREC,     Record Number:    4    
*        Variable:            m.procod                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7v0to49e     &&  m.procod VALID
#REGION 1
IF LAST()=27
   RETU .T.
ENDIF
IF VALIDPER("PROCOD","M.PROCOD","PROCOD","ELIREC",.T.,.T.,"REC")
   RETU SGET("ELIREC")
ENDIF
RETU .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7V0TO4CP           m.remito WHEN                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIREC,     Record Number:    6    
*        Variable:            m.remito                           
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7v0to4cp     &&  m.remito WHEN
#REGION 1
=OFF_F2()
IF LAST()=27 .OR. EMPTY(M.PROCOD)
   RETURN .T.
ENDIF
ON KEY LABEL F4 DO BROREC
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7V0TO4F6           m.remito VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIREC,     Record Number:    6    
*        Variable:            m.remito                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7v0to4f6     &&  m.remito VALID
#REGION 1
IF LAST()=27
   CLEA READ
   RETURN .T.
ENDIF
IF !empty(m.remito)
   m.remito=q_fac(m.remito)
   show gets wind ELIREC
   IF XSEEK(M.REMITO+M.PROCOD,"REC","REMITO")
      STORE .T. TO M.ENCONTRE
      CLEA READ
      RETURN .T.
   ENDIF
ELSE
   CLEA READ
   RETURN .T.
ENDIF
RETURN .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7V0TO4J3           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         ELIREC                             
*        Called By:           READ Statement                     
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7v0to4j3     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: ELIREC
*
#REGION 1
IF SYS(2016) = "ELIREC" OR SYS(2016) = "*"
	ACTIVATE WINDOW elirec SAME
	@ 1,29 SAY iif(empty(m.procod),"",sayper(m.procod,"procod")) ;
		SIZE 1,31, 0 ;
		PICTURE "@!"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF