* ษอออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : BORLEG.PRG          บ
* บ COMENTARIO    : BORRA UN REGISTRO   บ
* ฬอออออออออออออออออออออออออออออออออออออน
* บ AUTOR      : GOYO REINER            บ
* บ FECHA      : 01-08-95               บ
* บ HORA       : 08:59:24pm             บ
* บ COPYRIGHT  : 1995 by GREGORIO REINERบ
* ศอออออออออออออออออออออออออออออออออออออผ
* BO_TEXTO   : TEXTO DE LA PREGUNTA
* BO_ALIAS   : ALIAS DE LA BASE A BORRAR
* BO_ULPR    : NOMBRE DEL PROGRAMA PARA CHEQUEAR SEGURIDAD
* BO_CAMPO   : NOMBRE DEL CAMPO EN CASO DE QUE EL MEMO NO SEA "LEGAJO"
* BO_REGISTRO: .T. SI SE BORRA EL REGISTRO Y NO CAMPO MEMO
FUNCTION BORLEG
	PARAMETER BO_TEXTO,BO_ALIAS,BO_ULPR,BO_CAMPO,BO_REGISTRO
	=SWAP(@ULPR,@BO_ULPR)
	IF CHEQSEG() 
		IF CONFIRMA("BORRAR "+BO_TEXTO,.T.,10,0)
			SELE (BO_ALIAS)
			REGISTRO=STR(RECNO())
			=LOCK(BO_ALIAS) .OR. LOK(BO_ALIAS)
			DO CASE
			CASE BO_REGISTRO
				DELE
			CASE EMPTY(BO_CAMPO)
				REPL LEGAJO WITH ""
			OTHER
				REPL &BO_CAMPO WITH ""
			ENDCASE
			UNLO ALL
			=IAUD(BO_TEXTO)
			=CTRL2_CA()
		ENDIF
	ELSE
		=IAUDI()
	ENDIF
RETURN SWAP(@ULPR,@BO_ULPR)
