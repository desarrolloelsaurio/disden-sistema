#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
#DEFINE PAIP   "|"                               && PAIP
#DEFINE NUL    0                                 && NUL
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
PROCEDURE LPRS
	PARA S_TIPO
	EXTERNAL PROCEDURE LPRS0.PRG
	=OPPRS()
	=OPPRO()
	=OPMIX()
	=OPAVIS()
	=OPTELS()
	=OPCOMS()
	=OPOTRS()
	DO CASE
	CASE S_TIPO="D"
		STORE INFIC1("Documento a listar",20) TO RESPUESTA
		IF EMPTY(RESPUESTA)
			RETURN MEN_LIN(BOTOM)
		ENDIF
		TT="Presupuestos"+CRLF+"DOCUMENTO:"+ALLT(RESPUESTA)
		FISC="DOCUMENTO='"+RESPUESTA+"'"
	CASE S_TIPO="P"
		=OPPRO()
		IF !ELIPRO("a listar",-1,1)
			RETURN MEN_LIN(BOTOM)
		ENDIF
		TT="Presupuestos"+CRLF+"PROVEEDOR:"+ALLTR(PER.CLIENTE)
		FISC="PROCOD='"+PER.CODCLI+"'"
	CASE S_TIPO="A"
		=OPAVIS()
		IF !ELIAVIS("a listar",-1,1)
			RETURN MEN_LIN(BOTOM)
		ENDIF
		TT="Presupuestos"+CRLF+"AV¡O:"+ALLTR(AVIS.AVIO)
		FISC="AVICODPRO='"+AVIS.AVICODPRO+"'"
	CASE S_TIPO="T"
		=OPTELS()
		IF !ELITELS("a listar",-1,1)
			RETURN MEN_LIN(BOTOM)
		ENDIF
		TT="Presupuestos"+CRLF+"TELA:"+ALLTR(TELS.TELA)
		FISC="TELCODPRO='"+TELS.TELCODPRO+"'"
	CASE S_TIPO="C"
		=OPCOMS()
		IF !ELICOMS(" a listar",-1,1)
			RETURN MEN_LIN(BOTOM)
		ENDIF
		TT="Presupuestos"+CRLF+"PROD.TERMINADO:"+ALLTR(COMS.COMPRA)
		FISC="COMCODPRO='"+COMS.COMCODPRO+"'"
	CASE S_TIPO="O"
		=OPOTRS()
		IF !ELIOTRS(" a listar",-1,1)
			RETURN MEN_LIN(BOTOM)
		ENDIF
		TT="Presupuestos"+CRLF+"OTRO PRODUCTO:"+ALLTR(OTRS.OTRO)
		FISC="OTRCODPRO='"+OTRS.OTRCODPRO+"'"
	ENDCASE
	=WORKING()
	=DOTALK()
	TMP=GENTMP()
	SELE PRS
	=FLOCK() .OR. FLOK()
	SORT ON FECHAOP TO (TMP) FOR &FISC
	UNLO IN PRS
	=PRXAREA(.T.)
	USE (TMP) ALIAS TMP
	=UNTALK()
	=UNWORK()
CANT_MAX=12
DIME VARIABLE[CANT_MAX], Habilitado[CANT_MAX],habilant[cant_max]
STORE .T. TO HABILITADO
      DIME TEXTO[CANT_MAX,2]
      TEXTO[1,1]="NRO INT."
      TEXTO[2,1]="FECHA"
      TEXTO[3,1]="VIGENCIA"
      TEXTO[4,1]="DOCUMENTO"
      TEXTO[5,1]="PROVEEDOR"
      TEXTO[6,1]="CODIGO"
      TEXTO[7,1]="DESCRIPCION"
      TEXTO[8,1]="CANTIDAD"
      TEXTO[9,1]="UNIDAD"
      TEXTO[10,1]="PRECIO UNIT."
      TEXTO[11,1]="MONTO TOTAL"
      TEXTO[12,1]="CONDICION"
      TEXTO[1,2]=8
      TEXTO[2,2]=8
      TEXTO[3,2]=8
      TEXTO[4,2]=20
      TEXTO[5,2]=20
      TEXTO[6,2]=20
      TEXTO[7,2]=20
      TEXTO[8,2]=XACDIGI+2
      TEXTO[9,2]=10
      TEXTO[10,2]=XACDIGI+2
      TEXTO[11,2]=XACDIGI+2
      TEXTO[12,2]=15
	   DO WHILE(CFGFAC())
    	  ACLA=HAZ_ACLA()
		=XPRN1(4, "TMP", "LPRS0()", fisc, "LPRS")
	ENDDO
	=OFF_TMP()
RETURN MEN_LIN(BOTOM)
