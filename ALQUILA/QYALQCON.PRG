*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        09/17/95            QYALQCON.PRG               18:10:13 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        GREGORIO REINER                                         
*                                                                
*        Copyright (c) 1995 GOYO REINER                          
*        MITRE 1480 '4' B                                       
*        ROSARIO, SF  2000                                       
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS porpan,porshit

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                QYALQCON/MS-DOS Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
STORE "" TO ttInq, ttprp , TTINI, TTFIN , TTMES, TTFEC,TTXNUM
STORE 1  TO filinq,filprp,FILINI,FILFIN,FILMES,FILFEC,FILXNUM,minobj
STORE "" TO queinq,queprp,QUEINI,QUEFIN,QUEMES,QUEFEC,QUEXNUM
store 2 to maxobj
STORE .F. TO M.HUBORES
STORE {} TO M.FECINI,M.FECFIN
VENTANT=WONTOP()
ACTI SCRE
** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
#DEFINE ABA    "Abriendo Base de "               && ABA
#DEFINE NUL    0                                 && NUL
#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
#DEFINE PAIP   "|"                               && PAIP
#DEFINE FOLC  ".F."                              && FOLC
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
#DEFINE FOLL  .F.                                && FOLL
#DEFINE TRUC  ".T."                              && TRUC
#DEFINE TRUL  .T.                                && TRUL
#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
#DEFINE ELYES  "SI"                              && ELYES
#DEFINE ELNOU  "NO"                              && ELNOU
#DEFINE ONE    1                                 && ONE
#DEFINE TWO    2                                 && TWO
#DEFINE THREE  3                                 && THREE
#DEFINE FOUR   4                                 && FOUR
#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
#DEFINE RH      36 								 && RH
#DEFINE RP 		47 								 && RP
#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE

** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("queryalq",	INT((SROW()-14)/2), INT((SCOL()-79)/2), INT((SROW()-14)/2)+13, INT((SCOL()-79)/2)+78, ;
 " L죑ites del Listado "		,' '+JANNAME+' ')


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     QYALQCON/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("queryalq")
	ACTIVATE WINDOW queryalq SAME
ELSE
	ACTIVATE WINDOW queryalq NOSHOW
ENDIF
@ 1,1 GET m.filINQ ;
	PICTURE "@*RVN \<Todos los Inquilinos;\<Un Inquilino" ;
	SIZE 1,24,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ(.F.,2)
@ 1,50 GET m.filprp ;
	PICTURE "@*RVN \<Todos los Propietarios;\<Un Propietario" ;
	SIZE 1,26,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ(.F.,3)
@ 5,1 GET m.filini ;
	PICTURE "@*RVN \<Todos los Contratos;\<Entre Fechas;\<Resumen" ;
	SIZE 1,23,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ(.F.,3,7) ;
	MESSAGE "L죑ites por Fecha de Inicio de Contrato"
@ 5,26 GET m.filmes ;
	PICTURE "@*RVN \<Todos los Contratos;\<Cantidad de Meses;\<Resumen" ;
	SIZE 1,23,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ(.F.,3,10) ;
	MESSAGE "L죑ites por Meses de Duraci줻 del Contrato"
@ 5,50 GET m.filfin ;
	PICTURE "@*RVN \<Todos los Contratos;\<Entre Fechas;\<Resumen" ;
	SIZE 1,23,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID VAL_OBJ(.F.,2) ;
	MESSAGE "L죑ites por Fecha de Finalizaci줻 de Contrato"
@ 10,28 GET m.lista ;
	PICTURE "@*HN \!Confirma;\?Anula" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _r3p12y205()

IF NOT WVISIBLE("queryalq")
	ACTIVATE WINDOW queryalq
ENDIF

READ CYCLE

=RELEWIN("queryalq")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     QYALQCON/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF !EMPTY(VENTANT)
   ACTI WIND (VENTANT)
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3P12Y205           m.lista VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QYALQCON,     Record Number:    7  
*        Variable:            m.lista                            
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3p12y205     &&  m.lista VALID
#REGION 1
IF M.LISTA=1
   IF LAST()#27
      STORE "     " TO M.RETORNO
      =opper()
      =opgar()
      =opprp()
      =OPINM()
      =OPALQ()
      FISC=".T."
      tt='Listado de Alquileres'+;
      IIF(AFUTURO," a Futuro","")+;
      crlf+"Datos Contractuales"

      CANT_MAX=9
      DIME TEXTO[CANT_MAX,3], VARIABLE[CANT_MAX], Habilitado[CANT_MAX],habilant[cant_max]

      TEXTO[1,2]=10
      TEXTO[2,2]=IIF(PORPAN,20,40)
      TEXTO[3,2]=IIF(PORPAN,15,20)
      TEXTO[4,2]=IIF(PORPAN,20,30)
      TEXTO[5,2]=IIF(PORPAN,20,30)
      TEXTO[6,2]=8
      TEXTO[7,2]=3
      TEXTO[8,2]=8
      TEXTO[9,2]=3

      TEXTO[1,1]='CODIGO INMUEBLE'
      TEXTO[2,1]='DOMICILIO'
      TEXTO[3,1]='LOCALIDAD'
      TEXTO[4,1]='PROPIETARIO'
      TEXTO[5,1]='INQUILINO'
      TEXTO[6,1]='F.INICIO'
      TEXTO[7,1]='CANT'
      TEXTO[8,1]='F.FINAL'
      TEXTO[9,1]='DIA'

      TEXTO[1,3]='ALQ.CODINM'
      TEXTO[2,3]='INM.DOMICILIO'
      TEXTO[3,3]='MIX.TEXTO1'
      TEXTO[4,3]='INM.PROCOD,PER.CLIENTE'
      TEXTO[5,3]='ALQ.CODCLI,PER.DETALLE'
      TEXTO[6,3]='ALQ.FECHAALQ,INM.INMOC'
      TEXTO[7,3]='ALQ.CANTMESES,INM.MUNIC'
      TEXTO[8,3]='ALQ.FECHAVENC,INM.DIPOC'
      TEXTO[9,3]='ALQ.DIAVENC'

      store "" to ttque
      store .t. to habilitado
      STORE filinq+filprp+FILINI+FILFIN+FILMES to m.fil
      IF m.fil=5
         TTQUE=QW_TT("Todos los Contratos")
      ELSE
         STORE QW_INQ(3,1,'ALQ.CODCLI',.t.) TO HABILITADO[5]
         STORE QW_PRP(3,50,'INM.PROCOD',.t.)  TO HABILITADO[4]
         *
         STORE M.FILINI TO M.FILFEC
         STORE QW_FEC(8,1,'ALQ.FECHAALQ') TO HABILITADO[6]
         =SWAP(@QUEFEC,@QUEINI)
         =SWAP(@TTFEC,@TTINI)
         =SWAP(@FILFEC,@FILINI)
         STORE IIF(!EMPTY(TTINI),'Fecha de Inicio '+alltrim(lower(ttini)),TTINI) TO M.TTINI
         *
         STORE QW_XNUM(FILMES,8,26,"ALQ.CANTMESES","Duraci줻 del Contrato en Meses","Meses") TO HABILITADO[7]
         =SWAP(@QUEXNUM,@QUEMES)
         =SWAP(@TTXNUM,@TTMES)
         =SWAP(@FILXNUM,@FILMES)
         *
         STORE M.FILFIN TO M.FILFEC
         STORE QW_FEC(8,50,'ALQ.FECHAVENC') TO HABILITADO[8]
         =SWAP(@QUEFEC,@QUEFIN)
         =SWAP(@TTFEC,@TTFIN)
         =SWAP(@FILFEC,@FILFIN)
         STORE IIF(!EMPTY(TTfin),'Fecha de Finalizaci줻 '+alltrim(lower(ttfin)),TTfin) TO M.TTfin
         ***** FISC
         FISC=qw_FISC(FISC,queinq)
         FISC=qw_FISC(FISC,queprp)
         FISC=qw_FISC(FISC,queini)
         FISC=qw_FISC(FISC,quemes)
         FISC=qw_FISC(FISC,quefin)
         FISC=IIF(EMPTY(FISC),'.T.',FISC)
         ***** TITULOS
         TTQUE=QW_TT(ttinq)+;
         QW_TT(ttprp)+;
         QW_TT(ttini)+;
         QW_TT(ttmes)+;
         QW_TT(ttfin)
      endif
      **** AL FIN LISTADOS
      =acopy(habilitado,habilant)
      TTORI=TT
      do while CFGFAC()
      =WORKING()
      =DOTALK()
         =OFF_RELA()
         SELE MIX
         SET ORDER TO TAG CIUCOD
         SELE INM
         SET RELA TO LOCALIDAD INTO MIX
         SET ORDER TO TAG CODINM IN INM
         SELE ALQ
         SET RELA TO CODINM INTO INM ADDI
         STORE SPACE(30) TO GARA1,GARA2,GARA3
         LOSCAMPOS=LISTACPO()
         TMP=GENTMP()
         IF TYPE("ORDINM")="U" .OR. ORDINM
            SORT ON CODINM ;
            FOR &FISC ;
            FIELDS &LOSCAMPOS ;
            TO &TMP
         ELSE
            SORT ON INM.DOMICILIO ;
            FOR &FISC ;
            FIELDS &LOSCAMPOS ;
            TO &TMP
         ENDIF
         SELE ALQ
         USE
         USE (TMP) ALIAS ALQ EXCL
         IF HAYCAMPO("CLIENTE","ALQ")
            SET ORDER TO TAG PRPCOD IN PER
            SET RELA TO PROCOD INTO PER
            REPL ALL CLIENTE WITH PER.CLIENTE
         ENDIF
         IF HAYCAMPO("DETALLE","ALQ")
            SET ORDER TO TAG INQCOD IN PER
            SET RELA TO CODCLI INTO PER
            REPL ALL DETALLE WITH PER.CLIENTE
         ENDIF
         IF HAYCAMPO("INMOC","ALQ")
            REPL ALL INMOC WITH DTOC(FECHAALQ)
         ENDIF
         IF HAYCAMPO("MUNIC","ALQ")
            REPL ALL MUNIC WITH STR(CANTMESES,TEXTO[7,2])
         ENDIF
         IF HAYCAMPO("DIPOC","ALQ")
            REPL ALL DIPOC WITH DTOC(FECHAVENC)
         ENDIF
         STORE NUL TO CASOS
         ACLA=HAZ_ACLA()
         M.LINEA=REPL("=",LEN(ACLA))
         TT=TTORI+ttque
         =UNTALK()
         =UNWORK()
         =LGRL2(PORPAN,"ALQ","LALQPER1()","FISC","LALQCON")
         =REOPALQ()
         SELE ALQ
         SET ORDER TO TAG CODINM
         =REOPINM()
         SELE INM
         SET ORDER TO TAG CODINM
         SET RELA TO CODINM INTO ALQ
       =KTRUCH()
      store .f. to variable
   ENDdo
   store .f. to variable
   =acopy(habilant,habilitado)
ENDIF
ENDIF
CLEA READ
RETURN .T.

