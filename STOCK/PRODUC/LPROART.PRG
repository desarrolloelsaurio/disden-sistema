#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'°') && IMPRIMIENDO
#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
PROCEDURE LPROART
PARA PORDONDE
STORE HORA_ULP(PROGRAM()) TO ULPR
=OPAVIS()
=OPTELS()
=OPCOMS()
=OPOTRS()
=OPPRO()
IF ELIPRO("a Listar",-1,1)
TMP=GENTMP()
CREATE TABLE (TMP) (;
	XXXCODPRO C(20), XXXX   C(40), MARCA C(2),;
	AVICODPRO C(20), AVIO   C(40), ;
	TELCODPRO C(20), TELA   C(40), ;
	COMCODPRO C(20), COMPRA C(40), ;
	OTRCODPRO C(20), OTRO   C(40), ;
	procod c(10), TIPOART C(20))
USE
=PRXAREA(.T.)
USE (TMP) ALIAS TMP
=DOTALK()
=WORKING()
APPEND FROM DBF('AVIS') FOR PROCOD = PER.CODCLI
APPEND FROM DBF('TELS') FOR PROCOD = PER.CODCLI
APPEND FROM DBF('COMS') FOR PROCOD = PER.CODCLI
APPEND FROM DBF('OTRS') FOR PROCOD = PER.CODCLI
REPL XXXCODPRO WITH AVICODPRO, XXXX WITH AVIO, TIPOART WITH "AVIOS ";
	FOR !EMPTY(AVICODPRO)
REPL XXXCODPRO WITH TELCODPRO, XXXX WITH TELA, TIPOART WITH "TELAS ";
	FOR !EMPTY(TELCODPRO)
REPL XXXCODPRO WITH COMCODPRO, XXXX WITH COMPRA, TIPOART WITH "PROD.TERMINADOS ";
	FOR !EMPTY(COMCODPRO)
REPL XXXCODPRO WITH OTRCODPRO, XXXX WITH OTRO, TIPOART WITH "OTROS PROD. ";
	FOR !EMPTY(OTRCODPRO)
=UNTALK()
=UNWORK()
DO WHILE .T.
M.OPCION=XPRN(2)
    DO CASE
    CASE M.OPCION=1
	REPO FORM LPROART PREV
CASE M.OPCION=2
	=MEN_LIN(IMPRIMIENDO)
	=IMPRESOR()
	REPO FORM LPROART to printer NOCONSOLE NOEJECT
	=MEN_LIN(BOTOM)
	=IAUD("PROVEED. "+ALLTRIM(PER.CODCLI))
	=BEEP(3)
	OTHERWISE
	EXIT
ENDCASE
ENDDO
endif
RETURN OFF_TMP() .and. men_lin(botom)
