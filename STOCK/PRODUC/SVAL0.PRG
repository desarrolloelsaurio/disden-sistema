FUNCTION SVAL0
#DEFINE PAIP   "|"                               && PAIP
EXTERNAL ARRAY S_UNITXT
EXTERNAL ARRAY ELPI1
? PAIP
?? RUBRO
?? PAIP
IF S_STOCK#"N"
	FOR M.XXX=1 TO ALEN(S_UNITXT)
		??IIF(XSEEK(CODIGO+S_UNITXT[M.XXX],"TMP4","UNIDAD"),;
		    TMP4.STOCK, 0) PICT ELPI1[M.XXX]
		STORE TMP4.STOCK+TOTAL[M.XXX] TO TOTAL[M.XXX] 
		??PAIP
	NEXT
	?? TRANS(MONTO,ELPI1[ALEN(S_UNITXT)+1])
	STORE MONTO+TOTAL[ALEN(S_UNITXT)+1] TO TOTAL[ALEN(S_UNITXT)+1]
ELSE
	?? TRANS(MONTO,ELPI1[1])
	?? PAIP
	?? TRANS(STOCKRES,ELPI1[2])
	?? PAIP
	?? TRANS(STOCKRES+MONTO,ELPI1[3])
	STORE MONTO+TOTAL[1] TO TOTAL[1]
	STORE STOCKRES+TOTAL[2] TO TOTAL[2]
	STORE MONTO+STOCKRES+TOTAL[3] TO TOTAL[3]
*	?? TRANS(MONTO,ELPI1)
*	STORE MONTO+TOTAL TO TOTAL
ENDIF
?? PAIP
return