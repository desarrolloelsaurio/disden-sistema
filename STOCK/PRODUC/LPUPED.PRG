FUNCTION LPUPED
	PARAMETER QT, PORPAN
	EXTERNAL PROCEDURE PUPEDAC0.PRG
	#DEFINE BOTOM  "  "+repl("°",78)              && BOTOM
	#DEFINE PAIP   "|"                            && PAIP

	=OPPRO()
	DO OPMDD
	tt="Listado de Stock "
	DO CASE
	CASE QT="A"
		DO OPAVIS
		TXT1="AVIO"
		TT=TT+"Av¡os"
		SELE AVIS
	CASE QT="T"
		DO OPTELS
		TT=TT+"Telas"
		TXT1="TELA"
		sele tels
	CASE QT="C"
		DO OPCOMS
		TT=TT+"Compra"
		sele coms
		TXT1="COMPRA"
	CASE QT="O"
		DO OPOTRS
		TT=TT+"Otros Productos"
		sele OTRS
		TXT1="OTRO"
	ENDCASE
	tt=tt+" por debajo del Punto de Pedido"
	=DOTALK()
	=WORKING()
	TMP=GENTMP()
	=FLOCK() .OR. FLOK()
	DO CASE
	CASE QT="A"
		IF ORDAVIS
			SORT ON AVICODPRO TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ELSE
			SORT ON AVIO TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ENDIF
		UNLO IN AVIS
	CASE QT="T"
		IF ORDTELS
			SORT ON TELCODPRO TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ELSE
			SORT ON TELA TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ENDIF
		UNLO IN TELS
	CASE QT="C"
		IF ORDCOMS
			SORT ON COMCODPRO TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ELSE
			SORT ON COMPRA TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ENDIF
		UNLO IN COMS
	CASE QT="O"
		IF ORDOTRS
			SORT ON OTRCODPRO TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ELSE
			SORT ON OTRO TO (TMP) FOR !EMPTY(STOCKMIN) .AND. STOCK<=STOCKMIN
		ENDIF
		UNLO IN OTRS
	ENDCASE
	=PRXAREA(.T.)
	USE (TMP) ALIAS TMP EXCL
	ACLA=PAIP+;
		PADC("CODIGO",20)+;
		PAIP+;
		PADC(TXT1,IIF(PORPAN,20,30))+;
		PAIP+;
		PADC("STOCK",XACDIGI)+;
		PAIP+;
		PADC("MINIMO",XACDIGI)+;
		PAIP+;
		PADC("IDEAL",XACDIGI)+;
		PAIP+;
		PADC("DIFERENCIA",XACDIGI)+;
		PAIP
	=UNWORK()
	=UNTALK()
	STORE "" TO M.LINEA,M.CASOS
	=LGRL2(PORPAN,"TMP","PUPEDAC0()","COMPLETO","LPPEDACP")
	=OFF_TMP()
RETURN MEN_LIN(BOTOM)
