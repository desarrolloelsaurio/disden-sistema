* 旼 Funci줻  컴컴컴컴컴컴컴컴커
*   DESCRIPTION: LCCIPZ.PRG   
*        Author: G. REINER    
*  Date created: 10-22-92     
*  Time created: 02:10:26pm   
* 읕컴컴컴컴컴컴컴컴컴컴컴컴컴켸
FUNCTION LCCIPZ1
	#DEFINE NUL    0                               && NUL
	#DEFINE PAIP   "|"                             && PAIP

	?PAIP
	=IIF(VARIABLE[1],QOUT(DTOC(CCI.FECHAOP)+PAIP),'')
	=IIF(VARIABLE[2],QOUT(IIF(LEFT(CCI.CODCLI,1)='P',LEFT(PER.CLIENTE,TEXTO[2,2]),LEFT(PER.CLIENTE,TEXTO[2,2]))+PAIP),'')
	=IIF(VARIABLE[3],QOUT(LEFT(CCI.NUMERE,TEXTO[3,2])+PAIP),'')
	=IIF(VARIABLE[4],QOUT(LEFT(CCI.DETALLE,TEXTO[4,2])+PAIP),'')
	=IIF(VARIABLE[5],QOUT(LEFT(CCI.PERIO,2)+"-"+SUBS(CCI.PERIO,3,2)+"-"+RIGHT(CCI.PERIO,3)+PAIP),'')
	=IIF(VARIABLE[6],QOUT(DTOC(CCI.FECHAVE)+PAIP),'')
	=IIF(VARIABLE[7],QOUT(DTOC(CCI.ENTREGADA)+PAIP),'')
	=IIF(VARIABLE[8],QOUT(IIF(CCI.PAGADA,'SI','NO')+PAIP),'')
	IF VARIABLE[9]
		TTL[9]=TTL[9]+MONTO
		IF EMPTY(CCI.COMPRRE) .OR. CCI.COMPRRE='ND' .OR. CCI.COMPRRE='FA'
			?? STR(MONTO,XACDIGI,2)
			?? PAIP
			?? SPACE(XACDIGI)
			STORE TTL[7]+MONTO TO TTL[7]
		ELSE
			?? SPACE(XACDIGI)
			?? PAIP
			LAK=ABS(MONTO)
			?? STR(LAK,XACDIGI,2)
			TTL[8]=TTL[8]+LAK
		ENDIF
		?? PAIP
		?? STR(TTL[9],XACDIGI,2)
		?? PAIP
	ENDIF
	CASOS=CASOS+1
RETURN .T.
