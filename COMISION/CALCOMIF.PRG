PROCEDURE CALCOMIF
HISTORICO=.F.
=OPCCL()
=opcli()
IF HISTORICO
   =CLOSDBF("FAX")
   =CLOSDBF("FAC")
   =OPFAH()
ELSE
   =opfac()
ENDIF
store nul to respuesta
if elifac()
   XDTO = 1 - (FAC.DESCUENTO/IIF(LEFT(PER.CONDIVA,1)="R",FAC.MONTO, FAC.DESCUENTO+FAC.MONTONET ))
   STORE 0 TO M.TOTCOMISIO
   SELE FAX
   SCAN FOR FACTURA=FAC.FACTURA
    	  M.TOTCOMISIO = M.TOTCOMISIO + TOTAL / 100 * PORCOMISIO
   ENDSCAN
   M.TOTCOMISIO = M.TOTCOMISIO *  XDTO 
   DEFI WIND A FROM 10,10 TO 15,50
   ACTI WIND A
   @ 1,1 SAY "COMISION:"
   @ 1,10 SAY "CALCULADO"
   @ 2,10 SAY "GRABADO"
   @ 1,20 SAY M.TOTCOMISIO PICTURE "999,999,999.99"
   sele ccl
   set orde to numerore
   seek fac.factura
   @ 2,20 SAY CCL.COMISION PICTURE "999,999,999.99"
   WAIT "OPRIMA UNA TECLA" WIND 
   RELE WIND A
ENDIF
RETURN .T.