FUNCTION XPRN2
	PARAMETER CA_OPCIONES,EL_PROGRAMA
	DO WHILE .T.
		EL_CONT="Por \<Pantalla;Por \<Impresora;"
		DO CASE
		CASE CA_OPCIONES=2
			M.EL_CONT=M.EL_CONT+"\\<Archivo ASCII;\\<Otras Impresoras;"
		CASE CA_OPCIONES=3
			M.EL_CONT=M.EL_CONT+"\<Archivo ASCII;\\<Otras Impresoras;"
		CASE CA_OPCIONES=4
			M.EL_CONT=M.EL_CONT+"\<Archivo ASCII;\<Otras Impresoras;"
		ENDCASE
		M.EL_CONT=M.EL_CONT+"\<Men£ Anterior"
		M.PORDONDE=ALGUN(30," Salida del Listado ",EL_CONT)
		DO CASE
		CASE M.PORDONDE=1
			STORE .T. TO M.PORPAN
			IF TYPE("ACLAPAN")#"U"
				ACLA=ACLAPAN
			ENDIF
			=EVAL(EL_PROGRAMA)
		CASE M.PORDONDE=2
			STORE .F. TO M.PORPAN
			IF TYPE("ACLAPRN")#"U"
				ACLA=ACLAPRN
			ENDIF
			#IF "FELIX" $ CURD()
			=CARTEL("POR FAVOR, ASEGURESE DE QUE LA LUZ VERDE (READY)",;
			"DEL PANEL SUPERIOR DE LA IMPRESORA ESTE ENCENDIDA",;
			"EN CASO DE ON ESTARLO, OPRIMA LA TECLA [CONTINUE] DE LA IMPRESORA",;
			"HASTA LOGRARLO. GRACIAS")
			#ENDIF
			=EVAL(EL_PROGRAMA)			
		CASE M.PORDONDE=3
			M.ENASCII=.T.
			STORE .F. TO M.PORPAN
			IF TYPE("ACLAPRN")#"U"
				ACLA=ACLAPRN
			ENDIF
			=EVAL(EL_PROGRAMA)			
		CASE M.PORDONDE=4
			DO XANUIM
			LOOP
		OTHERWISE
			EXIT
		ENDCASE
	ENDDO
RETURN .T.
