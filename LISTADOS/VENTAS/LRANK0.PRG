FUNCTION LRANK0
PARAMETER QL_LIS
#DEFINE PAIP   "|"                               && PAIP

DO CASE
CASE QL_LIS=1
? PAIP+SAYMIX(LEFT(TMP.CODZON,3),"RUBCOD")
CASE QL_LIS=2
? PAIP+PADR(QTEM(ALLTRIM(TMP.CODZON)),20)
CASE QL_LIS=3
? PAIP+PADR(QSEX(ALLTRIM(TMP.CODZON)),20)
CASE QL_LIS=4
? PAIP+SAYMIX(LEFT(TMP.CODZON,2),"LINCOD")
CASE QL_LIS=5
? PAIP+SAYMIX(LEFT(TMP.CODZON,2),"MATCOD")
CASE QL_LIS=6
? PAIP+SAYMIX(LEFT(TMP.CODZON,2),"MARCOD")
ENDCASE
?? PAIP
?? STR(CANT,10)
?? PAIP
STORE CANT+M.TOTAL TO M.TOTAL
RETURN .T.