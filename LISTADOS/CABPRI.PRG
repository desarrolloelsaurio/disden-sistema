*******************************************
*-- Programa: CABPRI.PRG
*-- Fecha   : 09/26/91 12:55pm
*-- Version : G. REINER
*-- Notas   : GENERA VARIABLES DE CABECERA
******************************************
FUNCTION CABPRI
PARAMETER MARGENIZ,CANTLIN,MARGENDER
PRIVATE VENTANT
#DEFINE IMPRIMIEND  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'°') && IMPRIMIEND
#DEFINE NUL    0                              && NUL
 
IF EMPTY(CANTLIN)
   IF TYPE("XALARGO")#"U" .AND. !EMPTY(M.XALARGO)
      CANTLIN=ALLTRIM(STR(M.XALARGO))
   ELSE
      CANTLIN="72"
   ENDIF
ENDIF
MARGENDER=IIF(EMPTY(MARGENDER),"80",MARGENDER)
ACLA=IIF(TYPE("ACLA")='U','',ACLA)
STORE REPL("=",LEN(ACLA)) TO LINEA
STORE LEN(ACLA) TO LARGO
STORE MIN(XACANCHO,XACHOJA) TO LARGOIM
ON KEY DO ABPR
=MEN_LIN(IMPRIMIEND)
XA=''
IF GETENV("USERNAME")#"GOYO" .AND. GETENV("USERNAME")#"BATA" .AND. GETENV("EQUIPO")#'MICASA'
   ON ERROR DO ABPR
ENDIF
IF TYPE("ENASCII")#"U" .AND. ENASCII
   XA=ENASCII()
ELSE
   IF TYPE("PORBASE")#"U" .AND. PORBASE
      RELE XA
      PUBL XA
      XA=ENASCII(.T.)
      IF !EMPTY(XA)
         RETURN .T.
      ENDIF
      RELE XA
   ENDIF
ENDIF
SET CONSOLE OFF
DO CASE
CASE !EMPTY(XA) .AND. TYPE("ENASCII")#"U" .AND. ENASCII
   SET PRIN TO (XA)
CASE TYPE("CAPTURAR")="L" .AND. CAPTURAR
   SET PRINTER TO \\SPOOLER\S=NASA-PRODUCCION\Q=PRINTQ_0\N
CASE TYPE("LPT3")="L" .AND. LPT3
   SET PRINTER TO LPT3
CASE TYPE("LPT2")="L" .AND. LPT2
   SET PRINTER TO LPT2
OTHERWISE
   SET PRINTER TO LPT1
ENDCASE
=IMPRESOR()
SET DEVI TO PRIN
SET PRIN ON
_PEJECT="NONE"
_PLENGTH=VAL(CANTLIN)
_RMARGIN=VAL(MARGENDER)
_PLINENO=NUL
_PAGENO=1
=PSPECODE(CANTLIN)
IF EMPTY(MARGENIZ)
   SET MARGIN TO 0
   _PLOFFSET=NUL
ELSE
   SET MARGIN TO MARGENIZ
   _PLOFFSET=MARGENIZ
ENDIF
_RMARGIN=VAL(MARGENDER)
_ALIGNMENT='LEFT'
_PADVANCE="LINEFEEDS"
IF GETENV("PRN")="BROTHER"
   =PSPECODE("72")
ENDIF
RETURN .T.
