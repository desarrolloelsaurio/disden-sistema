PARAMETER COSA,QUEBUSCA
IF FILE('INFORME.TXT')
   ERASE INFORME.TXT
ENDIF
FRESULTADO=FCREATE('INFORME.TXT')
COSA=COSA+'.PJX'
CNT=2
USE (COSA)
SKIP
SCAN WHILE !EOF()
   ? NAME
   ?? '-'
   ?? ALLTRIM(SUBSTR(NAME,RAT(".",NAME)+1))
   CNT=CNT+1
   fuente=alltrim(NAME)
   IF ALLTRIM(SUBSTR(NAME,RAT(".",NAME)+1))#'DBF'
   Frespaldo=fOPEN(FUENTE,0)
   do while !feof(frespaldo)
      A=FGETS(FRESPALDO)
      IF QUEBUSCA $ UPPER(A)
         A=ALLTRIM(FGETS(FRESPALDO))
         DO GRABA
         EXIT
      ENDIF
   ENDdo
   =FCLOSE(FRESPALDO)
   ENDIF
ENDS
CLOSE ALL
FRESULTADO=FOPEN('INFORME.TXT')
DIME TEXTO[CNT]
STORE '' TO TEXTO
PUNTERO=1
DO WHILE !FEOF(FRESULTADO)
   TEXTO[PUNTERO]=FGETS(FRESULTADO)
   ? TEXTO[PUNTERO]
   PUNTERO=PUNTERO+1
ENDDO
 =ASORT(TEXTO)
   IF FILE('INFORME.DOC')
      ERASE INFORME.DOC
   ENDIF
   ? FCLOSE(FRESULTADO)
   FRESULTADO=Fcreate('INFORME.DOC')
   clea
   FOR X=1 TO CNT
      IF !EMPTY(TEXTO[X])
         =FPUTS(FRESULTADO,TEXTO[X])
      ENDIF
   ENDFOR
   =FCLOSE(FRESULTADO)
   RETURN
PROCEDURE GRABA
=FPUTS(FRESULTADO,FUENTE)
RETURN
