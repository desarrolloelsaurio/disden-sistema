#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
PROCEDURE COMP_DIR
	PARAMETER EL_DIR1,EL_DIR2
SET PATH TO ;
\SISTEMAS\HERRAM,;
\SISTEMAS\LISTADOS,;
\SISTEMAS\VARIOS,;
\SISTEMAS\CARTELES,;
\SISTEMAS\PREGUNTA,;
\SISTEMAS\CARTELES,;
\SISTEMAS\CUERDAS,;
\SISTEMAS\VENTANAS,;
\SISTEMAS\SONIDO
	STORE 80 TO XACANCHO,XACHOJA,LARGO,LARGOIM
ULPR=PROGRAM()
USADOR=GETENV("USERNAME")
	EL_DIR1=quebases(el_dir1,"BASE1.dbf")
	EL_DIR2=quebases(el_dir2,"BASE2.dbf")
	CLOSE DATA
	SELE 0
	USE (EL_DIR1+"\BASE1") ALIAS BASE1
	SELE 0
	USE (EL_DIR2+"\BASE2") ALIAS BASE2
	store  .T. to enascii
	LINEA=REPL("-",60)
	acla=REPL("-",60)
	tt="COMPARACION ENTRE "+;
		EL_DIR1+"\BASE1"+;
		" Y "+;
		EL_DIR2+"\BASE2"
	=CABPRI()
	_PCOPIES=1
	SET TALK OFF
	PRINTJOB
	=CABPRI1()
	SET ORDER TO TAG BASE IN BASE1
	SET ORDER TO TAG BASE IN BASE2
	SELE BASE1
	STORE .T. TO OK
	SCAN
		IF !XSEEK(BASE1.FIELD_BASE,"BASE2","BASE")
			? "FALTA BASE "
			?? BASE1.FIELD_BASE
			STORE .F. TO OK
		ENDIF
	ENDSCAN
	? LINEA
	IF OK
		? "NO HAY DIFERENCIAS EN CANTIDAD DE ARCHIVOS"
	ELSE
		? "FIN DE DIFERENCIAS DE ARCHIVOS"
	ENDIF
	? LINEA
	? "INICIO DE ANALISIS POR ARCHVO"
	? LINEA
	SET ORDER TO TAG CAMPO
	STORE 1 TO VEZ
	SCAN
		IF BASE1.FIELD_TYPE="B"
			?
			? LINEA
			? "BASE:"
			?? FIELD_NAME
			? LINEA
			STORE .T. TO M.OK
		ELSE
			IF !XSEEK(BASE1.FIELD_BASE+BASE1.FIELD_NAME,"BASE2","CAMPO")
				? "  -->"
				?? FIELD_NAME
				?? " - "
				?? FIELD_TYPE
				?? " - "
				?? STR(FIELD_LEN,3)
				?? ","
				?? STR(FIELD_DEC,3)
				STORE .F. TO M.OK
			ENDIF
		ENDIF
	ENDSCAN
	ENDPRINT
	=FINIMP()
	*** SEGUNDA PARTE
		tt="COMPARACION ENTRE "+;
		EL_DIR1+"\BASE2"+;
		" Y "+;
		EL_DIR2+"\BASE1"
	=CABPRI()
	_PCOPIES=1
	SET TALK OFF
	PRINTJOB
	=CABPRI1()
	SET ORDER TO TAG BASE IN BASE2
	SET ORDER TO TAG BASE IN BASE1
	SELE BASE2
	STORE .T. TO OK
	SCAN
		IF !XSEEK(BASE2.FIELD_BASE,"BASE1","BASE")
			? "FALTA BASE "
			?? BASE2.FIELD_BASE
			STORE .F. TO OK
		ENDIF
	ENDSCAN
	? LINEA
	IF OK
		? "NO HAY DIFERENCIAS EN CANTIDAD DE ARCHIVOS"
	ELSE
		? "FIN DE DIFERENCIAS DE ARCHIVOS"
	ENDIF
	? LINEA
	? "INICIO DE ANALISIS POR ARCHVO"
	? LINEA
	SET ORDER TO TAG CAMPO
	STORE 1 TO VEZ
	SCAN
		IF BASE2.FIELD_TYPE="B"
			?
			? LINEA
			? "BASE:"
			?? FIELD_NAME
			? LINEA
			STORE .T. TO M.OK
		ELSE
			IF !XSEEK(BASE2.FIELD_BASE+BASE2.FIELD_NAME,"BASE1","CAMPO")
				? "  -->"
				?? FIELD_NAME
				?? " - "
				?? FIELD_TYPE
				?? " - "
				?? STR(FIELD_LEN,3)
				?? ","
				?? STR(FIELD_DEC,3)
				STORE .F. TO M.OK
			ENDIF
		ENDIF
	ENDSCAN
	ENDPRINT
	=FINIMP()

RETURN .T.
