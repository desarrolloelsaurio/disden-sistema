IF FILE('INFORME.TXT')
	ERASE INFORME.TXT
ENDIF
FRESULTADO=FCREATE('INFORME.TXT')
=ADIR(PIPO,'OP*.prg')
LARGOR=ALEN(PIPO,1)
A=""
FOR PSC=1 TO LARGOR
	fuente=alltrim(PIPO[PSC,1])
	Frespaldo=fOPEN(FUENTE,0)
	COSA=""
	do while !feof(frespaldo)
		A=FGETS(FRESPALDO)
		if "IF ESOPEN" $ A
			NRO=STR(VAL(SUBSTR(A,AT(",",A)+1,RAT(",",A)-1)),3)
			A="ALIAS "+SUBSTR(A,LEN(A)-4,3)
			DO GRABA
		else
			IF "IIF" $ A
				POSS=AT(",",A)
				COSA=SUBSTR(A,POSS,1)
			ELSE
				IF 'SELE' $ A
					IF !('ON SELE' $ A)
						NRO=CHRTRAN(A,'SELECT ','')
						NRO=IIF(EMPTY(VAL(NRO)),STR(VAL(COSA),3),STR(VAL(NRO),3))
						A=ALLTRIM(FGETS(FRESPALDO))
						IF LEFT(A,3)='USE'
							DO GRABA
						ELSE
							A=ALLTRIM(FGETS(FRESPALDO))
							DO GRABA
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDdo
	? fclose(frespaldo)
	ENDF
	? FCLOSE(FRESULTADO)
	CLOSE ALL
	FRESULTADO=FOPEN('INFORME.TXT')
	STORE '' TO TEXTO
	LARGOR=0
	DO WHILE !FEOF(FRESULTADO)
		LARGOR=LARGOR+1
		DIME TEXTO[largor]
		TEXTO[LARGOR]=FGETS(FRESULTADO)
		? TEXTO[LARGOR]
	ENDDO
	=ASORT(TEXTO)
	IF FILE('INFORME.DOC')
		ERASE INFORME.DOC
	ENDIF
	? FCLOSE(FRESULTADO)
	FRESULTADO=Fcreate('INFORME.DOC')
	clea
	FOR X=1 TO largor
		IF !EMPTY(TEXTO[X])
			=FPUTS(FRESULTADO,TEXTO[X])
		ENDIF
		ENDFOR
		=FCLOSE(FRESULTADO)
	RETURN
	PROCEDURE GRABA
		APODO=ALLTRIM(SUBSTR(A,AT('ALIAS',A)+6))
		=FPUTS(FRESULTADO,NRO+' - '+APODO+' / '+FUENTE)
	RETURN
