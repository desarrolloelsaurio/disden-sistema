* ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : SEGURIC.PRG                              บ
* บ COMENTARIO    : INGRESO PASSWORD EN CASO DE MONOUSUARIOS บ
* ฬออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
* บ AUTOR      : GOYO REINER                                 บ
* บ FECHA      : 08-06-93                                    บ
* บ HORA       : 03:01:17am                                  บ
* บ COPYRIGHT  : 1993 by GREGORIO REINER                     บ
* ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
FUNCTION SEGURIC
	PARAMETERS DBF_FILE
	PRIVATE DBF_FILE, CUR_BUFF, CUR_COMP, CUR_WIN, RVALUE
	RVALUE=9
	CUR_BUFF=SELE()
	CUR_WIN=WOUTPUT()
	CAN_PAR=PARAMETER()
	=MOVEWIN(10,20,18,60,'PASS_WIN','SU PASSWORD')
	IF EMPTY(CAN_PAR)
		IF FILE("F:\PUBLIC\MONDAY.PAS")
			DBF_FILE="F:\PUBLIC\MONDAY.PAS"
		ELSE
		   IF FILE("C:\PUBLIC\MONDAY.PAS")
					DBF_FILE="C:\PUBLIC\MONDAY.PAS"
				ELSE
			DBF_FILE="\PUBLIC\MONDAY.PAS"
			ENDIF
		ENDIF
	ENDIF
	IF !FILE(DBF_FILE)
		QUIT
	ELSE
	   RVALUE=CHK_PASS()
	ENDIF
	USE
	=RELEWIN("PASS_WIN")
	SELE(CUR_BUFF)
	IF EMPTY(CUR_WIN)
		ACTIVATE SCREEN
	ENDIF
RETURN RVALUE
********
PROCEDURE CHK_PASS
	PRIVATE PASSWORD, PASS_COUNT
	SELE 0
	USE (DBF_FILE) ALIAS PASSWORD EXCL
	INDEX ON CODEB TAG PASSWORD
	INDEX ON CODEB TAG CODEB
	SET ORDER TO TAG PASSWORD
	M.PASSWORD=ENCRYPT(PASSWORD(6),2)
	IF SEEK(M.PASSWORD)
		USER_NO=RECNO()
		POSA=VAL(SUBST(DECODE(CODEA,USER_NO+2),5,1))
		USN=DECODE(FIRST_NAME,USER_NO+1)
		USE
	ELSE
		QUIT
	ENDIF
RETURN POSA
