*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        11/02/95             QW_REB.PRG                08:52:52 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1995 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("fic") ;
	OR UPPER(WTITLE("FIC")) == "FIC.PJX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.SCX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.MNX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.PRG" ;
	OR UPPER(WTITLE("FIC")) == "FIC.FRX" ;
	OR UPPER(WTITLE("FIC")) == "FIC.QPR"
	DEFINE WINDOW fic ;
		FROM INT((SROW()-6)/2),INT((SCOL()-40)/2) ;
		TO INT((SROW()-6)/2)+5,INT((SCOL()-40)/2)+39 ;
		TITLE " L죑ites de los Recibos " ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		DOUBLE ;
		COLOR SCHEME 1
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      QW_REB/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("fic")
	ACTIVATE WINDOW fic SAME
ELSE
	ACTIVATE WINDOW fic NOSHOW
ENDIF
@ 1,1 SAY "N Recibo Inicial" ;
	SIZE 1,17, 0
@ 2,1 SAY "N Recibo Final" ;
	SIZE 1,15, 0
@ 1,22 GET m.recini ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	MESSAGE "N de Recibo Final - [ESC] Anula"
@ 2,22 GET m.recfin ;
	SIZE 1,8 ;
	DEFAULT 0 ;
	PICTURE "99999999" ;
	WHEN last()#27 .and. !empty(m.recini) ;
	VALID _r4z0j1a7a() ;
	MESSAGE "N de Recibo Final - [ENTER] Igual al Inicial - [ESC] Anula"

IF NOT WVISIBLE("fic")
	ACTIVATE WINDOW fic
ENDIF

READ

RELEASE WINDOW fic

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      QW_REB/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF LAST()=27 .OR. ;
   (EMPTY(M.RECINI) .AND. EMPTY(M.RECFIN)) .OR. ;
   M.RECFIN<M.RECINI
   STORE "" TO QUEREC
   STORE 1 TO FILREC
   QW_SALIDA=.F.
ELSE
   IF M.RECINI#M.RECFIN
      STORE 2 TO FILREC
      M.RECINI=Q_FAC(" "+SUCU+"-"+ALLTRIM(STR(M.RECINI)))
      M.RECFIN=Q_FAC(" "+SUCU+"-"+ALLTRIM(STR(M.RECFIN)))
      STORE "CAJ.NUMERE>='"+M.RECINI+"' .AND. CAJ.NUMERE<='"+M.RECFIN+"'" TO QUEREC
   ENDIF
   QW_SALIDA=.T.
ENDIF
RETURN QW_SALIDA

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R4Z0J1A7A           m.recfin VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QW_REB,     Record Number:    5    
*        Variable:            m.recfin                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r4z0j1a7a     &&  m.recfin VALID
#REGION 1
if last()#27
   m.recfin=iif(empty(m.recfin),m.recini,m.recfin)
   show gets
endif
return .t.