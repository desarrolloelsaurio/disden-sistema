*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        09/23/95              IFACD.PRG                19:11:43 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        GREGORIO REINER                                         
*                                                                
*        Copyright (c) 1995 GOYO REINER                          
*        MITRE 1480 '4' B                                       
*        ROSARIO, SF  2000                                       
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS tipopec, abre,abr,abr1,tit_sin,tit_pl,solover

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                  IFACD/MS-DOS Setup Code - SECTION 1           
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
DECL fechas[6], montocuot[6]
STORE HORA_ULP(PROGRAM()) to ULPR
IF CHEQSEG()
** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
#DEFINE ABA    "Abriendo Base de "               && ABA
#DEFINE NUL    0                                 && NUL
#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
#DEFINE PAIP   "|"                               && PAIP
#DEFINE FOLC  ".F."                              && FOLC
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
#DEFINE FOLL  .F.                                && FOLL
#DEFINE TRUC  ".T."                              && TRUC
#DEFINE TRUL  .T.                                && TRUL
#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
#DEFINE ELYES  "SI"                              && ELYES
#DEFINE ELNOU  "NO"                              && ELNOU
#DEFINE ONE    1                                 && ONE
#DEFINE TWO    2                                 && TWO
#DEFINE THREE  3                                 && THREE
#DEFINE FOUR   4                                 && FOUR
#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
#DEFINE RH      36 								 && RH
#DEFINE RP 		47 								 && RP
#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE

** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end

   STORE .T. TO HAYFACTURA,CAMBIO,M.INGRESO
   STORE "" TO PAANULAR,TEXTO
   STORE NUL TO fechas,montocuot,fec,nad
   STORE NUL TO IVA1,IVA2,IVA3
   STORE NUL TO CANTCUOTAS,DIASALTO,DIASINI
   RELE MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD
   RELE MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
   PUBL MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD
   PUBL MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
   IF SOLOVER
      SELE CCG
   ENDIF
   SELE FAR
   IF SOLOVER
      SCAT MEMV
   ELSE
      SCAT MEMV BLAN
      SCAT TO RESPALDO BLAN
   ENDIF
   SELE PER
   IF SOLOVER
      SCAT MEMV
   ELSE
      SCAT MEMV BLAN
      =CARGA_IFACD()
   ENDIF


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("win2",	INT((SROW()-22)/2), INT((SCOL()-79)/2), INT((SROW()-22)/2)+21, INT((SCOL()-79)/2)+78, ;
 ' '+tit_sin+' de Proveedores '		,' '+JANNAME+' ')		


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      IFACD/MS-DOS Screen Layout                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("win2")
	ACTIVATE WINDOW win2 SAME
ELSE
	ACTIVATE WINDOW win2 NOSHOW
ENDIF
@ 5,1 SAY 'N de '+tit_sin ;
	SIZE 1,22
@ 13,1 SAY PADR(ALLTRIM(XACI[1]),20) ;
	SIZE 1,22 ;
	PICTURE "@!"
@ 14,1 SAY PADR(ALLTRIM(XACI[2]),20) ;
	SIZE 1,22 ;
	PICTURE "@!"
@ 10,38 SAY PADR(ALLTRIM(XACI[3]),20) ;
	SIZE 1,22 ;
	PICTURE "@!"
@ 12,23 SAY ":" ;
	SIZE 1,1, 0
@ 12,1 SAY "Neto Gravado" ;
	SIZE 1,12, 0
@ 14,23 SAY ":" ;
	SIZE 1,1, 0
@ 10,60 SAY ":" ;
	SIZE 1,1, 0
@ 11,60 SAY ":" ;
	SIZE 1,1, 0
@ 12,60 SAY ":" ;
	SIZE 1,1, 0
@ 5,23 SAY ":" ;
	SIZE 1,1, 0
@ 5,43 SAY "Fecha" ;
	SIZE 1,5, 0
@ 5,50 SAY ":" ;
	SIZE 1,1, 0
@ 6,1 SAY "Condici줻 de Pago     :" ;
	SIZE 1,23, 0
@ 10,1 SAY "Monto" ;
	SIZE 1,5, 0
@ 10,23 SAY ":" ;
	SIZE 1,1, 0
@ 11,1 SAY "Descuento" ;
	SIZE 1,9, 0
@ 11,23 SAY ":" ;
	SIZE 1,1, 0
@ 13,23 SAY ":" ;
	SIZE 1,1, 0
@ 11,38 SAY "Exento" ;
	SIZE 1,6, 0
@ 12,38 SAY "Recargo Financiero" ;
	SIZE 1,18, 0
@ 13,38 SAY "Percepci줻" ;
	SIZE 1,10, 0
@ 13,60 SAY ":" ;
	SIZE 1,1, 0
@ 14,60 SAY ":" ;
	SIZE 1,1, 0
@ 1,1 SAY "Proveedor" ;
	SIZE 1,9, 0
@ 7,1 SAY "Imputaci줻" ;
	SIZE 1,10, 0
@ 7,23 SAY ":" ;
	SIZE 1,1, 0
@ 8,1 SAY "Moneda" ;
	SIZE 1,6, 0
@ 8,23 SAY ":" ;
	SIZE 1,1, 0
@ 1,11 GET m.PROCOD ;
	SIZE 1,10 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN _r3v1555b2() ;
	VALID _r3v1555dc() ;
	MESSAGE "Ingrese Cliente"+TEX_EFES	 ;
	ERROR "PROVEEDOR INEXISTENTE"
@ 1,25 SAY M.CLIENTE ;
	SIZE 1,30 ;
	PICTURE "@!"
@ 2,11 SAY M.domicilio ;
	SIZE 1,30 ;
	PICTURE "@!"
@ 2,43 SAY IIF(EMPTY(M.LOCALIDAD),"",SAYMIX(M.LOCALIDAD,"CIUCOD")) ;
	SIZE 1,20 ;
	PICTURE "@!"
@ 3,11 SAY IIF(EMPTY(M.CONDIVA),"",SAYMIX(M.CONDIVA,"IVACOD")) ;
	SIZE 1,22 ;
	PICTURE "@!"
@ 3,43 SAY PER.nroiva ;
	SIZE 1,15 ;
	PICTURE "@!"
@ 5,25 GET m.factura ;
	SIZE 1,14 ;
	DEFAULT " " ;
	PICTURE "A!!!!!!!!!!!!!" ;
	WHEN _r3v1555ig() ;
	VALID _r3v1555ki() ;
	MESSAGE "N DE "+UPPER(TIT_SIN) ;
	ERROR "DOCUMENTO EXISTENTE - POR FAVOR REVISE EL NUMERO"
@ 5,54 GET m.fechaem ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN LAST()#27 .and. HAYFACTURA
@ 6,25 GET M.condpago ;
	SIZE 1,2 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN _r3v1555nz() ;
	VALID _r3v1555pu() ;
	MESSAGE "Ingrese Condici줻 de Pago"+TEX_EFES	 ;
	ERROR "CONDICION DE PAGO NO EXISTE"
@ 6,37 SAY IIF(EMPTY(M.CONDPAGO),"",SAYMIX(M.CONDPAGO,"PAGCOD")) ;
	SIZE 1,25 ;
	PICTURE "@!"
@ 7,25 GET M.gasto ;
	SIZE 1,11 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN _r3v1555st() ;
	VALID _r3v1555us() ;
	MESSAGE "Ingrese Concepto de Imputaci줻"+TEX_EFES	 ;
	ERROR "CONCEPTO DE IMPUTACION NO EXISTE"
@ 7,37 SAY IIF(EMPTY(M.GASTO),"",SAYMIX(M.GASTO,"GASCOD")) ;
	SIZE 1,25 ;
	PICTURE "@!"
@ 8,25 GET m.MONEDA ;
	SIZE 1,11 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN OFF_F2() .AND. LAST()#27 .AND. !EMPTY(M.PROCOD) .AND. !EMPTY(M.CLIENTE) .AND. !EMPTY(M.FACTURA) ;
	VALID _r3v1555xv() ;
	MESSAGE "Moneda en que se emite "+UPPER(TIT_SIN) ;
	ERROR NOVACIO
@ 10,25 GET m.monto ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA ;
	VALID IFACD9() ;
	MESSAGE "MONTO BRUTO DE LA "+TIT_SIN
@ 11,25 GET m.descuento ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID _r3v15560f() ;
	MESSAGE "DESCUENTO SOBRE LA "+TIT_SIN
@ 12,25 SAY m.montobru ;
	SIZE 1,11 ;
	PICTURE "99,999,999.99"
@ 13,25 GET m.montoiva ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID IFACD9() ;
	MESSAGE "MONTO DEL "+ALLTRIM(XACI[1])
@ 14,25 GET m.montoot2 ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID IFACD9() ;
	MESSAGE "MONTO DEL "+ALLTRIM(XACI[2])
@ 10,62 GET m.montoot3 ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID IFACD9() ;
	MESSAGE "MONTO DEL "+ALLTRIM(XACI[3])
@ 11,62 GET m.montoexe ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID IFACD9() ;
	MESSAGE "MONTO EXENTO"
@ 12,62 GET m.MONTOREF ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID IFACD9() ;
	MESSAGE "MONTO DEL RECARGO FINANCIERO"
@ 13,62 GET m.MONTOper ;
	SIZE 1,11 ;
	DEFAULT 0 ;
	PICTURE "99,999,999.99" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID IFACD9() ;
	MESSAGE "MONTO DE LA PERCEPCION"
@ 14,38 SAY 'Total '+tit_sin ;
	SIZE 1,22
@ 14,62 SAY m.montoNET ;
	SIZE 1,11 ;
	PICTURE "99,999,999.99"
@ 16,1 SAY "Texto para la liquidaci줻" ;
	SIZE 1,25, 0
@ 16,28 GET m.lineliq ;
	SIZE 1,40 ;
	DEFAULT " " ;
	PICTURE "@x" ;
	WHEN LAST()#27 .and. HAYFACTURA .and. !empty(m.monto) ;
	VALID _r3v15566m() ;
	MESSAGE "Texto para la liquidaci줻" ;
	ERROR novacio
@ 18,10 GET M.SALE ;
	PICTURE "@*HN \<Confirma;\<Anula;\?\<Sale y No Graba" ;
	SIZE 1,17,1 ;
	DEFAULT 1 ;
	VALID _r3v1556ah()

IF NOT WVISIBLE("win2")
	ACTIVATE WINDOW win2
ENDIF

READ CYCLE ;
	SHOW _r3v1556k8()

=RELEWIN("win2")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       IFACD/MS-DOS Cleanup Code                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
UNLO ALL
*IF LAST()=27 .AND. EMPTY(M.PROCOD)
*   EXIT
*ENDIF
*ENDDO
   RELE MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD,MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO

ELSE
=IAUDI()
ENDIF
RETURN MEN_LIN(BOTOM)



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*           IFACD/MS-DOS Supporting Procedures and Functions     
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
FUNCTION CARGA_IFACD
SELE MIX
GO BOTT
SKIP
SCAT MEMV BLAN
SELE PER
GO BOTT
SKIP
SCAT MEMV BLAN
SELE FAR
SCAT MEMV BLAN
      STORE .T. TO HAYFACTURA
      STORE "" TO LACIUDA,ELIVA,PAANULAR,TEXTO,LACONDICIO,ELGASTO,GASTO
      STORE NUL TO fechas,montocuot,fec,nad,LASCUOTAS
RETURN .T.

function ifacd9
m.montonet=m.montobru+m.montoiva+m.montoot2+m.montoot3+m.montoexe+m.montoref+m.montoper
m.montonet=round(m.montonet,2)
return sget("win2")

FUNCTION SOLOVER
IF TIT_PL="MUESTRA"
   WAIT "PULSE [ENTER] PARA SALIR" WIND
ELSE
   IF TIT_PL="BORRA"
      IF CONFIRMA("BORRAR Documento",.t.,10,0)
		SELE FAD
		=FLOCK("FAD") .OR. FLOK("FAD")
		=FLOCK("CCG") .OR. FLOK("CCG")
		=FLOCK("CCP") .OR. FLOK("CCP")
		=FLOCK("FAR") .OR. FLOK("FAR")
		DELETE FOR FACTURA=FAR.FACTURA .AND. PROCOD=FAR.PROCOD
		UNLO IN FAD
		SELE CCG
		DELE FOR COMPRRE=FAR.TIPO .AND. NUMERORE=FAR.FACTURA .AND. PROCOD=FAR.PROCOD
		UNLO IN CCG
		SELE CCP
		DELE FOR COMPR=FAR.TIPO+FAR.FACTURA .AND. PROCOD=FAR.PROCOD
		UNLO IN CCP
		SELE FAR
		DELE
		UNLO IN FAR
      ENDIF
   ENDIF
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555B2           m.PROCOD WHEN                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   31     
*        Variable:            m.PROCOD                           
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555b2     &&  m.PROCOD WHEN
#REGION 1
IF SOLOVER
   =SGET("WIN2")
   IF EMPTY(TIT_PL)
      TIT_PL="MUESTRA"
   ENDIF
   =SOLOVER()
   STORE .F. TO HAYFACTURA
   =RELEWIN("WIN2")
   RETURN
ENDIF
RETURN IIF(SOLOVER,.T.,PER_F2("M.PROCOD","P/"+UPPER(TIT_SIN),1,11,"PROCOD","PROVEEDO",1,25))

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555DC           m.PROCOD VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   31     
*        Variable:            m.PROCOD                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555dc     &&  m.PROCOD VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ELSE
   IF VALIDPER("PROCOD","M.PROCOD","PROCOD","WIN2","PROVEEDOR",.T.)
      SELE PER
      SCAT MEMV
      STORE 0 TO M.DESCUENTO
      IF xseek(PER.CONDIVA,'MIX','IVACOD')
         M.IVA1=MIX.NU1
         M.IVA2=MIX.NU2
         M.IVA3=MIX.NU3
         RETURN SGET("WIN2")
      ELSE
         =CARTEL("LA CONDICION DE I.V.A.",;
           "DEL PROVEEDOR NO ESTA ADECUADAMENTE INGRESADA",;
           "POR FAVOR, REVISELA Y REINTENTE",;
           "PULSE [ENTER] PARA CONTINUAR")
         CLEA READ
         RETURN .T.
      ENDIF
   ENDIF
ENDIF
RETURN .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555IG           m.factura WHEN                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   37     
*        Variable:            m.factura                          
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555ig     &&  m.factura WHEN
#REGION 1
IF LAST()=27
   RETURN .F.
ELSE
   STORE .T. TO HAYFACTURA
   ON KEY LABEL F2
   ON KEY LABEL F3
   RETURN SGET("WIN2")
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555KI           m.factura VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   37     
*        Variable:            m.factura                          
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555ki     &&  m.factura VALID
#REGION 1
M.FACTURA=Q_FAC(M.FACTURA)
IF LAST()=27 .OR. RIGHT(M.FACTURA,8)='00000000'
   STORE .F. TO HAYFACTURA
   RETURN .T.
ENDIF
IF SOLOVER
   IF XSEEK(M.FACTURA+M.PROCOD,'FAD','FACTURA')
      _CUROBJ=20
      RETURN SGET("WIN2")
   ENDIF
   RETURN .F.
ENDIF
RETURN SGET("WIN2") .AND. !XSEEK(M.FACTURA+M.PROCOD,'FAR','FACTURA')



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555NZ           M.condpago WHEN                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   39     
*        Variable:            M.condpago                         
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555nz     &&  M.condpago WHEN
#REGION 1
IF LAST()#27 .and. HAYFACTURA
   ON KEY LABEL F2 M.CONDPAGO=QUEPOPUP("DE "+UPPER(TIT_SIN),8,37)
   ON KEY LABEL F3 M.CONDPAGO=SEEKTECX(30,'MIX','TEXTO1','MIX.TEXTO1','TEXTO1',"","",8,37)
   RETURN .T.
ENDIF
RETURN .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555PU           M.condpago VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   39     
*        Variable:            M.condpago                         
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555pu     &&  M.condpago VALID
#REGION 1
IF XSEEK(M.CONDPAGO,'MIX','PAGCOD')
   CANTCUOTAS=MIX.NU1
   DIASALTO=MIX.NU5
   DIASINI=MIX.NU2
   RETURN SGET("WIN2")
ENDIF
RETURN LAST()=27


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555ST           M.gasto WHEN                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   41     
*        Variable:            M.gasto                            
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555st     &&  M.gasto WHEN
#REGION 1
IF LAST()#27 .and. HAYFACTURA
ON KEY LABEL F2 M.GASTO=QUEPOPUP("DE "+UPPER(TIT_SIN),8,37)
ON KEY LABEL F3 M.GASTO=SEEKTECX(30,'MIX','TEXTO1','MIX.TEXTO1','TEXTO1',"","",8,37)
RETURN .T.
ENDIF
RETURN .F.



*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555US           M.gasto VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   41     
*        Variable:            M.gasto                            
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555us     &&  M.gasto VALID
#REGION 1
IF XSEEK(M.GASTO,'MIX','GASCOD')
   M.ELGASTO=MIX.TEXTO1
   RETURN SGET("WIN2")
ENDIF
RETURN LAST()=27


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1555XV           m.MONEDA VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   43     
*        Variable:            m.MONEDA                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      9                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1555xv     &&  m.MONEDA VALID
#REGION 1
IF LAST()=27
   RETURN .T.
ENDIF
RETURN !EMPTY(M.MONEDA)

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V15560F           m.descuento VALID                  
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   45     
*        Variable:            m.descuento                        
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      10                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v15560f     &&  m.descuento VALID
#REGION 1
m.montobru=m.monto-m.descuento
m.hayfactura=(montobru>0)
IF M.HAYFACTURA
   STORE M.MONTOBRU*M.IVA1/100 TO M.MONTOIVA
   STORE M.MONTOBRU*M.IVA2/100 TO M.MONTOOT2
   STORE M.MONTOBRU*M.IVA3/100 TO M.MONTOOT3
ENDIF
RETURN IFACD9()


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V15566M           m.lineliq VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   56     
*        Variable:            m.lineliq                          
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      11                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v15566m     &&  m.lineliq VALID
#REGION 1
IF last()=27 .or. !empty(m.lineliq)
   RETURN .T.
ENDIF
IF LAST()#27 .and. ;
        sget("win2") .and. ;
        hayfactura .and. ;
        !empty(m.monto) .and. ;
        !empty(m.montoNET)
      dime fechas[m.cantcuotas],montocuot[m.cantcuotas],fec[m.cantcuotas],nad[m.cantcuotas]
      FOR A=1 TO m.cantcuotas
         STOR gomonth(fechaem+diasini,a-1) TO fechas[a]
      NEXT
      =q_cuot(M.MONTONET,.T.,10,20,55,15,2)
      for a=1 to M.cantcuotas
         fec[a]=fechas[a]
         nad[a]=montocuot[a]
      NEXT
      nada11=fec[a-1]
   ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1556AH           M.SALE VALID                       
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD,     Record Number:   57     
*        Variable:            M.SALE                             
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      12                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1556ah     &&  M.SALE VALID
#REGION 1
DO CASE
CASE M.SALE=3
   CLEA READ
CASE M.SALE=1
   IF !SOLOVER
      =ifacd9()
      IF LAST()#27 .AND. ;
           !EMPTY(M.PROCOD) .AND. ;
           !empty(m.monto) .AND. ;
           !EMPTY(M.MONTONET) .AND. ;
           !EMPTY(M.FACTURA) .AND. ;
           !EMPTY(M.CONDIVA) .AND. ;
           !EMPTY(M.GASTO) .AND. ;
           !EMPTY(M.LINELIQ)
         SELE ccp
         ************
         STORE M.CANTCUOTAS TO M.LASCUOTAS,M.NROCUOTAS
         dime fechas[m.lascuotas],montocuot[m.lascuotas],fec[m.lascuotas],nad[m.lascuotas]
         M.FECH1=M.FECHAEM+MIX.NU2
         FOR A=1 TO m.lascuotas
            FECHAS[A]=M.FECH1
            M.FECH1=M.FECH1+MIX.NU5
         NEXT
         =q_cuot(M.MONTONET,.T.,10,20,55,15,2,.T.)
         for a=1 to M.LASCUOTAS
            fec[a]=fechas[a]
            nad[a]=montocuot[a]
         NEXT
         nada11=fec[a-1]
         ************
         m.nada=m.procod
         m.nada1=m.moneda
         m.fechave=DATE()
         FOR I=1 TO m.CANTCUOTAS
            IF !EMPTY(fechas[i]) .AND. !EMPTY(montocuot[i])
               SCAT MEMV BLAN
               m.compr=ABRE+" "+m.factura
               m.procod=m.nada
               m.fechaop=m.fechaem
               m.detalle="Rec. "+ABR1+" N "+m.factura
               m.comprre=ABRE
               m.numerore=m.factura
               m.moneda=m.nada1
               m.fechave=fechas[i]
               IF TIPOPEC="NC"
                  m.monto=0-montocuot[i]
               ELSE
                  m.monto=montocuot[i]
               ENDIF
               m.equivale=m.monto / m.cotiz
               m.gascod=m.gasto
               m.concod=cns.concod
               =AGRABAR("CCP")
            ENDI
         NEXT
         M.tipo=ABRE
         m.concod=cns.concod
         IF TIPOPEC="NC"
            M.MONTO=0-M.MONTO
            M.DESCUENTO=0-M.DESCUENTO
            M.MONTOBRU=0-M.MONTOBRU
            M.MONTOIVA=0-M.MONTOIVA
            M.MONTOOT2=0-M.MONTOOT2
            M.MONTOOT3=0-M.MONTOOT3
            M.MONTOEXE=0-M.MONTOEXE
            M.MONTOREF=0-M.MONTOREF
            M.MONTOPER=0-M.MONTOPER
            M.MONTONET=0-M.MONTONET
         ENDIF
         =AGRABAR("FAR")
      ELSE
         =FALTADAT(TIT_SIN)
      ENDIF
      _CUROBJ=1
   ENDIF
ENDCASE
=CARGA_IFACD()
STORE "" TO fechas,montocuot,fec,nad
RETURN SGET("WIN2")


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3V1556K8           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         IFACD                              
*        Called By:           READ Statement                     
*        Snippet Number:      13                                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3v1556k8     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: IFACD
*
#REGION 1
IF SYS(2016) = "WIN2" OR SYS(2016) = "*"
	ACTIVATE WINDOW win2 SAME
	@ 1,25 SAY M.CLIENTE ;
		SIZE 1,30, 0 ;
		PICTURE "@!"
	@ 2,11 SAY M.domicilio ;
		SIZE 1,30, 0 ;
		PICTURE "@!"
	@ 2,43 SAY IIF(EMPTY(M.LOCALIDAD),"",SAYMIX(M.LOCALIDAD,"CIUCOD")) ;
		SIZE 1,20, 0 ;
		PICTURE "@!"
	@ 3,11 SAY IIF(EMPTY(M.CONDIVA),"",SAYMIX(M.CONDIVA,"IVACOD")) ;
		SIZE 1,22, 0 ;
		PICTURE "@!"
	@ 3,43 SAY PER.nroiva ;
		SIZE 1,15, 0 ;
		PICTURE "@!"
	@ 6,37 SAY IIF(EMPTY(M.CONDPAGO),"",SAYMIX(M.CONDPAGO,"PAGCOD")) ;
		SIZE 1,25, 0 ;
		PICTURE "@!"
	@ 7,37 SAY IIF(EMPTY(M.GASTO),"",SAYMIX(M.GASTO,"GASCOD")) ;
		SIZE 1,25, 0 ;
		PICTURE "@!"
	@ 12,25 SAY m.montobru ;
		SIZE 1,11, 0 ;
		PICTURE "99,999,999.99"
	@ 14,62 SAY m.montoNET ;
		SIZE 1,11, 0 ;
		PICTURE "99,999,999.99"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF