*       *********************************************************
*       *                                                         
*       * 23/09/2020            ELIFAC.PRG               18:19:53 
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (c) 2020 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This program was automatically generated by GENSCRN.    
*       *                                                         
*       *********************************************************

DO CASE
CASE _WINDOWS OR _MAC   && no MAC records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.rborder = SET("READBORDER")
	SET READBORDER ON
	
	*       *********************************************************
	*       *                                                         
	*       *               Windows Window definitions                
	*       *                                                         
	*       *********************************************************
	*
	
	IF NOT WEXIST("fic") ;
		OR UPPER(WTITLE("FIC")) == "FIC.PJX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.SCX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.MNX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.PRG" ;
		OR UPPER(WTITLE("FIC")) == "FIC.FRX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.QPR"
		DEFINE WINDOW fic ;
			AT  0.000, 0.000  ;
			SIZE 5.000,50.000 ;
			TITLE " BUSQUEDA DE FACTURAS " ;
			FONT "MS Sans Serif", 8 ;
			STYLE "B" ;
			NOFLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE
		MOVE WINDOW fic CENTER
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *          ELIFAC/Windows Setup Code - SECTION 2          
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	
	=OPFAC()
	STORE "" TO M.REMI
	#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
	
	
	*       *********************************************************
	*       *                                                         
	*       *              ELIFAC/Windows Screen Layout               
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	IF WVISIBLE("fic")
		ACTIVATE WINDOW fic SAME
	ELSE
		ACTIVATE WINDOW fic NOSHOW
	ENDIF
	@ 1.308,18.167 GET m.remi ;
		SIZE 1.154,22.800 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE REPL('!',14) ;
		VALID _5vb13agub() ;
		MESSAGE "Ingrese N§ de Factura a Procesar"
	@ 1.308,1.000 SAY "Nro de Factura :" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 0.000,40.000 GET M.OPCION ;
		PICTURE "@*VN \<OK;\<NO" ;
		SIZE 1.769,4.167,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _5vb13agv5()
	
	IF NOT WVISIBLE("fic")
		ACTIVATE WINDOW fic
	ENDIF
	
	READ CYCLE
	
	RELEASE WINDOW fic
	
	#REGION 0
	
	SET READBORDER &rborder
	
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *               ELIFAC/Windows Cleanup Code               
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	SELE FAC
	SET ORDER TO TAG FACTURA
	SET MESS TO LEFT(BOTOM,78)
	RETURN LAST()#27 .AND. ;
	RIGHT(M.REMI,8)#"00000000" .AND. ;
	SEEK(M.REMI)

CASE _DOS OR _UNIX      && no UNIX records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	*       *********************************************************
	*       *                                                         
	*       *                MS-DOS Window definitions                
	*       *                                                         
	*       *********************************************************
	*
	
	IF NOT WEXIST("fic") ;
		OR UPPER(WTITLE("FIC")) == "FIC.PJX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.SCX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.MNX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.PRG" ;
		OR UPPER(WTITLE("FIC")) == "FIC.FRX" ;
		OR UPPER(WTITLE("FIC")) == "FIC.QPR"
		DEFINE WINDOW fic ;
			FROM INT((SROW()-5)/2),INT((SCOL()-50)/2) ;
			TO INT((SROW()-5)/2)+4,INT((SCOL()-50)/2)+49 ;
			TITLE " BUSQUEDA DE FACTURAS " ;
			FOOTER ' '+JANNAME+' ' ;
			NOFLOAT ;
			NOCLOSE ;
			SHADOW ;
			NOMINIMIZE ;
			DOUBLE ;
			COLOR SCHEME 1
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *          ELIFAC/MS-DOS Setup Code - SECTION 2           
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	
	=OPFAC()
	STORE "" TO M.REMI
	#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
	
	
	*       *********************************************************
	*       *                                                         
	*       *               ELIFAC/MS-DOS Screen Layout               
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	IF WVISIBLE("fic")
		ACTIVATE WINDOW fic SAME
	ELSE
		ACTIVATE WINDOW fic NOSHOW
	ENDIF
	@ 1,18 GET m.remi ;
		SIZE 1,16 ;
		DEFAULT " " ;
		PICTURE REPL('!',14) ;
		VALID _5vb13agx5() ;
		MESSAGE "Ingrese N§ de Factura a Procesar"
	@ 1,1 SAY "N§ de Factura :" ;
		SIZE 1,15, 0
	@ 0,40 GET M.OPCION ;
		PICTURE "@*VN \<OK;\<NO" ;
		SIZE 1,4,1 ;
		DEFAULT 1 ;
		VALID _5vb13agxi()
	
	IF NOT WVISIBLE("fic")
		ACTIVATE WINDOW fic
	ENDIF
	
	READ CYCLE
	
	RELEASE WINDOW fic
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *               ELIFAC/MS-DOS Cleanup Code                
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	SELE FAC
	SET ORDER TO TAG FACTURA
	SET MESS TO LEFT(BOTOM,78)
	RETURN LAST()#27 .AND. ;
	RIGHT(M.REMI,8)#"00000000" .AND. ;
	SEEK(M.REMI)

ENDCASE


*       *********************************************************
*       *                                                         
*       * _5VB13AGUB           m.remi VALID                       
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         ELIFAC,     Record Number:    2    
*       * Variable:            m.remi                             
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      1                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _5vb13agub     &&  m.remi VALID
#REGION 1
M.NETO=ALLTRIM(M.REMI)
M.ULTI=RIGHT(M.NETO,1)
SUCUC=SUCU
do case
case LEFT(M.NETO,1)="R" .OR. ;
     LEFT(M.NETO,1)="r"
   M.REMI=ALLTRIM(Q_FAC("R1-"+SUBSTR(M.REMI,2)))
   M.REMI=IIF(ISDIGIT(M.ULTI),M.REMI,M.REMI+M.ULTI)
case LEFT(M.NETO,1)="M" .OR. ;
        LEFT(M.NETO,1)="m"
      M.REMI=ALLTRIM(Q_FAC("M0-"+SUBSTR(M.REMI,2)))
      M.REMI=IIF(ISDIGIT(M.ULTI),M.REMI,M.REMI+M.ULTI)
case !ISDIGIT(M.ULTI)
         IF LEFT(M.NETO,2)="0-"
            FIN=AT(M.ULTI,M.NETO)
            LARGO=FIN-3
            M.REMI=" 0000-"+ZERO(VAL(SUBSTR(M.NETO,3,LARGO)),8)+M.ULTI
         ELSE
            m.remi=q_fac(alltrim(SUCUC+"-"+SINULT(ALLTRIM(m.remi))))+M.ULTI
         ENDIF
otherwise
         m.remi=q_fac(alltrim(m.remi))
endcase
return sget("fic")


*       *********************************************************
*       *                                                         
*       * _5VB13AGV5           M.OPCION VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         ELIFAC,     Record Number:    4    
*       * Variable:            M.OPCION                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      2                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _5vb13agv5     &&  M.OPCION VALID
#REGION 1
IF M.OPCION#1 .OR. LAST()=27
   STORE "00000000" TO M.REMI
ENDIF
CLEA READ
RETURN .T.

*       *********************************************************
*       *                                                         
*       * _5VB13AGX5           m.remi VALID                       
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         ELIFAC,     Record Number:    8    
*       * Variable:            m.remi                             
*       * Called By:           VALID Clause                       
*       * Object Type:         Field                              
*       * Snippet Number:      3                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _5vb13agx5     &&  m.remi VALID
#REGION 1
M.NETO=ALLTRIM(M.REMI)
M.ULTI=RIGHT(M.NETO,1)
SUCUC=SUCU
do case
case LEFT(M.NETO,1)="R" .OR. ;
     LEFT(M.NETO,1)="r"
   M.REMI=ALLTRIM(Q_FAC("R1-"+SUBSTR(M.REMI,2)))
   M.REMI=IIF(ISDIGIT(M.ULTI),M.REMI,M.REMI+M.ULTI)
case LEFT(M.NETO,1)="M" .OR. ;
        LEFT(M.NETO,1)="m"
      M.REMI=ALLTRIM(Q_FAC("M0-"+SUBSTR(M.REMI,2)))
      M.REMI=IIF(ISDIGIT(M.ULTI),M.REMI,M.REMI+M.ULTI)
case !ISDIGIT(M.ULTI)
         IF LEFT(M.NETO,2)="0-"
            FIN=AT(M.ULTI,M.NETO)
            LARGO=FIN-3
            M.REMI=" 0000-"+ZERO(VAL(SUBSTR(M.NETO,3,LARGO)),8)+M.ULTI
         ELSE
            m.remi=q_fac(alltrim(SUCUC+"-"+SINULT(ALLTRIM(m.remi))))+M.ULTI
         ENDIF
otherwise
         m.remi=q_fac(alltrim(m.remi))
endcase
return sget("fic")


*       *********************************************************
*       *                                                         
*       * _5VB13AGXI           M.OPCION VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         ELIFAC,     Record Number:   10    
*       * Variable:            M.OPCION                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      4                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _5vb13agxi     &&  M.OPCION VALID
#REGION 1
IF M.OPCION#1 .OR. LAST()=27
   STORE "00000000" TO M.REMI
ENDIF
CLEA READ
RETURN .T.