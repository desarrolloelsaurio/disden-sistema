********************************************************************************
*-- Programa: LFACIY.PRG
*-- Fecha   : 06-02-92 04:26am
*-- Version : G. REINER
*-- Notas   : LISTADO DE MERCADERIA VENDIDA
*-- Modificaci¢n GOYO 07-01-92 07:28pm / adaptaci¢n Listado LFACPO
*-- Modificaci¢n GOYO 14/8/92 / adaptacion def. NOVOGAR
********************************************************************************
STORE HORA_ULP(PROGRAM()) TO ULPR
=CHEQSEG()
CCS=GENTMP()
=LFACPO(CCS)
SELE LIS
STOR NUL TO CASOS,TC,TP
LARGOR1=iif(filart=1,20,iif(filart=2,41,20))
TEXTO1=IIF(FILART=1,'ARTICULO',IIF(FILART=2,'RUBRO-SUBRUBRO','RUBRO'))
SALIDA=IIF(FILART=1,PAIP+SPACE(30)+PAIP+SPACE(10)+PAIP,PAIP)
acla=paip+padc(TEXTO1,LARGOR1)+PAIP
IF FILART=1
	ACLA=ACLA+PADC("DESCRIPCION",30)+PAIP+PADC("MARCA",10)+PAIP
ENDIF
ACLA=ACLA+PADC("CANTIDAD",10)+PAIP+PADC("MONTO",14)+PAIP
LINEA=REPL("=",LEN(ACLA))
pag=1
TT='Ranking de Productos'+TT
=UNWORK()
STOR NUL TO CASOS
=CABPRI()
_PCOPIES=1
PRINTJOB
=CABPRI1()
=TIT_LIN(3)
SCAN
	IF _PLINENO>63
		=FIN_LIN(3,CASOS,PAIP+PADR("TOTAL",LARGOR1)+SALIDA+STR(TC,10)+PAIP+STR(TP,14,2)+PAIP)
		=cabpri1()
		=TIT_LIN(4)
	ENDIF
	? PAIP
	IF FILART=1
		=XSEEK(LIS.MERCA,'MER','ARTICULO')
		?? lis.MERCA
		?? PAIP
		?? mer.merca
		?? PAIP
		?? left(MI1.TEXTO1,10)
	ELSE
		RUVRO=STR(VAL(LEFT(LIS.MERCA,3)))
		=XSEEK(RUVRO,'RUB','CODRUB')
		NADA=RUB.RUBRO
		IF FILART=2
			SUBVR=STR(VAL(SUBSTR(LIS.MERCA,5,3)))
			=XSEEK(RUVRO+SUBVR,'RUB','TODOS')
			NADA=NADA+'/'+RUB.RUBRO
		ENDIF
		?? NADA
	ENDIF
	?? PAIP
	?? STR(LIS.CANTIDAD,10)
	TC=TC+LIS.CANTIDAD
	?? PAIP
	?? STR(LIS.MONTO,14,2)
	TP=TP+LIS.MONTO
	?? PAIP
ENDSCAN
=FIN_LIN(4,CASOS,PAIP+PADR("TOTAL",LARGOR1)+SALIDA+STR(TC,10)+PAIP+STR(TP,14,2)+PAIP)
ENDP
=FINIMP()
=IAUD(FISC)
=REOPFAC()
RETURN MEN_LIN(BOTOM)
