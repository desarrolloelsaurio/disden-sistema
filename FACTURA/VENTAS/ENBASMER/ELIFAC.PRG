*       *********************************************************
*       *                                                         
*       * 28/02/95             ELIFAC.PRG                19:02:11 
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (c) 1995 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This program was automatically generated by GENSCRN.    
*       *                                                         
*       *********************************************************

DO CASE
CASE _WINDOWS OR _MAC   && no MAC records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.rborder = SET("READBORDER")
	SET READBORDER ON
	
	*       *********************************************************
	*       *                                                         
	*       *               Windows Window definitions                
	*       *                                                         
	*       *********************************************************
	*
	
	IF NOT WEXIST("fac") ;
		OR UPPER(WTITLE("FAC")) == "FAC.PJX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.SCX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.MNX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.PRG" ;
		OR UPPER(WTITLE("FAC")) == "FAC.FRX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.QPR"
		DEFINE WINDOW fac ;
			AT  0.000, 0.000  ;
			SIZE 5.154,96.400 ;
			TITLE " Selección de Facturas " ;
			FONT "MS Sans Serif", 8 ;
			FLOAT ;
			NOCLOSE ;
			MINIMIZE ;
			SYSTEM ;
			COLOR RGB(,,,0,0,255)
		MOVE WINDOW fac CENTER
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *          ELIFAC/Windows Setup Code - SECTION 2          
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	store .f. to respuesta
	
	*       *********************************************************
	*       *                                                         
	*       *              ELIFAC/Windows Screen Layout               
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	IF WVISIBLE("fac")
		ACTIVATE WINDOW fac SAME
	ELSE
		ACTIVATE WINDOW fac NOSHOW
	ENDIF
	@ 1.308,2.400 SAY "FACTURA" ;
		FONT "Arial", 16 ;
		STYLE "BT" ;
		COLOR RGB(255,255,255,,,,)
	@ 1.308,24.400 GET M.LAFAC ;
		SIZE 0.960,22.400 ;
		DEFAULT " " ;
		FONT "Arial", 16 ;
		STYLE "BI" ;
		PICTURE "@K" ;
		COLOR ,RGB(255,255,255,0,0,255)
	@ 0.923,74.400 GET m.opcion ;
		PICTURE "@*BHN " + ;
			(LOCFILE("\windows\bmp\face03.ico","BMP|ICO|PCT|ICN","Where is face03?")) + ";" + ;
			(LOCFILE("\windows\bmp\25.ico","BMP|ICO|PCT|ICN","Where is 25?")) ;
		SIZE 2.923,7.600,0.800 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		VALID _qy414svel()
	
	IF NOT WVISIBLE("fac")
		ACTIVATE WINDOW fac
	ENDIF
	
	READ CYCLE
	
	RELEASE WINDOW fac
	
	#REGION 0
	
	SET READBORDER &rborder
	
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *               ELIFAC/Windows Cleanup Code               
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	return respuesta

CASE _DOS OR _UNIX      && no UNIX records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	*       *********************************************************
	*       *                                                         
	*       *                MS-DOS Window definitions                
	*       *                                                         
	*       *********************************************************
	*
	
	IF NOT WEXIST("fac") ;
		OR UPPER(WTITLE("FAC")) == "FAC.PJX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.SCX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.MNX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.PRG" ;
		OR UPPER(WTITLE("FAC")) == "FAC.FRX" ;
		OR UPPER(WTITLE("FAC")) == "FAC.QPR"
		DEFINE WINDOW fac ;
			FROM INT((SROW()-5)/2),INT((SCOL()-41)/2) ;
			TO INT((SROW()-5)/2)+4,INT((SCOL()-41)/2)+40 ;
			TITLE " Selecci¢n de Facturas " ;
			FOOTER ' '+JANNAME+' ' ;
			FLOAT ;
			NOCLOSE ;
			MINIMIZE ;
			DOUBLE ;
			COLOR SCHEME 1
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *          ELIFAC/MS-DOS Setup Code - SECTION 2           
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	
	store .f. to respuesta
	
	*       *********************************************************
	*       *                                                         
	*       *               ELIFAC/MS-DOS Screen Layout               
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	IF WVISIBLE("fac")
		ACTIVATE WINDOW fac SAME
	ELSE
		ACTIVATE WINDOW fac NOSHOW
	ENDIF
	@ 1,2 SAY "FACTURA" ;
		SIZE 1,7, 0
	@ 1,11 GET M.LAFAC ;
		SIZE 1,17 ;
		DEFAULT " " ;
		PICTURE "@K"
	@ 0,30 GET m.opcion ;
		PICTURE "@*VN \!\<OK;\?\<NO" ;
		SIZE 1,6,1 ;
		DEFAULT 1 ;
		VALID _qy414sw0u()
	
	IF NOT WVISIBLE("fac")
		ACTIVATE WINDOW fac
	ENDIF
	
	READ CYCLE
	
	RELEASE WINDOW fac
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       *********************************************************
	*       *                                                         
	*       *               ELIFAC/MS-DOS Cleanup Code                
	*       *                                                         
	*       *********************************************************
	*
	
	#REGION 1
	return respuesta

ENDCASE


*       *********************************************************
*       *                                                         
*       * _QY414SVEL           m.opcion VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       Windows                            
*       * From Screen:         ELIFAC,     Record Number:    8    
*       * Variable:            m.opcion                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      1                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qy414svel     &&  m.opcion VALID
#REGION 1
if !empty(m.lafac)
m.lafac=q_fac(m.lafac)
=SGET("FAC")
if xseek(m.lafac,"fac","factura")
   =XSEEK(FAC.FACTURA,"FAX","FACTURA")
   store .t. to respuesta
endif
endif
clea read
return .t.

*       *********************************************************
*       *                                                         
*       * _QY414SW0U           m.opcion VALID                     
*       *                                                         
*       * Function Origin:                                        
*       *                                                         
*       * From Platform:       MS-DOS                             
*       * From Screen:         ELIFAC,     Record Number:    4    
*       * Variable:            m.opcion                           
*       * Called By:           VALID Clause                       
*       * Object Type:         Push Button                        
*       * Snippet Number:      2                                  
*       *                                                         
*       *********************************************************
*
FUNCTION _qy414sw0u     &&  m.opcion VALID
#REGION 1
if !empty(m.lafac)
m.lafac=q_fac(m.lafac)
=SGET("FAC")
if xseek(m.lafac,"fac","factura")
   =XSEEK(FAC.FACTURA,"FAX","FACTURA")
   store .t. to respuesta
endif
endif
clea read
return .t.