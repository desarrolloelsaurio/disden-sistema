***********************************************************************
*-- Programa: LFAR.PRG
*-- Fecha   : 05-20-92 02:32am
*-- Version : G. REINER
*-- Notas   : DERIVA A LISTADOS DE FACTURAS, NOTAS DE DEBITO Y CREDITO
***********************************************************************
PARAMETER PORPAN
CANT_MAX=19
DIME TEXTO[CANT_MAX,2], VARIABLE[CANT_MAX], Habilitado[CANT_MAX],habilant[cant_max]
TEXTO[1,2] =14
TEXTO[2,2] =8
TEXTO[3,2] =8
TEXTO[4,2] =2
TEXTO[5,2] =20
TEXTO[6,2] =20
TEXTO[7,2] =20
TEXTO[8,2] =XACDIGI
TEXTO[9,2] =XACDIGI
TEXTO[10,2]=XACDIGI
TEXTO[11,2]=XACDIGI
TEXTO[12,2]=XACDIGI
TEXTO[13,2]=XACDIGI
TEXTO[14,2]=XACDIGI
TEXTO[15,2]=XACDIGI
TEXTO[16,2]=XACDIGI
TEXTO[17,2]=XACDIGI
TEXTO[18,2]=3
TEXTO[19,2]=5
TEXTO[1,1] =TIT_INVO
TEXTO[2,1] ='FECHA EMISION'
TEXTO[3,1] ='FECHA VENCIMIENTO'
TEXTO[4,1] ='TIPO COMPROBANTE'
TEXTO[5,1] ='PROVEEDOR'
TEXTO[6,1] ='CONDICION PAGO'
TEXTO[7,1] ='TIPO DE GASTO'
TEXTO[8,1] ='MONTO BRUTO'
TEXTO[9,1]='DESCUENTO'
TEXTO[10,1] ='NETO GRAVADO'
TEXTO[11,1]='MONTO '+XACI(1)
TEXTO[12,1]='MONTO '+XACI(2)
TEXTO[13,1]='MONTO '+XACI(3)
TEXTO[14,1] ='PERCEPCION'
TEXTO[15,1] ='EXENTO'
TEXTO[16,1] ='NO GRAVADO'
TEXTO[17,1]='MONTO TOTAL'
TEXTO[18,1]='MONEDA'
TEXTO[19,1]='MES'
STORE "" TO TTQUE
STORE .T. TO HABILITADO
STORE 1 TO FILEMP,FILFAC,FILPRO,FILFEC,FILGAS,FILPAG,FILMON,FILMER,FILVEN
FISC=''
DO WHILE QUERYFAR(PORPAN)
	IF FILMER#4
		IF FILFAC=3 .or. filfec=3 .OR. FILVEN=3 .OR. FILGAS=3 .OR. FILPRO=3 .OR. FILPAG=3
			=IIF(PORPAN,LFARPR(),LFARIR())
		ELSE
			=ACOPY(HABILITADO,HABILANT)
			DO WHILE CFGFAC() .AND. FILFAC#2
				=IIF(PORPAN,LFARPZ(),LFARIZ())
				STORE .F. TO VARIABLE
			ENDDO
			STORE .F. TO VARIABLE
			=ACOPY(HABILANT,HABILITADO)
		ENDIF
	ENDIF
	=off_tmp()
ENDDO
RETURN
