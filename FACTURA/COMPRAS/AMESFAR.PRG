*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        03/31/96             AMESFAR.PRG               16:31:11 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        GOYO REINER                                             
*                                                                
*        Copyright (c) 1996 GREGORIO REINER                      
*        MITRE 2480 4 B                                         
*        ROSARIO, SF  2000                                       
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("win") ;
	OR UPPER(WTITLE("WIN")) == "WIN.PJX" ;
	OR UPPER(WTITLE("WIN")) == "WIN.SCX" ;
	OR UPPER(WTITLE("WIN")) == "WIN.MNX" ;
	OR UPPER(WTITLE("WIN")) == "WIN.PRG" ;
	OR UPPER(WTITLE("WIN")) == "WIN.FRX" ;
	OR UPPER(WTITLE("WIN")) == "WIN.QPR"
	DEFINE WINDOW win ;
		FROM INT((SROW()-8)/2),INT((SCOL()-52)/2) ;
		TO INT((SROW()-8)/2)+7,INT((SCOL()-52)/2)+51 ;
		TITLE " Reabre MES de IVA " ;						
		FOOTER "-' '+janname+' '" ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		NOMINIMIZE ;
		DOUBLE ;
		COLOR SCHEME 1
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                 AMESFAR/MS-DOS Setup Code - SECTION 2          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
ULPR=HORA_ULP(PROGRAM())
IF CHEQSEG()
   SELE FAR
   =WORKING()
   =DOTALK()
   STORE "" TO MAXMES
   SCAN
      STORE IIF(RIGHT(FAR.ELMES,2)+STR(NUM_MES(LEFT(FAR.ELMES,3)))>MAXMES,FAR.ELMES,MAXMES) TO MAXMES
   ENDSCAN
   MAXMES=ABREV(QMES(VAL(STR(MAXMES,3))))+LEFT(MAXMES,2)
   =UNTALK()
   =UNWORK()
   IF SEEK(MAXMES)
      SET ORDER TO
      STORE FAR.MES TO ULTMES
      STORE SPACE(2) TO M.RESPUESTA


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     AMESFAR/MS-DOS Screen Layout               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("win")
	ACTIVATE WINDOW win SAME
ELSE
	ACTIVATE WINDOW win NOSHOW
ENDIF
@ 1,29 SAY QMES(LEFT(FAR.MES,3)) ;
	SIZE 1,20 ;
	PICTURE "-REPL('!',20)"
@ 1,1 SAY "Ultimo mes Cerrado :" ;
	SIZE 1,20, 0
@ 2,1 SAY "A쨚                :" ;
	SIZE 1,20, 0
@ 2,29 SAY val(right(FAR.MES,2)) ;
	SIZE 1,20 ;
	PICTURE "99"
@ 4,1 SAY "CONFIRMA REABRIR MES ?" ;
	SIZE 1,22, 0
@ 4,29 GET RESPUESTA ;
	SIZE 1,2 ;
	DEFAULT " " ;
	PICTURE "@M NO,SI" ;
	VALID _r970zeoxf() ;
	MESSAGE "CONFIRMA REABRIR ULTIMO MES DE IVA CERRADO ?" ;
	ERROR "LA REAPERTURA DEL MES NO HA SIDO REALIZADA"

IF NOT WVISIBLE("win")
	ACTIVATE WINDOW win
ENDIF

READ CYCLE

RELEASE WINDOW win

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      AMESFAR/MS-DOS Cleanup Code               
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
ELSE
=CARTEL("ERROR",;
"NO HA SIDO ENCONTRADO",;
"NINGUN MES DE IVA CERRADO",;
"IMPOSIBLE REABRIRLO")
ENDIF
ELSE
   =IAUDI()
ENDIF
SELE FAR
SET ORDER TO 1

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R970ZEOXF           RESPUESTA VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         AMESFAR,     Record Number:    7   
*        Variable:            RESPUESTA                          
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r970zeoxf     &&  RESPUESTA VALID
#REGION 1
IF M.RESPUESTA="SI"
   SET ORDER TO
   REPL MES WITH "" FOR ELMES=MAXMES
ENDIF
RETURN .T.