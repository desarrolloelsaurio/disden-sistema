* ษออออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : SAY_NUM.PRG          บ
* บ COMENTARIO    : NUMERO EN LETRAS     บ
* ฬออออออออออออออออออออออออออออออออออออออน
* บ COPYRIGHT  : 1994 by GREGORIO REINER บ
* ศออออออออออออออออออออออออออออออออออออออผ
FUNCTION SAY_NUM
PARAMETER UMERO
PRIVATE UMERO,CENTAVOS,CUERDA,DONDE,SALIDA,A,DIGITO,VECES,B,C_ERDA,UNIDAD,DECENA,CENTENA,FIN,POSIC
UMERO=IIF(TYPE("UMERO")#"N",VAL(UMERO),UMERO)
CUERDA=ALLTRIM(STR(UMERO,20,2))
*IF _WINDOWS
 *  DONDE=RAT(',',CUERDA)
*ELSE
DONDE=RAT('.',CUERDA)
*ENDIF
CENTAVOS=SUBSTR(CUERDA,DONDE+1)
CUERDA=LEFT(CUERDA,DONDE-1)
STOR '' TO FIN
VECES=CEIL(LEN(CUERDA)/3)
CUERDA=ZERO(VAL(CUERDA),VECES*3)
STORE VECES TO POSIC
FOR A=1 TO VECES
C_ERDA=LEFT(CUERDA,3)
CUERDA=SUBSTR(CUERDA,4)
FOR B=1 TO 3
CENTENA=VAL(LEFT(C_ERDA,1))
UNIDAD=VAL(RIGHT(C_ERDA,1))
DECENA=VAL(SUBSTR(C_ERDA,2,1))
SALIDA=CENTENA(CENTENA,DECENA,UNIDAD)
SALIDA=SALIDA+IIF(!EMPTY(DECENA),IIF(!EMPTY(CENTENA),'',' ')+DECENA(DECENA,UNIDAD),'')
SALIDA=SALIDA+IIF(EMPTY(SALIDA) .OR. DECENA<3 .OR. UNIDAD=0,'',' Y ')+IIF(DECENA#2 .AND. DECENA#1,UNIDAD(UNIDAD),'')
SALIDA=SALIDA+IIF(RIGHT(SALIDA,2)='UN'.AND. A=VECES,'O','')
ENDFOR
FIN=FIN+ALLTRIM(SALIDA)+IIF(POSIC=4 .AND. !EMPTY(SALIDA),' MIL ',IIF(POSIC=3 .AND. !EMPTY(SALIDA),' MILLONES ',IIF(POSIC=2 .AND. !EMPTY(SALIDA),' MIL ','')))
POSIC=POSIC-1
NEXT
IF !EMPTY(CENTAVOS)
   FIN=FIN+' CON '+ALLTRIM(CENTAVOS)+" CENTAVOS"
ENDIF
RETURN FIN
