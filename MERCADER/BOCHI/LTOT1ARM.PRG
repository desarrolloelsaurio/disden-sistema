procedure ltot1arm
PARA PORIMPRE
=OPMER()
=OPRUB()
store nul to respuesta
if !empty(elirub("a Consultar",-1,1))
	sele mer
	STORE {} TO M.FECINI,M.FECFIN
	IF ENTRE_FE("a Listar")
		=OPVEN()
		=OPFAC()
		=DOTALK()
		=WORKING()

		ELRUBRO = left(mix.texto2,3)
		SELECT SUM(FAX.TOTAL) AS MONTO, FAC.USUARIO, VEN.CODIGO, VEN.NOMBRE;
			FROM FAX, FAC, VEN, MER ;
			WHERE 	BETW(FAC.FECHAEM, M.FECINI, M.FECFIN) AND ;
					FAX.ARTICULO = MER.ARTICULO AND;
					MER.RUBRO    = ELRUBRO      AND;
					FAC.FACTURA  = FAX.FACTURA  AND;
					FAC.USUARIO  = VEN.NOMBRE   AND;
					VEN.TIPO     = "M" ;
			GROUP BY CODIGO INTO CURSOR LAME
		=UNWORK()
		=UNTALK()
		IF PORIMPRE
			REPORT FORM LTOT1ARM TO PRINT PROMPT NOCONSOLE
		ELSE
			REPORT FORM LTOT1ARM PREVIEW NOCONSOLE
		ENDIF
		USE IN LAME
	endif
endif
return