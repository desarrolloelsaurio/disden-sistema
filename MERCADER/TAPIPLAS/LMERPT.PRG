****************************************************************************
*-- PROGRAMA: LMERPT.PRG
*-- FECHA   : 11-01-92 05:39PM
*-- VERSION : G. REINER
*-- NOTAS   : LISTADO DE MERCADERIAS
*-- MODIFICACI¢N GOYO 05-29-92 00:45AM (REEMP ORDER TAG ORDMER POR ART¡CULO)
*-- VERSION TAPIPLAST - LISTADO GENERAL
********************************************************************************
STORE HORA_ULP(PROGRAM()) TO ULPR
IF CHEQSEG()
	STOR 1 TO CASOS,PAG,RUB1,SRUB1
	STOR "" TO ACLA,m.LINEA,TT
	=LMERP0()
	=WIN0()
	=CABPAN()
	=TIT_(1)
	=LP_P2()
	=_LIN(.T.)
	SCAN
		IF ROW()>21
			IF !FIN_LIN(1,NUL)
				EXIT
			ENDIF
			=LP_CHRUB()
			=LP_NPAGE()
		ELSE
			IF LP_CHRUB()
				IF !FIN_LIN(1,NUL)
					EXIT
				ENDIF
				=LP_NPAGE()
			ENDIF
		ENDIF
		=LMERP1()
	ENDSCAN
	=FIN_LIN(2,CASOS)
	=RELEWIN("WIN")
	=IAUD(FISC)
	=REOPMER()
ELSE
	=IAUDI()
ENDIF
=MEN_LIN(BOTOM)
RETURN
FUNCTION LP_P2
	_WRAP=.F.
	?
	? "RUBRO   :"
	?? RUB1
	? "SUBRUBRO:"
	?? SRUB1
	_WRAP=.T.
RETURN .T.
FUNCTION LP_CHRUB
	SALIDA=.T.
	IF LEFT(RUB.PALISTAR,20)#RUB1
		stor LEFT(RUB.PALISTAR,20) TO RUB1
		STOR RUB.RUBRO TO SRUB1
	ELSE
		IF RUB.RUBRO#SRUB1
			STOR RUB.RUBRO TO SRUB1
		ELSE
			SALIDA=.F.
		ENDIF
	ENDIF
RETURN SALIDA
FUNCTION LP_NPAGE
	CLEA
	STOR PAG+1 TO PAG
	=CABPAN()
	=TIT_(2)
	=LP_P2()
	=_LIN(.T.)
RETURN .T.
