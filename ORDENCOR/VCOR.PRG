*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        05/02/96              VCOR.PRG                 15:54:34 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        Author's Name                                           
*                                                                
*        Copyright (c) 1996 Company Name                         
*        Address                                                 
*        City,     Zip                                           
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS tiwin, decons, afuturo, solomues, sinreserva

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                   COR/MS-DOS Setup Code - SECTION 1            
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
#DEFINE ME1 'Ingreso de Ordenes de '+korte+' - '

RELE MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD, ;
		MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
PUBL MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD, ;
		MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
SELE COR
SCAT MEMV BLAN
SCAT TO RESPALDO BLAN
STORE .T. TO INGRESO
STORE .F. TO CAMBIO

#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

=MOVEWIX("cor", 5, 8 , 19,70 ,' '+TIWIN+' '		,' '+janname+' ')		

=MOVEWIX("corx", 19, 50 , 23,75 ,""		)	


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       COR/MS-DOS Screen Layout                 
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("cor")
	ACTIVATE WINDOW cor SAME
ELSE
	ACTIVATE WINDOW cor NOSHOW
ENDIF
@ 1,2 SAY "N즡ero" ;
	SIZE 1,6, 0
@ 5,2 SAY "Fecha Inicio" ;
	SIZE 1,12, 0
@ 2,2 SAY "Art죅ulo" ;
	SIZE 1,8, 0
@ 4,2 SAY "Estructura" ;
	SIZE 1,10, 0
@ 7,2 SAY "Final Previsto" ;
	SIZE 1,14, 0
@ 9,2 SAY "Nro Documento" ;
	SIZE 1,13, 0
@ 8,2 SAY "Fecha Finaliz." ;
	SIZE 1,14, 0
@ 10,2 SAY "Responsable" ;
	SIZE 1,11, 0
@ 6,2 SAY "Inicio Previsto" ;
	SIZE 1,15, 0
@ 1,19 GET m.numero ;
	SIZE 1,10 ;
	DEFAULT 0 ;
	WHEN _r7o0y3mmi() ;
	VALID _r7o0y3mqh() ;
	ERROR 'Orden de Corte '+ IIF(DECONS,'NO','') + ' EXISTE'
@ 2,19 GET m.articulo ;
	SIZE 1,15 ;
	DEFAULT " " ;
	PICTURE "@!K" ;
	WHEN INGRESO .AND. !DECONS .AND. !empty(m.numero) .and. GRL_F2("ARTICULO","a Incluir",2,18,40,"MER","MERCA","ARTICULO","MERCA",2,18) ;
	VALID _r7o0y3mu9() ;
	MESSAGE "Ingrese Art죅ulo"+tex_efes ;
	ERROR "ARTICULO INEXISTENTE"
@ 3,19 SAY IIF(!EMPTY(M.ARTICULO) .AND. XSEEK(M.ARTICULO,"MER","ARTICULO"),ALLTRIM(MER.MERCA),"") ;
	SIZE 1,40
@ 4,19 GET m.estruc ;
	SIZE 1,2 ;
	DEFAULT " " ;
	PICTURE "@!" ;
	WHEN _r7o0y3myo() ;
	VALID EMPTY(M.ESTRUC) .OR. LAST()=27 .OR. (XSEEK(M.ESTRUC,"MIX","TSTCOD") .AND. SGET('COR')) ;
	MESSAGE "Ingrese Estructura del Art죅ulo"+tex_efes ;
	ERROR "ESTRUCTURA INEXISTENTE"
@ 4,23 SAY IIF(EMPTY(M.ESTRUC), "",SAYMIX(M.ESTRUC,"TSTCOD")) ;
	SIZE 1,36
@ 5,19 SAY m.fechaini ;
	SIZE 1,8
@ 6,19 GET m.ftenin ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN _r7o0y3n2m() ;
	VALID _r7o0y3n4u() ;
	MESSAGE ME1+'Fecha de Iniciaci줻  Prevista '
@ 7,19 GET m.fechapre ;
	SIZE 1,8 ;
	DEFAULT {  /  /  } ;
	WHEN !DECONS .AND. EMPTY(FECHAFIN)
@ 8,19 SAY m.fechafin ;
	SIZE 1,8
@ 9,19 GET m.nrodocref ;
	SIZE 1,15 ;
	DEFAULT " " ;
	WHEN !DECONS .AND. INGRESO
@ 10,19 GET m.ordenado ;
	SIZE 1,10 ;
	DEFAULT " " ;
	WHEN !DECONS .AND. INGRESO
@ 11,19 SAY m.proceso ;
	SIZE 1,2
@ 11,2 SAY "Ultimo Proceso" ;
	SIZE 1,14, 0
@ 11,23 SAY IIF(EMPTY(M.PROCESO),"",SAYGRL(SAYGRL(ALLTRIM(M.ARTICULO)+"/"+M.ESTRUC+'  '+STR(M.PROCESO),"EST","HOJARUT","EST.PRC"),"PRC","PRCCOD","PRC.PROCFAB")) ;
	SIZE 1,25 ;
	PICTURE "@!"




*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                      DELAY/MS-DOS Screen Layout                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 2
IF WVISIBLE("corx")
	ACTIVATE WINDOW corx SAME
ELSE
	ACTIVATE WINDOW corx NOSHOW
ENDIF
@ 1,4 GET M.KOK ;
	PICTURE "@*HN \!\<OTRO;\?\<ADIOS" ;
	SIZE 1,7,1 ;
	DEFAULT 1 ;
	VALID _r7o0y3nct()

IF NOT WVISIBLE("corx")
	ACTIVATE WINDOW corx
ENDIF
IF NOT WVISIBLE("cor")
	ACTIVATE WINDOW cor
ENDIF


READ CYCLE ;
	SHOW _r7o0y3nbe()

=RELEWIN("cor")
=RELEWIN("corx")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3MMI           m.numero WHEN                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         COR,     Record Number:   11       
*        Variable:            m.numero                           
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3mmi     &&  m.numero WHEN
#REGION 1
IF SOLOMUES
	SCAT MEMVAR MEMO
	M.ARTICULO=M.ARTICULO+'/00'
	RETURN !SGET('COR')
ENDIF
SELE COR
SCAT MEMV BLAN
IF !DECONS
	M.NUMERO=GETDOC(IIF(AFUTURO,16,18))
ENDIF
RETURN SGET('COR')

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3MQH           m.numero VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         COR,     Record Number:   11       
*        Variable:            m.numero                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3mqh     &&  m.numero VALID
#REGION 1
M.INGRESO = !YAESTABA(M.NUMERO, IIF(AFUTURO,'COF','COR'), ;
			 'NUMERO',.F.,.F.,.F.)
IF !M.INGRESO
	SCAT MEMVAR MEMO
	SCAT TO RESPALDO MEMO
	WAIT "ORDEN DE CORTE EXISTENTE" WIND NOWA
ENDIF
RETURN SGET('COR')

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3MU9           m.articulo VALID                   
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         COR,     Record Number:   12       
*        Variable:            m.articulo                         
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3mu9     &&  m.articulo VALID
#REGION 1
IF EMPTY(M.ARTICULO)
	RETURN .T.
ENDIF
IF EMPTY(AT('/',M.ARTICULO))
	M.ARTICULO=M.ARTICULO+'/00'
ENDIF
IF XSEEK(M.ARTICULO,"MER","ARTICULO")
	RETURN SGET("COR")
ELSE
	M.ARTICULO=AJCODMER(M.ARTICULO)
	IF XSEEK(M.ARTICULO,"MER","ARTICULO")
		RETURN SGET("COR")
	ENDIF
ENDIF
RETURN .F.


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3MYO           m.estruc WHEN                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         COR,     Record Number:   14       
*        Variable:            m.estruc                           
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3myo     &&  m.estruc WHEN
#REGION 1
IF LAST()=27 .OR. DECONS .OR. ;
	EMPTY(M.NUMERO) .OR. !EMPTY(M.FECHAFAB) 	
	RETURN .F.
ENDIF
IF XSEEK(M.NUMERO, "CO1", "NUMERO")
	WAIT "ORDEN DE CORTE CON MERCADER좥" WIND NOWA
	RETURN .F.
ENDIF
=MIX_F2("M.ESTRUC","del Art죅ulo",4,18,"LEFT(MIX.TEXTO2,2)","TSTTEX",4,20)
RETURN SGET('COR')


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3N2M           m.ftenin WHEN                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         COR,     Record Number:   17       
*        Variable:            m.ftenin                           
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3n2m     &&  m.ftenin WHEN
#REGION 1
IF LAST()=27 .OR. DECONS .OR. !INGRESO
	RETURN .F.
ENDIF
M.FTENIN=DATE()
RETURN SGET("COR")

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3N4U           m.ftenin VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         COR,     Record Number:   17       
*        Variable:            m.ftenin                           
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3n4u     &&  m.ftenin VALID
#REGION 1
STORE m.ftenin+1 TO M.FECHAPRE
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3NCT           M.KOK VALID                        
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         DELAY,     Record Number:    2     
*        Variable:            M.KOK                              
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      7                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3nct     &&  M.KOK VALID
#REGION 2
DO CASE
CASE M.KOK=1
_CUROBJ=1
RETURN .T.
OTHERWISE
CLEA READ
ENDCASE
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R7O0Y3NBE           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         Multiple Screens                   
*        Called By:           READ Statement                     
*        Snippet Number:      8                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r7o0y3nbe     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: COR
*
#REGION 1
IF SYS(2016) = "COR" OR SYS(2016) = "*"
	ACTIVATE WINDOW cor SAME
	@ 3,19 SAY IIF(!EMPTY(M.ARTICULO) .AND. XSEEK(M.ARTICULO,"MER","ARTICULO"),ALLTRIM(MER.MERCA),"") ;
		SIZE 1,40, 0
	@ 4,23 SAY IIF(EMPTY(M.ESTRUC), "",SAYMIX(M.ESTRUC,"TSTCOD")) ;
		SIZE 1,36, 0
	@ 5,19 SAY m.fechaini ;
		SIZE 1,8, 0
	@ 8,19 SAY m.fechafin ;
		SIZE 1,8, 0
	@ 11,19 SAY m.proceso ;
		SIZE 1,2, 0
	@ 11,23 SAY IIF(EMPTY(M.PROCESO),"",SAYGRL(SAYGRL(ALLTRIM(M.ARTICULO)+"/"+M.ESTRUC+'  '+STR(M.PROCESO),"EST","HOJARUT","EST.PRC"),"PRC","PRCCOD","PRC.PROCFAB")) ;
		SIZE 1,25, 0 ;
		PICTURE "@!"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF