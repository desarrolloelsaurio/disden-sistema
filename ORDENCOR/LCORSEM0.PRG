FUNCTION LCORSEM0
	LINIMP=PAIP+STR(TMP.NUMERO,10)+PAIP+DTOC(COR.FECHAINI)+PAIP
	IF EMPTY(COR.FECHAFAB)
		LINIMP=LINIMP+SPACE(XACDIGI)+PAIP+SPACE(30)
	ELSE
		LINIMP=LINIMP+DTOC(TMP.SF)+PAIP+COR.ARTICULO+PAIP
		=XSEEK(TMP.NUMERO,"FAX","NUMTRU")
		LINIMP=LINIMP+STR(FAX.EEC,XACDIGI)+PAIP
		M.TOTAL=M.TOTAL+FAX.EEC
		SELE FAX
		STORE .F. TO OK
		SCAN FOR FAX.NUMERO=TMP.NUMERO .AND. ;
			TIPO="@"
			IF "CONF" $ SAYGRL(FAX.PRC,'PRC','PRCCOD',"PRC.PROCFAB")
				STORE .T. TO OK
				EXIT
			ENDIF
		ENDSCAN
		IF OK
			LINIMP=LINIMP+SAYGRL(FAX.TALLER,"PER","TALCOD","PER.CLIENTE")+PAIP
		ELSE
			LINIMP=LINIMP+SPACE(30)+PAIP
		ENDIF
	ENDIF
	CASOS=CASOS+1
	SELE TMP
RETURN LINIMP
