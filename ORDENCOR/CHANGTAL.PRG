#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
#DEFINE NUL    0                                 && NUL
PROCEDURE CHANGTAL
	=ADIR(ORDENES, PATH+"\XC??????.DBF")
	PUSH KEY CLEAR
	=MOVEWIN(10,0,21,79,"XXACTALLE"," Orden de Corte N§ "+alltrim(str(NROOCOR))+' ')
	ON KEY LABEL INS    DO REPLTAL
	ON KEY LABEL Ctrl+A WAIT ALLTRI(TALLER) WIND NOWAIT
	=MEN_LIN("[INS] POPUP DE TALLERES DE STOCK - [CTRL+A] DESCRIPCION DE TALLER DE PROD.")
	REPL AVIANT WITH '' ALL
	BROW FIEL TALLER:H='TAL.S/PRODUCCION':30,;
		TALCOD:H='TAL.S/COMPRAS':V=REPLALLTAL():E="No se Modific¢":20, ;
		ZA=LOOKUP(PER.CODCLI, OCO.TALCOD, PER.CODCLI, "CODCLI"):H='DESCRIP. COMPRAS':15, ;
		CANTIDAD:H='CANTIDAD':P='9999999.9999':12, ;
		MEDIDA:H='UNIDAD':5 ;
		FREEZE TALCOD IN WIND XXACTALLE NOMENU 
	=RELEWIN("XXACTALLE")
	=MEN_LIN(BOTOM)
	POP KEY
RETURN

PROCEDURE REPLTAL
	PUSH KEY CLEA
	IF !EMPTY(ELIPRO("C¢digo del Taller",-1,1))
		SELE OCO
		REPL TALCOD WITH PER.CODCLI
		=REPLALLTALI()
	ENDIF
	POP KEY
	=MEN_LIN(BOTOM)
RETURN

FUNCTION REPLALLTAL
	IF XSEEK(TALCOD, "PER", "CODCLI")
		WAIT ALLTRIM(TALLER)+" --> "+ALLTRIM(PER.CLIENTE) WIND NOWAIT
		IF CONFIRMA("C¢digo "+ALLTR(TALLER)+" --> "+ALLTR(PER.CODCLI), .T., 20, 30)
			M.TALLER = TALLER
			m.recant=recno()
			REPL TALCOD  WITH PER.CODCLI ALL
			=PRXAREA(.T.)
			NEWAREA=SELECT()
			FOR XI=1 TO ALEN(ORDENES,1)
				IF DBF("OCO")#(PATH+'\'+ORDENES[XI,1])
					SELE (NEWAREA)
					USE (PATH+'\'+ORDENES[XI,1]) 
					REPL TALCOD WITH PER.CODCLI FOR;
						M.TALLER = TALLER .AND. EMPTY(TALCOD)
				ENDIF
			NEXT
			USE IN (NEWAREA)
			SELE OCO
			go m.recant
		ENDIF
	ELSE
		WAIT " Taller Inexistente " WIND
	ENDIF
	SELE OCO
RETURN .T.

