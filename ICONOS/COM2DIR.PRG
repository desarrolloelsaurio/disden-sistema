FUNCTION COM2DIR
PARAMETER ELDIR,ELDNUE,NOCARGA
SET TALK OFF
SET SAFE OFF
DO WHILE .T.
STORE .F. TO UNAVUELTA
IF EMPTY(ELDIR)
ELDIR=GETD("","Directorio Existente")
CLEA
ELSE
STORE .T. TO  UNAVUELTA
ENDIF
IF EMPTY(ELDIR) .OR. LAST()=27
   EXIT
ENDIF
IF EMPTY(ELDNUE)
ELDNUE=GETD("","Iconos Nuevos")
CLEA
ELSE
STORE .T. TO  UNAVUELTA
ENDIF
IF EMPTY(ELDNUE) .OR. LAST()=27
   EXIT
ENDIF
IF !UNAVUELTA
STORE 0 TO M.BORRADO
ENDIF
IF ELDIR#ELDNUE
CANT=ADIR(PIPO,(ELDIR+"\*.ICO"))
IF !EMPTY(CANT)
IF NOCARGA
    WAIT "USANDO DATOS PASADA ANTERIOR" WIND NOWA
ELSE
CREATE CURSOR TEMPORAL ;
(ARCHIVO C(12),;
LARGO N(10),;
CONTENIDO M)
APPE FROM ARRAY PIPO
SCAN
         ICOA=fOPEN((ELDIR+"\"+ALLTRIM(ARCHIVO)),0)
         REPL CONTENIDO WITH fREAD(ICOA,LARGO)
         =FCLOSE(ICOA)
ENDSCAN
ENDIF
CANTNUE=ADIR(PINUE,(ELDNUE+"\*.ICO"))
IF !EMPTY(CANTNUE)
CREATE CURSOR TEMPONUE ;
(ARCHIVO C(12),;
LARGO N(10),;
CONTENIDO M)
APPE FROM ARRAY PINUE
SCAN
         ICOA=fOPEN((ELDNUE+"\"+ALLTRIM(ARCHIVO)),0)
         REPL CONTENIDO WITH fREAD(ICOA,LARGO)
         =FCLOSE(ICOA)
ENDSCAN
SELE TEMPORAL
SCAN FOR !EMPTY(ARCHIVO)
SELE TEMPONUE
SCAN FOR !EMPTY(ARCHIVO)
            IF TEMPORAL.LARGO=TEMPONUE.LARGO
                 IF TEMPORAL.CONTENIDO=TEMPONUE.CONTENIDO
               CLEA
          WAIT TEMPORAL.ARCHIVO+" ES IGUAL A "+TEMPONUE.ARCHIVO WIND NOWA
          @ 10,10 SAY (ELDIR+TEMPORAL.ARCHIVO) BITMAP
          @ 10,30 SAY (ELDNUE+TEMPONUE.ARCHIVO) BITMAP          
          @ 13,1 SAY ELDIR+TEMPORAL.ARCHIVO          
          @ 13,40 SAY ELDNUE+TEMPONUE.ARCHIVO
               ERASE (ELDNUE+TEMPONUE.ARCHIVO) 
               REPL TEMPONUE.ARCHIVO WITH " "
               STORE BORRADO+1 TO BORRADO
               WAIT STR(BORRADO)+" ICONOS BORRADOS" WIND NOWA               
     ENDIF
ENDIF
ENDSCAN
SELE TEMPORAL
ENDSCAN
ENDIF
WAIT STR(BORRADO)+"ICONOS BORRADOS" WIND NOWA               
ENDIF
ENDIF
IF UNAVUELTA
    EXIT
ELSE
    CLOSE ALL
    CLOSE DATA
ENDIF
ENDDO
RETURN