*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є 09/23/95            IDEB_FLY.PRG               19:11:21 є
*       є                                                         є
*       ЗДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД¶
*       є                                                         є
*       є GREGORIO REINER                                         є
*       є                                                         є
*       є Copyright (c) 1995 GOYO REINER                          є
*       є MITRE 1480 '4' B§                                       є
*       є ROSARIO, SF  2000                                       є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є                MS-DOS Window definitions                є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

=MOVEWIX("ideb",	INT((SROW()-16)/2), INT((SCOL()-78)/2), INT((SROW()-16)/2)+15, INT((SCOL()-78)/2)+77, ;
 "  NOTA DE DEBITO POR INTERESES "		,' '+JANNAME+' ')


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є         IDEB_FLY/MS-DOS Setup Code - SECTION 2          є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
STORE PROGRAM() TO ULPR
STORE .F. TO M.ELNUEVO
IF CHEQSEG()
STORE .F. TO I_SALIDA
SELE PER
IF LEFT(PER.CODCLI,1)="C" .OR. LEFT(PER.CODCLI,1)="O"
   SET ORDER TO TAG CSSCOD
ELSE
   SET ORDER TO TAG INQCOD
ENDIF
IF SEEK(CCL.CODCLI)
IF LEFT(PER.CODCLI,1)="C" .OR. LEFT(PER.CODCLI,1)="O"
      =XSEEK(PER.CODCLI,'CNX','CODCLI')
      =XSEEK(CNX.CONCOD,'CNS','CONCOD')
   ELSE
      =XSEEK(CCL.CODINM,"INM","CODINM")
      =XSEEK(INM.LOCALIDAD,'MIX','CIUCOD')
   ENDIF
   STORE NUL TO M.INTERESES,M.RETRASO,M.TTAL,M.MONTOBASE
   SELE CCL

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              IDEB_FLY/MS-DOS Screen Layout              є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
IF WVISIBLE("ideb")
	ACTIVATE WINDOW ideb SAME
ELSE
	ACTIVATE WINDOW ideb NOSHOW
ENDIF
@ 9,2 SAY "INT. DIARIOS:" ;
	SIZE 1,13, 0
@ 8,2 SAY "RETRASO     :" ;
	SIZE 1,13, 0
@ 6,2 SAY "VENCIMIENTO :" ;
	SIZE 1,13, 0
@ 5,2 SAY "OPERACION   :" ;
	SIZE 1,13, 0
@ 10,2 SAY "MONTO       :" ;
	SIZE 1,13, 0
@ 7,2 SAY "MONTO BASE  :" ;
	SIZE 1,13, 0
@ 1,2 SAY PER.CLIENTE ;
	SIZE 2,30 ;
	PICTURE "@!"
@ 1,33 SAY IIF(LEFT(PER.CODCLI,1)="C" .OR. LEFT(PER.CODCLI,1)="O" ,'CONSORCIO:'+ALLT(CNS.CONSORCIO)+"("+ALLTRIM(CNS.CONCOD)+")",'INMUEBLE:'+INM.CODINM) ;
	SIZE 1,42 ;
	PICTURE "@!"
@ 2,33 SAY IIF(LEFT(PER.CODCLI,1)="C" .OR. LEFT(PER.CODCLI,1)="O",CNS.DIRECCION,INM.DOMICILIO) ;
	SIZE 1,41
@ 3,33 SAY SAYMIX(IIF(LEFT(PER.CODCLI,1)="C",CNS.LOCALIDAD,INM.LOCALIDAD),'CIUCOD') ;
	SIZE 1,20 ;
	PICTURE "@!"
@ 5,17 SAY CCL.DETALLE ;
	SIZE 1,31 ;
	PICTURE "@!"
@ 6,17 SAY CCL.fechave ;
	SIZE 1,8
@ 7,17 SAY CCL.MONTO-CCL.CUOTA ;
	SIZE 1,10 ;
	PICTURE "999,999.99"
@ 8,17 GET M.RETRASO ;
	SIZE 1,4 ;
	RANGE 1, DATE()-CCL.FECHAVE ;
	DEFAULT " " ;
	PICTURE "999" ;
	WHEN _r3v154oel() ;
	MESSAGE "DIAS DE RETRASO"
@ 9,17 GET M.INTERESES ;
	SIZE 1,9 ;
	DEFAULT " " ;
	PICTURE "9999.9999" ;
	VALID _r3v154ohd() ;
	MESSAGE "INTERESES DIARIOS CORRESPONDIENTES"
@ 10,17 GET M.TTAL ;
	SIZE 1,13 ;
	DEFAULT " " ;
	PICTURE "999,999.99" ;
	DISABLE
@ 12,27 GET m.opcion ;
	PICTURE "@*HN \<Confirma;\<Anula" ;
	SIZE 1,10,1 ;
	DEFAULT 1 ;
	VALID _r3v154ojn() ;
	MESSAGE "CONFIRMA LA NOTA DE DEBITO POR INTERESES ?"

IF NOT WVISIBLE("ideb")
	ACTIVATE WINDOW ideb
ENDIF

READ CYCLE ;
	SHOW _r3v154omu()

=RELEWIN("ideb")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є              IDEB_FLY/MS-DOS Cleanup Code               є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*

#REGION 1
ENDIF
ELSE
=IAUDI()
ENDIF
RETURN M.ELNUEVO

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _R3V154OEL           M.RETRASO WHEN                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         IDEB_FLY,     Record Number:   15  є
*       є Variable:            M.RETRASO                          є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _r3v154oel     &&  M.RETRASO WHEN
#REGION 1
RETRASO=DATE()-CCL.FECHAVE
RETURN .T.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _R3V154OHD           M.INTERESES VALID                  є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         IDEB_FLY,     Record Number:   16  є
*       є Variable:            M.INTERESES                        є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _r3v154ohd     &&  M.INTERESES VALID
#REGION 1
STORE (CCL.MONTO-CCL.CUOTA)*M.INTERESES*M.RETRASO/100 TO M.TTAL
RETURN SGET("IDEB")

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _R3V154OJN           m.opcion VALID                     є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         IDEB_FLY,     Record Number:   18  є
*       є Variable:            m.opcion                           є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Push Button                        є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _r3v154ojn     &&  m.opcion VALID
#REGION 1
DO CASE
   CASE M.OPCION=2 .OR. LAST()=27 .OR. EMPTY(M.TTAL)
   =IAUD("ANULA "+ALLTRIM(PER.CODCLI)+'/'+ALLTRIM(CCL.DETALLE))
   CASE M.OPCION=1
   SELE CCL
   SCAT MEMV
   STORE DATE() TO M.FECHAOP,M.FECHAVE
   STORE "ND" TO M.COMPRRE
   STORE ALLTRIM(M.DETALLE+"рINTERESES")  TO M.DETALLE
   STORE M.TTAL TO M.MONTO
   STORE NUL TO M.CUOTA
   RECANT=RECNO("CCL")
   =AGRABAR("CCL")
   STORE .T. TO M.ELNUEVO
   GO M.RECANT
ENDCASE
CLEA READ
RETURN .T.

*       ЦДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД·
*       є                                                         є
*       є _R3V154OMU           Read Level Show                    є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є                                                         є
*       є From Platform:       MS-DOS                             є
*       є From Screen:         IDEB_FLY                           є
*       є Called By:           READ Statement                     є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       УДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЅ
*
FUNCTION _r3v154omu     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: IDEB_FLY
*
#REGION 1
IF SYS(2016) = "IDEB" OR SYS(2016) = "*"
	ACTIVATE WINDOW ideb SAME
	@ 1,2 SAY PER.CLIENTE ;
		SIZE 2,30, 0 ;
		PICTURE "@!"
	@ 1,33 SAY IIF(LEFT(PER.CODCLI,1)="C" .OR. LEFT(PER.CODCLI,1)="O" ,'CONSORCIO:'+ALLT(CNS.CONSORCIO)+"("+ALLTRIM(CNS.CONCOD)+")",'INMUEBLE:'+INM.CODINM) ;
		SIZE 1,42, 0 ;
		PICTURE "@!"
	@ 2,33 SAY IIF(LEFT(PER.CODCLI,1)="C" .OR. LEFT(PER.CODCLI,1)="O",CNS.DIRECCION,INM.DOMICILIO) ;
		SIZE 1,41, 0
	@ 3,33 SAY SAYMIX(IIF(LEFT(PER.CODCLI,1)="C",CNS.LOCALIDAD,INM.LOCALIDAD),'CIUCOD') ;
		SIZE 1,20, 0 ;
		PICTURE "@!"
	@ 5,17 SAY CCL.DETALLE ;
		SIZE 1,31, 0 ;
		PICTURE "@!"
	@ 6,17 SAY CCL.fechave ;
		SIZE 1,8, 0
	@ 7,17 SAY CCL.MONTO-CCL.CUOTA ;
		SIZE 1,10, 0 ;
		PICTURE "999,999.99"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF
