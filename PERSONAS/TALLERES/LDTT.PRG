#DEFINE PAIP   "|"                               && PAIP
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
PROCEDURE LDTT
ULPR=HORA_ULP(PROGRAM())
RESPUESTA="LDTT#6#25#Listados de Datos de Producci¢n#3;
#Un \<Taller;
#Un \<Rubro"
=DEFPOP()
ON SELE POPU LDTT DO LDTTX1
ACTI POPU LDTT
RELE POPU LDTT
ULPR=HORA_ULP(PROGRAM())
RETURN

PROCEDURE LDTTX1
A_DIJO=ALLTRIM(PROMPT())
=OPPRO()
=OPOTRS()
ULPR=HORA_ULP(PROGRAM())
EXTERNAL PROCEDURE LDTT0.PRG
DO CASE
	CASE A_DIJO="Un Taller"
		IF ELITALS("a Listar",-1,1)
			DO LDTTX2 WITH "T"
		ENDIF
	CASE A_DIJO="Un Rubro"
		IF ELIRUB("a Listar",-1,1)
			DO LDTTX2 WITH "R"
		ENDIF
ENDCASE
RETURN

PROCEDURE LDTTX2
	PARA PARD
	TT='Datos de Producci¢n '+CRLF+;
		IIF(PARD='T',ALLTR(PER.CLIENTE),ALLTR(MIX.TEXTO1))
	ACLA=PAIP+;
		PADC("CODIGO",IIF(PARD='T',3,10))+PAIP+;
		PADC(IIF(PARD='T',"RUBRO","TALLER"),15)+PAIP+;
		PADC("MAX.MES",7)+PAIP+;
		"VAL"+PAIP+;
		PADC("CANT. TOTAL ",14)+PAIP+;
		PADC("CANT. REPRO.",14)+PAIP+;
		PADC("ACTUAL",6)+PAIP
	=WORKING()
	=DOTALK()
	SELE DTT
	=FLOCK() .OR. FLOK()
	TMP=GENTMP()
	SET ORDER TO	
	DO CASE
		CASE PARD="T"
			SET ORDER TO TAG RUBCOD IN MIX
			SET RELA  TO RUBRO INTO MIX
			SORT ON RUBRO TO (TMP) FOR CODCLI=PER.CODCLI ;
				FIELDS RUBRO, MIX.TEXTO1, CANTIDAD, VALORACION, MERCTOTAL, MERCREPRO, TIENE
		CASE PARD="R"
			SET ORDER TO TAG CODCLI IN PER
			SET RELA  TO CODCLI INTO PER
			SORT ON CODCLI TO (TMP) FOR RUBRO=LEFT(MIX.TEXTO2,3) ;
				FIELDS CODCLI, PER.CLIENTE, CANTIDAD, VALORACION, MERCTOTAL, MERCREPRO, TIENE
	ENDCASE
	UNLO IN DTT
	=PRXAREA(.T.)
	USE (TMP) ALIAS TMP
	=UNTALK()
	=UNWORK()
	=XPRN1(4,"TMP","LDTT0('"+PARD+"')","","LDTTT")
	=OFF_TMP()
	=OFF_RELA()	
RETURN