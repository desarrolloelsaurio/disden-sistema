* ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : XPER.PRG                                                 บ
* บ COMENTARIO    : REINDEXA BASE DE PERSONAS                                บ
* ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
PROCEDURE XPER
	IF CHEQSEG()
		=men_lin("Reindexando Archivo")
		SELE PER
		=FLOCK("PER") .OR. FLOK("PER")
		=DOTALK()
		=OPPERX()
		PACK MEMO
		INDEX ON CLIENTE 	TAG AGENDA  	FOR FILTRO="A"
		INDEX ON CODCLI 	TAG AGECOD 		FOR FILTRO="A"
		INDEX ON TIPODOC+NRODOC TAG AGEDNI  FOR FILTRO="A"
		INDEX ON CLIENTE 	TAG PROVEEDO    FOR FILTRO="R"
		INDEX ON CODCLI 	TAG PROCOD 	    FOR FILTRO="R"
		#IF "PROD" $ CURD()
			INDEX ON CLIENTE 	TAG TALLERES FOR FILTRO="R"
			INDEX ON CODCLI 	TAG TALCOD 		FOR FILTRO="R"
		#ENDIF
		DO CASE
		CASE SSTM1="DIS-DEN"
			INDEX ON CLIENTE 	TAG CLIENTES FOR FILTRO="C"
			INDEX ON CODCLI 	TAG CODCLI FOR FILTRO="C"
			INDEX ON TIPODOC+NRODOC	TAG CLIDNI FOR FILTRO="C"
			INDEX ON CLIENTE 	TAG INTERESADO FOR FILTRO="I"
			INDEX ON CODCLI 	TAG INTCOD 		FOR FILTRO="I"
			INDEX ON CLIENTE TAG TPTTEX FOR FILTRO="Q"
			INDEX ON CODCLI TAG TPTCOD FOR FILTRO="Q"
		CASE SSTM1="CONTROL BANCOS"
			INDEX ON CLIENTE TAG USUARIO FOR FILTRO="U"
			INDEX ON CODCLI TAG USUCOD FOR FILTRO="U"
		CASE SSTM1="CAJAS"
			INDEX ON CLIENTE 	TAG CLIENTES FOR FILTRO="C"
			INDEX ON CODCLI 	TAG CODCLI FOR FILTRO="C"
			INDEX ON TIPODOC+NRODOC	TAG CLIDNI FOR FILTRO="C"
			INDEX ON CLIENTE 	TAG OPERADOR FOR FILTRO="O"
			INDEX ON CODCLI 	TAG OPECOD 		FOR FILTRO="O"
			INDEX ON TIPODOC+NRODOC TAG OPEDNI FOR FILTRO="O"
			INDEX ON CLIENTE 	TAG INTERESADO FOR FILTRO="I"
			INDEX ON CODCLI 	TAG INTCOD 		FOR FILTRO="I"
			#IF "LABO" $ CURDIR()
			CASE SSTM1="LABORATORIO"
				INDEX ON CLIENTE 	TAG PACIENTE 	FOR FILTRO="P"
				INDEX ON CODCLI 	TAG PACCOD 		FOR FILTRO="P"
				INDEX ON TIPODOC+NRODOC TAG PACDNI FOR FILTRO="P"
				INDEX ON CLIENTE 	TAG MEDICO   	FOR FILTRO="M"
				INDEX ON CODCLI 	TAG MEDCOD 		FOR FILTRO="M"
				INDEX ON TIPODOC+NRODOC TAG MEDDNI FOR FILTRO="M"
				INDEX ON CLIENTE 	TAG SANATORI 	FOR FILTRO="Z"
				INDEX ON CODCLI 	TAG SANCOD 		FOR FILTRO="Z"
				INDEX ON CLIENTE 	TAG INTERNO  	FOR FILTRO="I"
				INDEX ON CODCLI 	TAG INTERCOD	FOR FILTRO="I"
			#ENDIF
		CASE SSTM1="HOGAR"
			INDEX ON CODCLI 	TAG GNTCOD 		FOR FILTRO="X"
			INDEX ON CLIENTE 	TAG CONSIGNAT FOR FILTRO="X"
			INDEX ON CLIENTE 	TAG SERVICE 	FOR FILTRO="S"
			INDEX ON CODCLI 	TAG SERCOD 		FOR FILTRO="S"
			INDEX ON CLIENTE 	TAG SUCURSAL 	FOR FILTRO="U"
			INDEX ON CODCLI 	TAG SUCCOD 		FOR FILTRO="U"
			INDEX ON CLIENTE 	TAG GARANTIA 	FOR FILTRO="G"
			INDEX ON CODCLI 	TAG GARCOD 		FOR FILTRO="G"
			INDEX ON TIPODOC+NRODOC TAG GARDNI FOR FILTRO="G"
			INDEX ON CLIENTE 	TAG CLIENTES FOR FILTRO="C"
			INDEX ON CODCLI 	TAG CODCLI FOR FILTRO="C"
			INDEX ON TIPODOC+NRODOC	TAG CLIDNI FOR FILTRO="C"
		CASE SSTM1="ADMIN"
			INDEX ON CLIENTE 	TAG PROPIETA 	FOR FILTRO="P"
			INDEX ON CODCLI 	TAG PRPCOD 		FOR FILTRO="P"
			INDEX ON TIPODOC+NRODOC TAG PRPDNI FOR FILTRO="P"
			INDEX ON CLIENTE 	TAG CONSORCI 	FOR FILTRO="O"
			INDEX ON CODCLI 	TAG CSSCOD 		FOR FILTRO="O"
			INDEX ON TIPODOC+NRODOC TAG CSSDNI FOR FILTRO="O"
			INDEX ON CLIENTE 	TAG INQUILIN 	FOR FILTRO="I"
			INDEX ON CODCLI 	TAG INQCOD 		FOR FILTRO="I"
			INDEX ON CODCLI 	TAG CODCLI FOR FILTRO="I"
			INDEX ON TIPODOC+NRODOC TAG INQDNI FOR FILTRO="I"
			INDEX ON CLIENTE 	TAG GARANTIA 	FOR FILTRO="G"
			INDEX ON CODCLI 	TAG GARCOD 		FOR FILTRO="G"
			INDEX ON TIPODOC+NRODOC TAG GARDNI FOR FILTRO="G"
			INDEX ON CLIENTE 	TAG EMPLEADO 	FOR FILTRO="9"
			INDEX ON CODCLI     TAG EMPLCOD 	FOR FILTRO="9"
			INDEX ON TIPODOC+NRODOC TAG EMPLDNI FOR FILTRO="9"
		CASE SSTM1="BARCOS"
			INDEX ON CLIENTE 	TAG BUQUE	FOR FILTRO="B"
			INDEX ON CODCLI TAG BUQCOD FOR FILTRO="B"
		ENDCASE
			#IF "SUELD" $ CURDIR()
				INDEX ON CLIENTE 	TAG EMPLEADO FOR FILTRO="E"
				INDEX ON CODCLI 	TAG EmplCOD 		FOR FILTRO="E"
				INDEX ON TIPODOC+NRODOC TAG emplDNI FOR FILTRO="E"
			#ENDIF
		TX="CREA INDICE "
		=IAUD(TX)
		=REOPPER()
		=UNTALK()
	ELSE
		=IAUDI()
	ENDIF
RETURN
