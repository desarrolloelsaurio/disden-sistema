#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
FUNCTION GRABAPRO
IF M.INGRESO
   =AGRABAR("PER")
   =IAUD('Ing '+ALLTRIM(M.CODCLI)+'-'+M.CLIENTE)
   SELE MIX
   SCAT MEMV BLAN
   M.nu4=VAL(SUBSTR(PER.CODCLI,2))
   M.FILTRO="T"
   M.TEXTO1=M.CLIENTE
   M.TEXTO2=AJCUE(M.NU4)
   =AGRABAR("MIX")  
ELSE
   IF M.CAMBIO
      SELE PER
      GO FF
      =AGRABAR1("PER")
      =IAUD('Cor '+ALLTRIM(M.CODCLI)+'-'+M.CLIENTE)
      M.TEXTO2=AJCUE(VAL(SUBSTR(M.CODCLI,2)))
      IF XSEEK(M.TEXTO2,"MIX","GASCOD")
         SCAT MEMV 
         M.TEXTO1=M.CLIENTE
         SELE MIX
         =FLOCK("MIX") .OR. FLOK("MIX")
         GATH MEMV
         UNLO IN MIX
         SELE PER
      ELSE
      =CARTEL("NO SE HA PODIDO ACTUALIZAR",;
      "LA CUENTA CONTABLE CORRESPONDIENTE",;
      "VERIFIQUELO EN LA BASE DE CUENTAS Y",;
      ENTERCON)
      ENDIF
   ENDIF
ENDIF
RETURN .T.

FUNCTION AJCUE
PARAMETER ELNUM
M.COSA=PADL(ALLTRIM(STR(ELNUM)),8)
M.ELTEXOK=""
DO WHILE LEN(M.COSA)>1
   M.ELTEXOK="."+RIGHT(M.COSA,2)+M.ELTEXOK
   M.COSA=SINULT(M.COSA,2)
ENDDO
RETURN SUBSTR(M.ELTEXOK,2)
