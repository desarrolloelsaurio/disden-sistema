FUNCTION YAPER
PARAMETER Y_TIT,Y_BLANCO,Y_WIN
IF !EMPTY(Y_TIT)
   WAIT Y_TIT+" EXISTE" WIND NOWA
ENDIF
SELE PER
IF Y_BLANCO
   UNLO IN PER
   SCAT MEMO MEMV BLAN
   SCAT TO RESPALDO BLAN MEMO
   STORE .T. TO INGRESO
ELSE
   FF=RECNO("PER")
   REGISTRO=STR(FF)
   UNLO IN PER
   =LOCK("PER") .OR. LOK("PER")
   SCAT MEMO MEMV
   SCAT MEMO TO RESPALDO    
   STORE .F. TO INGRESO
ENDIF
STORE .F. TO CAMBIO
=IIF(WEXIST("PER"),SGET("PER") .AND. ;
!ESPROPIO .AND. ;
!ESLISTADO .AND. ;
SGET("XPER",.F.,.T.),SGET(Y_WIN))
RETURN IIF(EMPTY(Y_TIT),.T.,WCL())
