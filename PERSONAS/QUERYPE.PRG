*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        09/17/95             QUERYPE.PRG               18:12:23 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        GREGORIO REINER                                         
*                                                                
*        Copyright (c) 1995 GOYO REINER                          
*        MITRE 1480 '4' B                                       
*        ROSARIO, SF  2000                                       
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

DO CASE
CASE _DOS OR _UNIX      && no UNIX records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                       MS-DOS Window definitions                
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	=MOVEWIX("queryper",INT((SROW()-17)/2), INT((SCOL()-68)/2), INT((SROW()-17)/2)+16, INT((SCOL()-68)/2)+67, ;
	 ' Listado de '+texto[3]+' '	,' '+janname+' ')		
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                 QUERYPE/MS-DOS Setup Code - SECTION 2          
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	
	EXTERNAL PROCEDURE AJCODPER
	EXTERNAL ARRAY TEXTO
	EXTERNAL ARRAY CONTENIDO
	
	=HORA_ULP(PROGRAM())
	** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
	#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
	#DEFINE ABA    "Abriendo Base de "               && ABA
	#DEFINE NUL    0                                 && NUL
	#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
	#DEFINE PAIP   "|"                               && PAIP
	#DEFINE FOLC  ".F."                              && FOLC
	#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
	#DEFINE FOLL  .F.                                && FOLL
	#DEFINE TRUC  ".T."                              && TRUC
	#DEFINE TRUL  .T.                                && TRUL
	#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
	#DEFINE ELYES  "SI"                              && ELYES
	#DEFINE ELNOU  "NO"                              && ELNOU
	#DEFINE ONE    1                                 && ONE
	#DEFINE TWO    2                                 && TWO
	#DEFINE THREE  3                                 && THREE
	#DEFINE FOUR   4                                 && FOUR
	#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
	#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
	#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
	#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
	#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
	#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
	#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
	#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
	#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
	#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
	#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
	#DEFINE RH      36 								 && RH
	#DEFINE RP 		47 								 && RP
	#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
	#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
	#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
	#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
	#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
	#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE
	
	** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end
	
	IF CHEQSEG()
	   SELE PER
	   SCAT MEMV BLAN MEMO
	   RELE SALQU
	   PUBL SALQU
	   STORE "" TO M.RETORNO
	   STORE "" TO M.TTPER
	   STORE "" TO M.QUEPER
	   STORE NUL TO M.FILPER
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     QUERYPE/MS-DOS Screen Layout               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	IF WVISIBLE("queryper")
		ACTIVATE WINDOW queryper SAME
	ELSE
		ACTIVATE WINDOW queryper NOSHOW
	ENDIF
	@ 1,1 GET M.FILPER ;
		PICTURE "@*RVN \<Completo;\<Un;\<Opciones" ;
		SIZE 1,12,0 ;
		DEFAULT 1
	@ 2,8 SAY PROP(TIPO_PER) ;
		SIZE 1,11
	@ 13,22 GET m.lista ;
		PICTURE "@*HN \!Confirma;\?Anula" ;
		SIZE 1,10,1 ;
		DEFAULT 1 ;
		VALID _r3p130uaa()
	
	IF NOT WVISIBLE("queryper")
		ACTIVATE WINDOW queryper
	ENDIF
	
	READ CYCLE
	
	=RELEWIN("queryper")
	
	#REGION 0
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                      QUERYPE/MS-DOS Cleanup Code               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	ELSE
	   =IAUDI()
	ENDIF
	UNLO IN PER
	=KTRUCH()
	   RELE MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD,MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
	RETURN M.FISC
	

CASE _WINDOWS OR _MAC   && no MAC records in screen

	
	#REGION 0
	REGIONAL m.currarea, m.talkstat, m.compstat
	
	IF SET("TALK") = "ON"
		SET TALK OFF
		m.talkstat = "ON"
	ELSE
		m.talkstat = "OFF"
	ENDIF
	m.compstat = SET("COMPATIBLE")
	SET COMPATIBLE FOXPLUS
	
	m.rborder = SET("READBORDER")
	SET READBORDER OFF
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                      Windows Window definitions                
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	=MOVEWIX("queryper", 0.000, 0.000,	16.409 , 67.500 ;
	 ' Listado de '+texto[3]+' '		,' '+janname+' ')		 
**************************	 ;		COLOR SCHEME 1
	MOVE WINDOW queryper CENTER
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                QUERYPE/Windows Setup Code - SECTION 2          
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	
	EXTERNAL PROCEDURE AJCODPER
	EXTERNAL ARRAY TEXTO
	EXTERNAL ARRAY CONTENIDO
	
	=HORA_ULP(PROGRAM())
	** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
	#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
	#DEFINE ABA    "Abriendo Base de "               && ABA
	#DEFINE NUL    0                                 && NUL
	#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
	#DEFINE PAIP   "|"                               && PAIP
	#DEFINE FOLC  ".F."                              && FOLC
	#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
	#DEFINE FOLL  .F.                                && FOLL
	#DEFINE TRUC  ".T."                              && TRUC
	#DEFINE TRUL  .T.                                && TRUL
	#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
	#DEFINE ELYES  "SI"                              && ELYES
	#DEFINE ELNOU  "NO"                              && ELNOU
	#DEFINE ONE    1                                 && ONE
	#DEFINE TWO    2                                 && TWO
	#DEFINE THREE  3                                 && THREE
	#DEFINE FOUR   4                                 && FOUR
	#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
	#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
	#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
	#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
	#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
	#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
	#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
	#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
	#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
	#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
	#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
	#DEFINE RH      36 								 && RH
	#DEFINE RP 		47 								 && RP
	#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
	#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
	#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
	#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
	#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
	#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE
	
	** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end
	
	IF CHEQSEG()
	   SELE PER
	   SCAT MEMV BLAN MEMO
	   STORE SPACE(10) TO M.CODCLI1,M.CODCLI2
	   RELE SALQU
	   PUBL SALQU
	   STORE "" TO M.RETORNO
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     QUERYPE/Windows Screen Layout              
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	IF WVISIBLE("queryper")
		ACTIVATE WINDOW queryper SAME
	ELSE
		ACTIVATE WINDOW queryper NOSHOW
	ENDIF
	@ 3.378,1.125 SAY texto[10] ;
		SIZE 1.125,19.000 ;
		FONT "MS Sans Serif", 8
	@ 11.261,1.125 SAY texto[5] ;
		SIZE 1.125,19.000 ;
		FONT "MS Sans Serif", 8
	@ 12.387,1.125 SAY texto[6] ;
		SIZE 1.125,19.000 ;
		FONT "MS Sans Serif", 8
	@ 4.504,1.000 SAY "Domicilio" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 5.631,1.000 SAY "Localidad" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 7.883,1.000 SAY "Fax" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 1.126,1.000 SAY "C줰igo" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 9.009,1.000 SAY "Tipo Doc. Identidad" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 10.135,1.000 SAY "Cond. I.V.A." ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 6.757,1.000 SAY "Tel괽ono" ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B"
	@ 1.126,22.625 GET m.codcli1 ;
		SIZE 1.125,10.000 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE REPL('!',CONTENIDO[2]+1) ;
		WHEN _r3p130v7u() ;
		VALID _r3p130v9q() ;
		MESSAGE "Ingrese C줰igo de "+tipo_per+" - [ESC] para Men"+TEX_EFES ;
		ERROR 'CODCLI DE '+UPPER(TIPO_PER)+' EXISTE'
	@ 1.126,34.625 SAY IIF(EMPTY(M.CODCLI1),"",SAYPER(M.CODCLI1,CONTENIDO[3])) ;
		SIZE 1.125,30.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 2.252,22.625 GET m.codcli2 ;
		SIZE 1.125,10.000 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE REPL('!',CONTENIDO[2]+1) ;
		WHEN _r3p130vch() ;
		VALID SGET("QUERYPER") ;
		MESSAGE "Ingrese C줰igo de "+tipo_per+" - [ESC] para Men"+TEX_EFES ;
		ERROR 'CODCLI DE '+UPPER(TIPO_PER)+' EXISTE'
	@ 2.252,34.625 SAY IIF(EMPTY(M.CODCLI2),"",SAYPER(M.CODCLI2,CONTENIDO[3])) ;
		SIZE 1.125,30.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 3.378,22.625 GET m.CLIENTE ;
		SIZE 1.125,30.000 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!" ;
		WHEN OFF_F2() ;
		MESSAGE "Ingrese Nombre o Raz줻 Social de "+tipo_per+TEX_EFES
	@ 4.504,22.625 GET m.domicilio ;
		SIZE 1.125,30.000 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!" ;
		MESSAGE "Domicilio del "+tipo_per
	@ 5.631,22.625 GET m.localidad ;
		SIZE 1.125,4.000 ;
		DEFAULT 0 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "9999" ;
		WHEN MIX_F2("M.LOCALIDAD","del "+texto[1],5,11,"MIX.NU1","CIUTEX",5,34) ;
		VALID SGET("QUERYPER") ;
		MESSAGE "Localidad del "+tipo_per+TEX_EFES
	@ 5.631,34.625 SAY IIF(EMPTY(M.LOCALIDAD),"",SAYMIX(M.localidad,'CIUCOD')) ;
		SIZE 1.125,21.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 6.757,22.625 GET m.telefono ;
		SIZE 1.125,20.000 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!" ;
		WHEN OFF_F2() ;
		MESSAGE "Tel괽ono del "+tipo_per
	@ 7.883,22.625 GET m.fax ;
		SIZE 1.125,20.000 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!" ;
		MESSAGE "Fax del "+tipo_per
	@ 9.009,22.625 GET m.TIPODOC ;
		SIZE 1.125,2.000 ;
		DEFAULT " " ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "!!" ;
		WHEN MIX_F2("M.TIPODOC","del "+texto[1],8,22,"LEFT(MIX.TEXTO2,2)","DNITEX",8,34) ;
		VALID EMPTY(M.TIPODOC) .OR. VALIDMIX("TIPODOC","M.TIPODOC","DNICOD","PER",.F.,.T.,"PER") ;
		MESSAGE "Ingrese Tipo de Documento del "+texto[1]+tex_efes ;
		ERROR "TIPO DE DOCUMENTO INEXISTENTE"
	@ 9.009,34.625 SAY IIF(EMPTY(M.TIPODOC),"",SAYMIX(M.TIPODOC,'DNICOD')) ;
		SIZE 1.125,21.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 10.135,22.625 GET m.condiva ;
		SIZE 1.125,2.000 ;
		DEFAULT 0 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "!!" ;
		WHEN MIX_F2("M.CONDIVA","del "+texto[1],9,22,"LEFT(MIX.TEXTO2,2)","IVATEX",9,34) ;
		VALID EMPTY(M.CONDIVA) .OR. VALIDMIX("CONDIVA","M.CONDIVA","IVACOD","PER",.F.,.T.,"PER") ;
		MESSAGE "Ingrese Condici줻 de I.V.A. del "+texto[1]+tex_efes ;
		ERROR "CONDICION DE I.V.A. NO EXISTE"
	@ 10.135,34.625 SAY IIF(EMPTY(M.CONDIVA),"",SAYMIX(M.CONDIVA,'IVACOD')) ;
		SIZE 1.125,21.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 11.261,22.625 GET m.fechanac ;
		SIZE 1.125,8.000 ;
		DEFAULT {  /  /  } ;
		FONT "MS Sans Serif", 8 ;
		WHEN off_f2() ;
		MESSAGE TEXTO[5]+" del "+texto[1]
	@ 12.387,22.625 GET m.detalle ;
		SIZE 1.125,40.000 ;
		DEFAULT {  /  /  } ;
		FONT "MS Sans Serif", 8 ;
		WHEN off_f2() ;
		MESSAGE TEXTO[5]+" del "+texto[1]
	@ 14.640,22.500 GET m.lista ;
		PICTURE "@*HN \!Confirma;\?Anula" ;
		SIZE 1.769,10.000,1.000 ;
		DEFAULT 1 ;
		FONT "MS Sans Serif", 8 ;
		STYLE "B" ;
		VALID _r3p130vjt()
	
	IF NOT WVISIBLE("queryper")
		ACTIVATE WINDOW queryper
	ENDIF
	
	READ CYCLE ;
		SHOW _r3p130vp3()
	
	=RELEWIN("queryper")
	
	#REGION 0
	
	SET READBORDER &rborder
	
	IF m.talkstat = "ON"
		SET TALK ON
	ENDIF
	IF m.compstat = "ON"
		SET COMPATIBLE ON
	ENDIF
	
	
	*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*                                                                
	*                     QUERYPE/Windows Cleanup Code               
	*                                                                
	*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
	*
	
	#REGION 1
	ELSE
	   =IAUDI()
	ENDIF
	UNLO IN PER
	=KTRUCH()
	   RELE MIX_VARI,MIX_T1,MIX_R1,MIX_C1,MIX_COD,MIX_IND,MIX_R2,MIX_C2,MIX_ALIAS,MIX_CAMPO,MIX_LARGO
	RETURN M.RETORNO
	

ENDCASE


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3P130UAA           m.lista VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QUERYPE,     Record Number:    4   
*        Variable:            m.lista                            
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3p130uaa     &&  m.lista VALID
#REGION 1
IF M.LISTA=1
   =WORKING()
   STORE "     " TO M.RETORNO
   IF M.FILPER=1
	STORE "" TO M.TTQUE
	FISC="PER.FILTRO='"+CONTENIDO[5]+"'"
   ELSE
   ENDIF
   	TMP=GENTMP()
    SELE PER
    SET ORDER TO
    =FLOCK() .OR. FLOK()
    SORT ON CLIENTE TO (TMP) FOR &FISC
    UNLO IN PER
    =PRXAREA(.T.)
    USE (TMP) ALIAS TMP
   =UNWORK()
   CLEA READ
ELSE
   IF M.LISTA=2 .OR. LAST()=27
      STORE ".F." TO M.RETORNO
      CLEA READ
   ENDIF
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3P130V7U           m.codcli1 WHEN                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         QUERYPE,     Record Number:   16   
*        Variable:            m.codcli1                          
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3p130v7u     &&  m.codcli1 WHEN
#REGION 1
ON KEY LABEL F2 M.CODCLI1=QUEPOPUP("a Corregir",1,22)
ON KEY LABEL F3 M.CODCLI1=SEEKTECX(30,'PER','CLIENTE','PER.CODCLI',CONTENIDO[4],ALIAS(),ORDER(),1,34)
RETURN .t.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3P130V9Q           m.codcli1 VALID                    
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         QUERYPE,     Record Number:   16   
*        Variable:            m.codcli1                          
*        Called By:           VALID Clause                       
*        Object Type:         Field                              
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3p130v9q     &&  m.codcli1 VALID
#REGION 1
M.CODCLI1=EVAL(TEXTO[4])
RETURN SGET("QUERYPER")

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3P130VCH           m.codcli2 WHEN                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         QUERYPE,     Record Number:   18   
*        Variable:            m.codcli2                          
*        Called By:           WHEN Clause                        
*        Object Type:         Field                              
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3p130vch     &&  m.codcli2 WHEN
#REGION 1
ON KEY LABEL F2 M.CODCLI2=QUEPOPUP("a Corregir",1,22)
ON KEY LABEL F3 M.CODCLI2=SEEKTECX(30,'PER','CLIENTE','PER.CODCLI',CONTENIDO[4],ALIAS(),ORDER(),1,34)
RETURN .t.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3P130VJT           m.lista VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       Windows                            
*        From Screen:         QUERYPE,     Record Number:   32   
*        Variable:            m.lista                            
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      5                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3p130vjt     &&  m.lista VALID
#REGION 1
IF M.LISTA=1
   =WORKING()
   STORE "     " TO M.RETORNO

   ** VERIFICA LOCALIDAD
   IF !EMPTY(M.LOCALIDAD) .AND. XSEEK(M.LOCALIDAD,"MIX","CIUCOD")
      M.RETORNO=M.RETORNO+"PER.LOCALIDAD="+ALLTRIM(STR(M.LOCALIDAD))+" .AND."
      TT=TT+CHR(13)+CHR(10)+"Por Localidad:"+ALLTRIM(SAYMIX(M.LOCALIDAD,"CIUCOD"))
      HABILITADO[4]=.F.
   ENDIF

   ** VERIFICA NOMBRE
   IF !EMPTY(M.CLIENTE)
      =ADD_FISC(M.CLIENTE,"PER.CLIENTE","Cliente")
   ENDIF

   ** VERIFICA DOMICILIO
   IF !EMPTY(M.DOMICILIO)
      =ADD_FISC(M.DOMICILIO,"PER.DOMICILIO","Domicilio")
   ENDIF

   ** VERIFICA TELEFONO
   IF !EMPTY(M.TELEFONO)
      =ADD_FISC(M.TELEFONO,"PER.TELEFONO","Tel괽ono")
   ENDIF

   ** VERIFICA FAX
   IF !EMPTY(M.FAX)
      =ADD_FISC(M.FAX,"PER.FAX","Fax")
   ENDIF


   M.RETORNO=LEFT(M.RETORNO,LEN(M.RETORNO)-5)
   IF EMPTY(M.RETORNO)
      STORE ".T." TO M.RETORNO
   ENDIF
   =UNWORK()
   CLEA READ
ELSE
   IF M.LISTA=2 .OR. LAST()=27
      STORE ".F." TO M.RETORNO
      CLEA READ
   ENDIF
ENDIF
RETURN .T.

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R3P130VP3           Read Level Show                    
*                                                                
*        Function Origin:                                        
*                                                                
*                                                                
*        From Platform:       Windows                            
*        From Screen:         QUERYPE                            
*        Called By:           READ Statement                     
*        Snippet Number:      6                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r3p130vp3     && Read Level Show
PRIVATE currwind
STORE WOUTPUT() TO currwind
*
* Show Code from screen: QUERYPE
*
#REGION 1
IF SYS(2016) = "QUERYPER" OR SYS(2016) = "*"
	ACTIVATE WINDOW queryper SAME
	@ 1.126,34.625 SAY IIF(EMPTY(M.CODCLI1),"",SAYPER(M.CODCLI1,CONTENIDO[3])) ;
		SIZE 1.125,30.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 2.252,34.625 SAY IIF(EMPTY(M.CODCLI2),"",SAYPER(M.CODCLI2,CONTENIDO[3])) ;
		SIZE 1.125,30.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 5.631,34.625 SAY IIF(EMPTY(M.LOCALIDAD),"",SAYMIX(M.localidad,'CIUCOD')) ;
		SIZE 1.125,21.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 9.009,34.625 SAY IIF(EMPTY(M.TIPODOC),"",SAYMIX(M.TIPODOC,'DNICOD')) ;
		SIZE 1.125,21.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
	@ 10.135,34.625 SAY IIF(EMPTY(M.CONDIVA),"",SAYMIX(M.CONDIVA,'IVACOD')) ;
		SIZE 1.125,21.000, 0.000 ;
		FONT "MS Sans Serif", 8 ;
		PICTURE "@!"
ENDIF
IF NOT EMPTY(currwind)
	ACTIVATE WINDOW (currwind) SAME
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*         QUERYPE/Windows Supporting Procedures and Functions    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       QUERYPE Function ADD_FISC                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

FUNCTION ADD_FISC
PARAMETER ADD_CONT,ADD_VAR,ADD_TXT
   M.RETORNO=M.RETORNO+"!EMPTY(ATC('"+ALLTRIM(ADD_CONT)+"',"+ADD_VAR+")) .AND."
   TT=TT+CHR(13)+CHR(10)+"Por "+ADD_TXT+":"+UPPER(ALLTRIM(ADD_CONT))
RETURN .T.