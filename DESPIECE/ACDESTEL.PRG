#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
#DEFINE NUL    0                                 && NUL
PROCEDURE ACDESTEL
	PARA M.ARTICU
	=OPTELS()
    M.N_TEL=""
	SET ORDER TO TAG TELCODPRO
	SELE DES
	SET ORDER TO TAG ARTICULO
	SET RELA TO TELCODPRO INTO TELS 
	PUSH KEY 
	=MOVEWIN(2,0,18,78,"XXACEDSTEL"," Despiece de "+alltrim(MER.MERCA)+' -'+ALLT(LEFT(MIX.TEXTO1,10))+'- ')
    =SETKEY()
    =MEN_LIN("ING TELA - [CTRL+A] DESCR. - [F2] POPUP - [F4] REPITE - [F10] SALE")
	SELE DES
	BROW FIELDS;
		TELS.TELA:H="DESCRIPCION":R:35,;
		TELCODPRO:H="CODIGO":P="@!":;
		V=SEEK(TELCODPRO,"TELS") .AND. CHCHTEL():;
		E='NO EXISTE LA TELA',;
		TALLE:H="TL":2,;
		CANTIDAD:H="CANT.":P="99.999",;
		PSC:H='POS',;
		AA=SAYMIX(TELS.UNIDAD,"MDDCOD"):H="MED.":4;
		KEY M.ARTICU FOR !EMPTY(TELCODPRO) IN XXACEDSTEL
	=RELEWIN("XXACEDSTEL")
	=MEN_LIN(BOTOM)
	POP KEY	
RETURN

PROCEDURE INGAT
	PUSH KEY CLEA
	IF !EMPTY(ELITELS("C¢digo de la Tela",-1,1))
	    SELE DES
		REPL TELCODPRO WITH TELS.TELCODPRO
		KEYB "{UPARROW}"
		KEYB "{DNARROW}"
	ENDIF
	SET ORDER TO TAG TELCODPRO IN TELS	
	SELE DES
	=SETKEY()
RETURN

FUNCTION SETKEY
		ON KEY LABEL F10 KEYBOARD "{Ctrl+W}"
		ON KEY LABEL CTRL+A WAIT ALLTRI(TELS.TELA) WIND NOWAIT
		ON KEY LABEL F2 DO INGAT
		ON KEY LABEL F4 DO REPITEDES
RETURN .T.

FUNCTION REPITEDES
	PUSH KEY CLEA
	IF !EMPTY(M.N_TEL)
      	SELE DES	
		REPL TELCODPRO WITH M.N_TEL
		KEYB "{UPARROW}"
		KEYB "{DNARROW}"		
		KEYB "{DNARROW}"		
	ENDIF
	SET ORDER TO TAG TELCODPRO IN TELS
	SELE DES
	=SETKEY()
RETURN .T.

FUNCTION CHCHTEL
M.N_TEL=DES.TELCODPRO    
RETURN