#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
#DEFINE PAIP   "|"                               && PAIP
PROCEDURE LDESNA
PARA Q_TLIS
EXTERNAL PROCEDURE LDESN1.PRG
	=WORKING()
	=DOTALK()
	TT='Art¡culos que Contienen '+;
		IIF(Q_TLIS="T",;
		TELLA+CRLF+ALLTR(TELS.TELCODPRO)+" - "+ALLTR(TELS.TELA),;
		ABIO +CRLF+ALLTR(AVIS.AVICODPRO)+" - "+ALLTR(AVIS.AVIO));
		+CRLF+;
		"(Medido en "+ALLTRIM(SAYMIX(IIF(Q_TLIS="T", TELS.UNIDAD, AVIS.UNIDAD),"MDDCOD"))+")"
	ACLA=PAIP+;
		PADC("ARTICULO",20)+PAIP+;
		PADC("DESCRIPCION",40)+PAIP+;
		PADC("CANT.",6)+PAIP
	SELE DES
	=FLOCK() .OR. FLOK()
	TMP=GENTMP()
	SET ORDER TO	
	SET ORDER TO TAG ARTIRED IN MER
	SET RELA TO LEFT(ARTICULO,10) INTO MER
	IF Q_TLIS="A"
		SORT ON ARTICULO TO (TMP) FOR AVICODPRO=AVIS.AVICODPRO ;
			FIELDS ARTICULO, CANTIDAD, MER.MERCA
	ELSE
		SORT ON ARTICULO TO (TMP) FOR TELCODPRO=TELS.TELCODPRO ;
			FIELDS ARTICULO, CANTIDAD, MER.MERCA
	ENDIF
	UNLO IN DES
	SET ORDER TO TAG ARTICULO IN MER
	=PRXAREA(.T.)
	TMP2=GENTMP()
	USE (TMP) ALIAS TMP EXCL
	TOTAL ON ARTICULO TO (TMP2)
	=PRXAREA(.T.)
	USE (TMP2) ALIAS TMP2 EXCL
	=UNTALK()
	=UNWORK()
	=XPRN1(4,"TMP2","LDESN1()","","LDESN"+Q_TLIS)
	=OFF_TMP()
	=OFF_RELA()	
RETURN
