*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        03/31/96            QUERYCCP.PRG               16:32:41 
*                                                                
*       픔컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        GOYO REINER                                             
*                                                                
*        Copyright (c) 1996 GREGORIO REINER                      
*        MITRE 2480 4 B                                         
*        ROSARIO, SF  2000                                       
*                                                                
*        Description:                                            
*        This program was automatically generated by GENSCRN.    
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

PARAMETERS porpan,dekardex,porartic,tiwin,elfisc

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                QUERYCCP/MS-DOS Setup Code - SECTION 1          
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
=OPFAR()
=OPPRO()
=HORA_ULP(PROGRAM())
QW_DIJO=ALLTRIM(PROMPT())
STORE "" TO TTCCP,TTPRO,TTFEC
STORE 1  TO FILCCP,FILPRO,FILFEC
STORE "" TO QUECCP,QUEPRO,QUEFEC
** Start of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴start
#DEFINE BOTOM  "  "+repl("",78)                 && BOTOM
#DEFINE ABA    "Abriendo Base de "               && ABA
#DEFINE NUL    0                                 && NUL
#DEFINE PICUMAX "9,999,999,999,999.99"           && PICUMAX
#DEFINE PICUMA1 "9,999,999,999,999"              && PICUMA1
#DEFINE PAIP   "|"                               && PAIP
#DEFINE FOLC  ".F."                              && FOLC
#DEFINE CRLF CHR(13)+CHR(10)                     && CRLF
#DEFINE FOLL  .F.                                && FOLL
#DEFINE TRUC  ".T."                              && TRUC
#DEFINE TRUL  .T.                                && TRUL
#DEFINE IMPRIMIENDO  PADC(' IMPRIMIENDO LOS DATOS REQUERIDOS - [TECLA] Interrumpe ',80,'') && IMPRIMIENDO
#DEFINE ELYES  "SI"                              && ELYES
#DEFINE ELNOU  "NO"                              && ELNOU
#DEFINE ONE    1                                 && ONE
#DEFINE TWO    2                                 && TWO
#DEFINE THREE  3                                 && THREE
#DEFINE FOUR   4                                 && FOUR
#DEFINE TEX_EFES " - [F2] Popup - [F3] B즧queda" && TEX_EFES
#DEFINE TEX_CALC "CALCULANDO - ESPERE POR FAVOR" && TEX_CALC
#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"")
#DEFINE NOVACIO "CAMPO DE INGRESO OBLIGATORIO - NO PUEDE ESTAR VACIO" && NOVACIO
#DEFINE NOFECHA "LAS FECHAS ESTAN ENTRE VALORES INACEPTABLES" && NOFECHA
#DEFINE ESPAOPC " - Barra Espac. para cambiar de Opci줻" && ESPAOPC
#DEFINE ESCANUL " - [ESC] para Anular"           && ESCANUL
#DEFINE ESCAMEN " - [ESC] para Men"             && ESCAMEN
#DEFINE ESCAFIN " - [ESC] para Fin"              && ESCAFIN
#DEFINE NOACVAL "LOS VALORES INGRESADOS ESTAN ENTRE LIMITES INACEPTABLES"    && NOACVAL
#DEFINE CONTIX  " Continuaci줻"                  && CONTIX
#DEFINE RH      36 								 && RH
#DEFINE RP 		47 								 && RP
#DEFINE ENTERCON "PULSE [ENTER] PARA CONTINUAR"  && ENTERCON
#DEFINE ORQ      "Orden de Requerimiento"        && ORQ
#DEFINE ORQS     "Ordenes de Requerimiento"      && ORQS
#DEFINE NOSEL "NO SE HA SELECCIONADO"            && NOSEL
#DEFINE PIC30 "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"	 && PIC30
#DEFINE T_REINGRE "Reingrese el DATO"	 		 && T_REINGRE

** End of inserted file \SISTEMAS\DEFINES.PRG 컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴end

store 1 to minobj,REQini
store 3 to maxobj,REQfin
STORE .F. TO M.HUBORES
STORE NUL TO DIFERENCIA
CANT_MAX=8
DIME TEXTO[CANT_MAX,2], VARIABLE[CANT_MAX], HABILITADO[CANT_MAX],HABILANT[CANT_MAX]




#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                       MS-DOS Window definitions                
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

IF NOT WEXIST("queryccp") ;
	OR UPPER(WTITLE("QUERYCCP")) == "QUERYCCP.PJX" ;
	OR UPPER(WTITLE("QUERYCCP")) == "QUERYCCP.SCX" ;
	OR UPPER(WTITLE("QUERYCCP")) == "QUERYCCP.MNX" ;
	OR UPPER(WTITLE("QUERYCCP")) == "QUERYCCP.PRG" ;
	OR UPPER(WTITLE("QUERYCCP")) == "QUERYCCP.FRX" ;
	OR UPPER(WTITLE("QUERYCCP")) == "QUERYCCP.QPR"
	=MOVEWIX("queryccp",	INT((SROW()-8)/2), INT((SCOL()-77)/2), INT((SROW()-8)/2)+7, INT((SCOL()-77)/2)+76, ;
	 " L죑ites del Listado "		,' '+janname+' ')		
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*                     QUERYCCP/MS-DOS Screen Layout              
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*

#REGION 1
IF WVISIBLE("queryccp")
	ACTIVATE WINDOW queryccp SAME
ELSE
	ACTIVATE WINDOW queryccp NOSHOW
ENDIF
@ 1,27 GET m.filpro ;
	PICTURE "@*RVN Todos los \<Proveed.;Un P\<roveedor;Op\<ciones" ;
	SIZE 1,22,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID _r970zgmpa()
@ 1,51 GET m.filfec ;
	PICTURE "@*RVN Todas las Fechas;\<Entre Fechas" ;
	SIZE 1,20,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID _r970zgmrn()
@ 1,2 GET m.filccp ;
	PICTURE "@*RVN \<Completo;Un P\<roveedor;Op\<ciones" ;
	SIZE 1,16,0 ;
	DEFAULT 1 ;
	WHEN betw(_curobj,minobj,maxobj) ;
	VALID _r970zgmuj()
@ 4,62 GET M.ANULA ;
	PICTURE "@*HN \<OK;\<NO" ;
	SIZE 1,4,1 ;
	DEFAULT 1 ;
	VALID _r970zgmwu()

IF NOT WVISIBLE("queryccp")
	ACTIVATE WINDOW queryccp
ENDIF

READ CYCLE

=RELEWIN("queryccp")

#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R970ZGMPA           m.filpro VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QUERYCCP,     Record Number:    2  
*        Variable:            m.filpro                           
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      1                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r970zgmpa     &&  m.filpro VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   opn1=OBJNUM(m.filpro)
   opvar="REQ.procod"
   VAR_NU=4
   if _curobj=opn1+1
      IF !empty(ELIPRO("a Listar",-1,1))
         QUEPRO=opvar+"='"+per.codcli+"'"
         M.ttpro="PROVEEDOR:"+ALLTRIM(PER.CLIENTE)
		SHOW GETS
         HABILITADO[VAR_NU]=.F.
      ELSE
         =NOSELEC("PROVEEDOR")
      ENDIF
   ENDIF
ENDIF
RETURN VAL_OBJ(.F.,2)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R970ZGMRN           m.filfec VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QUERYCCP,     Record Number:    3  
*        Variable:            m.filfec                           
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      2                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r970zgmrn     &&  m.filfec VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   opn1=objnum(m.filfep)
   opvar="REQ.FECHAPROM"
   VAR_NU=5
   if _curobj=opn1+1
      STORE {} TO M.FECINI,M.FECFIN
      IF ENTRE_FE("a Listar")
         IF M.FECINI#M.FECFIN
            QUEFEP="BETW("+OPVAR+",{"+DTOC(M.FECINI)+"},{"+DTOC(M.FECFIN)+"})"
            M.ttfep="FECHA DE PROMESA:"+DTOC(M.FECINI)+" AL "+DTOC(M.FECFIN)
         ELSE
            QUEfep=OPVAR+;
              "={"+;
              DTOC(M.FECINI)+;
              "}"
            M.ttfep="FECHA DE PROMESA:"+DTOC(M.FECINI)
            HABILITADO[VAR_NU]=.F.
         ENDIF
      ELSE
         =NOSELEC("FECHA DE ALTA")
      ENDIF
   ENDIF
ENDIF
RETURN VAL_OBJ()


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R970ZGMUJ           m.filccp VALID                     
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QUERYCCP,     Record Number:    4  
*        Variable:            m.filccp                           
*        Called By:           VALID Clause                       
*        Object Type:         Radio Button                       
*        Snippet Number:      3                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r970zgmuj     &&  m.filccp VALID
#REGION 1
IF READKEY()=15 .OR. READKEY()=271
   opn1=OBJNUM(m.filpro)
   opvar="REQ.procod"
   VAR_NU=4
   if _curobj=opn1+1
      IF !empty(ELIPRO("a Listar",-1,1))
         QUEPRO=opvar+"='"+per.codcli+"'"
         M.ttpro="PROVEEDOR:"+ALLTRIM(PER.CLIENTE)
		SHOW GETS
         HABILITADO[VAR_NU]=.F.
      ELSE
         =NOSELEC("PROVEEDOR")
      ENDIF
   ENDIF
ENDIF
RETURN VAL_OBJ(.F.,2)


*       靈컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*                                                                
*        _R970ZGMWU           M.ANULA VALID                      
*                                                                
*        Function Origin:                                        
*                                                                
*        From Platform:       MS-DOS                             
*        From Screen:         QUERYCCP,     Record Number:    5  
*        Variable:            M.ANULA                            
*        Called By:           VALID Clause                       
*        Object Type:         Push Button                        
*        Snippet Number:      4                                  
*                                                                
*       聃컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
*
FUNCTION _r970zgmwu     &&  M.ANULA VALID
#REGION 1
IF M.OPCION=1
STORE ".T." TO M.FISC
STORE " LISTADO " TO M.TT
ENDIF
CLEA READ
RETURN .T.