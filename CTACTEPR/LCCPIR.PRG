***********************************
*-- Programa: lCCPir.prg
*-- Fecha   : 03-23-92 12:17pm
*-- Version : g. reiner
*-- Notas   : IMPRESION DE SALDOS
***********************************
STOR HORA_ULP(PROGRAM()) TO ULPR
IF CHEQSEG()
	=WORKING()
	NADA=GENTMP()
	SELE CCP
	IF ".T."=FISC
		INDE ON PROCOD TO (NADA) comp
	ELSE
		INDE ON PROCOD TO (NADA) FOR eval(FISC) comp
	ENDIF
	ACLA=PADC("CODIGO",10)+PAIP+PADC("PROENTE",25)+PAIP+PADC("DEBE",13)+PAIP+PADC("HABER",13)+PAIP+PADC("SALDO",13)
	LNS=REPL("=",LEN(ACLA))
	TT='Listado de Saldos'+ttque
	=unwork()
	stor nul TO casos
	do cabpri
	_PCOPIES=1
	PRINTJOB
	=cabpri1()
	=TIT_LIN(3)
	SELE PRO
	SET ORDER TO TAG IIF(TYPE("ORDPRO")#'L' .OR. ORDPRO,'PROCOD','PROENTE')
	STORE NUL TO GDEBE,GHABER
	PICU='99,999,999.99'
	SCAN FOR XSEEK(PRO.PROCOD,'CCP','PROCOD')
		IF _PLINENO>63
			=TLCCPiR1("SUBTOTAL")
			EJECT PAGE
			=FIN_LIN(3,NUL)
			=cabpri1()
			=TIT_LIN(4)
		ENDI
		STORE NUL TO DEBE,HABER
		=Q_DEU(PRO.PROCOD)
		if !empty(debe+haber)
			? PRO.PROCOD
			?? PAIP
			?? LEFT(PRO.PROVEEDOR,25)
			?? PAIP
			?? DEBE PICT PICU
			GDEBE=GDEBE+DEBE
			?? PAIP
			?? HABER PICT PICU
			GHABER=GHABER+HABER
			?? PAIP
			?? DEBE-HABER PICT PICU
		ENDIF
	ENDSCAN
	=TLCCPIR1("TOTAL")
	ENDP
	=FINIMP()
	=iaud('LISTADO SALDOS')
	=REOPCCP()
ELSE
	=IAUDI()
ENDIF
RETURN MEN_LIN(BOTOM)

FUNCTION TLCCPIR1
	PARAMETER COSA
	PRIVATE COSA
	? LNS
	? SPACE(10)
	?? PAIP
	?? PADR(COSA,25)
	?? PAIP
	?? GDEBE PICT PICU
	?? PAIP
	?? GHABER PICT PICU
	?? PAIP
	?? GDEBE-GHABER PICT PICU
	?? PAIP
RETURN .T.
