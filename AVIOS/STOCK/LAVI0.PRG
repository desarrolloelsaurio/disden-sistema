FUNCTION LAVI0
EXTERNAL ARRAY TOTAL
#DEFINE PAIP   "|"                            && PAIP
? PAIP
=IIF(VARIABLE[1],QOUT(left(AVIS.AVICODPRO,texto[1,2])+PAIP),'')
=IIF(VARIABLE[2],QOUT(left(AVIS.AVIO,texto[2,2])+PAIP),'')
=IIF(VARIABLE[3],QOUT(SAYPER(AVIS.PROCOD,"PROCOD",texto[3,2])+PAIP),'')
=IIF(VARIABLE[4],QOUT(STR(AVIS.MONTO,texto[4,2],4)+PAIP),'')
=IIF(VARIABLE[5],QOUT(SAYMIX(AVIS.UNIDAD,"MDDCOD",texto[5,2])+PAIP),'')
=IIF(VARIABLE[6],QOUT(SAYMIX(AVIS.COLOR,"SUECOD",texto[6,2])+PAIP),'')
=IIF(VARIABLE[7],QOUT(SAYMIX(AVIS.APLICACION,"APLCOD",texto[7,2])+PAIP),'')
=IIF(VARIABLE[8],QOUT(SAYMIX(AVIS.marca,"MARCOD",texto[8,2])+PAIP),'')
IF VIRTUAL
   =IIF(VARIABLE[9], QOUT(STR(AVIS.STOCK,texto[9,2],2)+PAIP),'')
   =IIF(VARIABLE[10],QOUT(STR(AVIS.STOCKRES,texto[10,2],2)+PAIP),'')
   =IIF(VARIABLE[11],QOUT(STR(AVIS.STOCK-STOCKRES,texto[11,2],2)+PAIP),'')
   =IIF(VARIABLE[12],QOUT(STR(AVIS.STKRESPEN,texto[12,2],2)+PAIP),'')
   =IIF(VARIABLE[13],QOUT(STR(IIF(SEEK(AVIS.AVICODPRO+STR(1),'TMP3'),TMP3.PEDIDO-TMP3.RECIBIDO,0),texto[13,2],2)+PAIP),'')
   =IIF(VARIABLE[14],QOUT(STR(IIF(SEEK(AVIS.AVICODPRO+STR(2),'TMP3'),TMP3.PEDIDO-TMP3.RECIBIDO,0),texto[14,2],2)+PAIP),'')
   =IIF(VARIABLE[15],QOUT(STR(IIF(SEEK(AVIS.AVICODPRO+STR(3),'TMP3'),TMP3.PEDIDO-TMP3.RECIBIDO,0),texto[15,2],2)+PAIP),'')
ELSE
	IF DESTOCK
	   =IIF(VARIABLE[9],QOUT(STR(AVIS.STOCK,texto[9,2],2)+PAIP),'')
	   =IIF(VARIABLE[10],QOUT(STR(AVIS.STOCKMAX,texto[10,2],2)+PAIP),'')
	   =IIF(VARIABLE[11],QOUT(STR(AVIS.STOCKMIN,texto[11,2],2)+PAIP),'')
	   =IIF(VARIABLE[12],QOUT(STR(AVIS.STOCKUSO,texto[12,2],2)+PAIP),'')
	   =IIF(VARIABLE[13],QOUT(STR(AVIS.STOCKRES,texto[13,2],2)+PAIP),'')
	   IF !EMPTY(DIFERENCIA)
	      DO CASE
	      CASE DIFERENCIA=1                         && STOCK MENOR QUE EL MINIMO
    	     =IIF(VARIABLE[14],QOUT(STR(AVIS.STOCKMIN-AVIS.STOCK,texto[14,2],2)+PAIP),'')
	      CASE DIFERENCIA=2                      && STOCK MAYOR QUE EL MAXIMO
    	     =IIF(VARIABLE[14],QOUT(STR(AVIS.STOCK-AVIS.STOCKMAX,texto[14,2],2)+PAIP),'')
	      CASE DIFERENCIA=3
    	     =IIF(VARIABLE[14],QOUT(STR(AVIS.STOCK*AVIS.MONTO,texto[14,2],2)+PAIP),'')
        	 DO CASE
	         CASE ISARRAY(@TOTAL)
	    		STORE TOTAL[1]+AVIS.STOCK*AVIS.MONTO TO TOTAL[1]
    	     CASE TYPE("STOTAL")#"U"
        	    STOTAL=STOTAL+AVIS.STOCK*AVIS.MONTO
	         OTHERWISE
    	        TOTAL = TOTAL+AVIS.STOCK*AVIS.MONTO
        	 ENDCASE
    	  ENDCASE
	   ENDIF
	ENDIF
ENDIF
CASOS=CASOS+1
RETURN .T.
