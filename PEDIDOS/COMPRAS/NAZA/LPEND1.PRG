#DEFINE PAIP   "|"                               && PAIP
FUNCTION LPEND1
IF !PLEIN
   ? PAIP
   ?? STR(NUMERO,IIF(PORPAN,6,10))
   ?? PAIP
   ?? AVICODPRO
   ?? PAIP
   IF !PORPAN
      ?? LEFT(ELTEX(),30)
      ?? PAIP
   ENDIF
   IF !L_FEC
      ?? SAYPER(REQ.PROCOD,"PROCOD",IIF(PORPAN,15,30))
      ?? PAIP
   ENDIF
   ?? REQ.FECHAPROM
   ?? PAIP
   ?? STR(PEDIDO,XACDIGI)
   ?? PAIP
   ?? STR(RECIBIDO,XACDIGI)
   ?? PAIP
   ?? STR(PEDIDO-RECIBIDO,XACDIGI)
   ELPEND=PEDIDO-RECIBIDO
   IF TYPE("ELPEN")#"U" .AND. ELPEND>0
      ELPEN=ELPEN+ELPEND
   ENDIF
   ?? PAIP
ENDIF
IF ESJEFE(2)
   ELPEND=PEDIDO-RECIBIDO
   IF !PLEIN
      ?? STR(PEDIDO*MONTO,XACDIGI)
      ?? PAIP
ELSE
   IF ELPEND>0
      ELPEN=ELPEN+ELPEND
   ENDIF

   ENDIF
   M.ELTOT=M.ELTOT+PEDIDO*MONTO
   IF L_FEC
      ELTOMON=IIF(ELPEND>0,ELPEND*MONTO,0)
      M.TOMON=M.TOMON+ELTOMON
      IF !PLEIN
         ?? STR(ELTOMON,XACDIGI)
         ?? PAIP
      ENDIF
   ENDIF
ENDIF
RETURN .T.
