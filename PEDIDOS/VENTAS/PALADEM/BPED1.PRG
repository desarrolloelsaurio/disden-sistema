*****************************************************
*-- Programa: BPED1.PRG
*-- Fecha   : 01-12-93 03:04pm
*-- Versi¢n : G. REINER
*-- Notas   : BORRA LINEAS LINEAS A PEDIDO EXISTENTE
*****************************************************
ulpr=hora_ulp(program())
if cheqseg()
   SELE PED
   SCAT MEMV
   STORE NUL TO REN,REBLA,PUNTERO,CANTOT,PRETOT,REXITO
   =MPED()
   IF CONFIRMA("MODIFICAR LA NOTA DE PEDIDO",.T.,20,20)
      =MEN_LIN("[ESC] para Salir")
      ON KEY LABEL CTRL+T DO BPED11
      =MOVECENT(0,0,12,74,"WIN1","BORRA LINEA de NOTA DE PEDIDO"," CTRL + T BORRA LINEA")
      SET ORDER TO TAG ARTICULO IN MER
      SELE PEX
      SET RELA TO ARTICULO INTO MER
      BROW FIEL ;
        PEX.ARTICULO:H="ARTIC.":P="XXXXXX":R,;
        MER.MERCA:H=PADC("DESCRIPCION",30):R,;
        PEX.CANTIDAD:H=PADC("CANTIDAD",10):P="9999999.99":R,;
        COSA=IIF(MER.DISCRIM,PEX.PESOENT,PEX.CANTENT):H=PADC("ENTREGADO",10):P="9999999.99":R,;
        COSA1=PEX.CANTIDAD-IIF(MER.DISCRIM,PEX.PESOENT,PEX.CANTENT):H="PENDIENTE":P="9999999.99":R ;
        KEY PED.PEDIDO ;
        IN WIN1
      =RELEWIN("WIN1")
   ENDIF
   =RELEWIN("WIN")
   ON KEY LABEL CTRL+T
   =REOPPED()
ELSE
   =iaudi()
ENDI
UNLO ALL
=MEN_LIN(BOTOM)
ON KEY LABEL TAB
RETURN
PROCEDURE BPED11
IF CONFIRMA("BORRAR "+ALLTRIM(MER.MERCA),.T.,20,20)
   SELE PEX
   IF EMPTY(PEX.PESOENT) .AND. EMPTY(CANTENT)
      =FLOCK("PEX") .OR. FLOK("PEX")
      DELE
      UNLO IN PEX
   ELSE
      REGISTRO=STR(RECNO("PEX"))
      =LOCK("PEX") .OR. LOK("PEX")
      REPL PEX.CANTIDAD WITH IIF(MER.DISCRIM,PEX.PESOENT,PEX.CANTENT)
      UNLO IN PEX
   ENDIF
ENDIF
SET MESS TO "[ESC] para Salir"
RETURN
