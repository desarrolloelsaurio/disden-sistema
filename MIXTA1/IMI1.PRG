*******************************************
*-- Programa: IMI1.PRG
*-- Fecha   : 04-12-92 11:42am
*-- Version : G. REINER
*-- Notas   : INGRESA BASE MI1TA - NIVEL 0
*******************************************
FUNCTION IMI1
	PARAMETER MENSAJE,TEXTO,OTROS
	PRIVATE MENSAJE,texto,OTROS
	STOR HORA_ULP(PROGRAM()) TO ULPR
	IF CHEQSEG()
		SELE MI1
		SET ORDER TO TAG (OTROS[1])
		STOR MENSAJE[1] TO me1
		STOR OTROS[2] TO COL
		STOR NUL TO KOK
		=MOVEWIN(OTROS[3],OTROS[4],OTROS[5],OTROS[6],'WIN',MENSAJE[2])
		DO WHIL .T.
			ACTI WIND WIN
			CLEA
			SCAT MEMV BLAN
			IF IMI11(@MENSAJE,@TEXTO,@OTROS)
				=MEN_LIN(GRABANDO)
				=FLOCK("MI1") .OR. FLOK("MI1")
				M.FILTRO=OTROS[7]
				INSERT INTO MI1 FROM MEMV
				=REPUSE()
				UNLO IN MI1
				=IAUD(ALLTRIM(M.TEXTO1)+"-"+ALLTRIM(M.TEXTO2))
			ELSE
				EXIT
			ENDIF
		ENDDO
		=RELEWIN("WIN")
	ELSE
		=IAUDI()
	ENDIF
RETURN MEN_LIN(BOTOM)
