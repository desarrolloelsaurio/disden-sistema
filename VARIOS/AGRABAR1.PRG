FUNCTION AGRABAR1
PARAMETER ELARCHIVO,ELREGISTRO,GRA_MENLIN
#DEFINE GRABAN1 PADC(' Acualizando datos existentes - Espere por Favor ',80,"°")    && GRABANDO
#DEFINE BOTOM  "  "+repl("°",78)                 && BOTOM
=IIF(GRA_MENLIN,.T.,MEN_LIN(GRABAN1))
ANTERIOR=ALIAS()
IF !EMPTY(ELARCHIVO)
   SELE (ELARCHIVO)
ELSE
   ELARCHIVO=ALIAS() 
ENDIF
IF !EMPTY(ELREGISTRO)
   GO M.ELREGISTRO
ENDIF   
=RLOCK() .OR. LOK((ELARCHIVO))
GATH MEMV MEMO
=REPUSE()
UNLO IN (ELARCHIVO)
IF !EMPTY(ANTERIOR)
   SELE (ANTERIOR)
ENDIF
FLUSH
RETURN IIF(GRA_MENLIN,.T.,MEN_LIN(BOTOM))