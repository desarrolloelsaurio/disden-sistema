* ษอออออออออออออออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : AGRABAR.PRG                     บ
* บ COMENTARIO    : INSERTA NUEVO REGISTRO EN BASE  บ
* ศอออออออออออออออออออออออออออออออออออออออออออออออออผ
FUNCTION AGRABAR
PARAMETER GRA_ARCHIVO,GRA_ARRAY,GRA_REPUSE,GRA_MENLIN
#DEFINE GRABANDO PADC(' Grabando los datos ingresados - Espere por Favor ',80,"ฐ")    && GRABANDO
#DEFINE BOTOM  "  "+repl("ฐ",78)                 && BOTOM
IF !GRA_MENLIN
   =MEN_LIN(GRABANDO)
ENDIF
ANTERIOR=ALIAS()
SELE (GRA_ARCHIVO)
=FLOCK() .OR. FLOK((GRA_ARCHIVO))
IF !EMPTY(GRA_ARRAY) .AND. ISARRAY(@GRA_ARRAY)
   INSERT INTO (GRA_ARCHIVO) FROM ARRAY GRA_ARRAY
   =IIF(GRA_REPUSE,REPUSE(),.T.)
ELSE
   INSERT INTO (GRA_ARCHIVO) FROM MEMV
   =REPUSE()
ENDIF
FLUSH
UNLO IN (GRA_ARCHIVO)
IF !EMPTY(ANTERIOR)
   SELE (ANTERIOR)
ENDIF
RETURN IIF(GRA_MENLIN,.T.,MEN_LIN(BOTOM))
