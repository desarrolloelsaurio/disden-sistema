FUNCTION GETFUSER
SET TALK OFF
#IF "Wind" $ VERS()
   ACTI SCRE
   #ELSE
   C_POS=10
   DIME POSIB[C_POS]
   POSIB[1]="F:\PUBLIC\FOXUSER.DBF"
   POSIB[2]="F:\USR\"+GETENV("USERNAME")+"\FOXUSER.DBF"
   POSIB[3]="\PUBLIC\FOXUSER.DBF"
   POSIB[4]=IIF(TYPE("USADOR")="C","\USR\"+USADOR+"\FOXUSER.DBF","FOXPSER.DBF")
   POSIB[5]="C:\FOX2\FOXUSER.DBF"
   POSIB[6]="C:\FOXPRO2\FOXUSER.DBF"
   POSIB[7]="G:\FOXPRO2\FOXUSER.DBF"
   POSIB[8]="\FOX2\FOXUSER.DBF"
   POSIB[9]="FOXUSER.DBF"
   POSIB[10]="C:\FOXPRO25\FOXUSER.DBF"

   FOR XA= 1 TO C_POS
      IF FILE(POSIB[XA])
         SET RESO TO (POSIB[XA])
         SET RESO ON
         DO CASE
         CASE GETENV("EQUIPO")="BATA" 
            SET COLOR SET TO COMPQ_MONO
		 CASE GETENV("EQUIPO")="GOYOLAP"
            SET COLOR SET TO MONOCHROME
         CASE UPPER(GETENV("COLOR"))="VGA/MONO" .OR. ;
              UPPER(UPPER(SYS(2006)))="VGA/MONO"
            SET DISP TO VGA25
            SET COLOR SET TO VGAMONO
         CASE ISCOLOR() .OR. GETENV("COLOR")="COLOR"
            SET COLOR SET TO COLOR
         OTHERWISE
            SET COLOR SET TO MONOCHROME
         ENDCASE
         EXIT
      ENDIF
   NEXT
#ENDIF
RETURN .T.
