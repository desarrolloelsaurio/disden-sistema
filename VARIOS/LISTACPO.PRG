FUNCTION LISTACPO
PARAMETER L_INI
STORE IIF(EMPTY(L_INI),"",L_INI) TO SAL_CAMPO
FOR L_A=1 TO CANT_MAX
   IF VARIABLE[L_A]
      L_ANTER=TEXTO(L_A,3)
      F_CAMPO=OCCUR(",",TEXTO(L_A,3))
      FOR F_B=1 TO F_CAMPO
          L_POS=AT(",",TEXTO(L_A,3))
          L_TEX=LEFT(TEXTO(L_A,3),L_POS-1)
          TEXTO[L_A,3]=SUBSTR(TEXTO[L_A,3],L_POS+1)
          IF EMPTY(OCCURS(L_TEX+",",SAL_CAMPO))
             SAL_CAMPO=SAL_CAMPO+L_TEX+','
          ENDIF
      ENDF
      IF EMPTY(OCCURS(TEXTO(L_A,3)+',',SAL_CAMPO))      
         SAL_CAMPO=SAL_CAMPO+TEXTO(L_A,3)+','   
      ENDIF
      TEXTO(L_A,3)=L_ANTER
   ENDIF
ENDFOR
DO WHILE RIGHT(SAL_CAMPO,1)=","
   SAL_CAMPO=SINULT(SAL_CAMPO)
ENDDO
RETURN SAL_CAMPO
