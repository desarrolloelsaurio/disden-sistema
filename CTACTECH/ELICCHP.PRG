* ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
* บ PROCEDIMIENTO : ELICCHP.PRG                                              บ
* บ COMENTARIO    : ELIGE DOCUMENTOS DIFERIDOS                               บ
* ฬออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
* บ AUTOR      : GOYO REINER                                                 บ
* บ FECHA      : 09-02-93                                                    บ
* บ HORA       : 07:37:06pm                                                  บ
* บ COPYRIGHT  : 1993 by GREGORIO REINER                                     บ
* ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
* MODIFICACION GOYO - CAMBIO FECHAOP POR FECHAVE
* MODIFICACION GOYO - CAMBIO CAMPO DE INDICE
FUNCTION ELICCHP
	PARAMETER CCH_TIPO
	CCH_TIPO=IIF(TYPE("CCH_TIPO")#"C","CH",CCH_TIPO)
	E_LDOC=Q_TIPDOC(CCH_TIPO,.T.,.T.)
	STORE {01/01/90} TO FECINI
	STORE DATE() TO FECFIN
	IF ENTRE_FE()
		PICU='@Z '+RIGHT('999,999,999,999.99',XACDIGI)
		=WORKING()
		TMP=GENTMP()
		SELE CCH
		=FLOCK() .OR. FLOK()
		IF HAYCAMPO("SELECCION","CCH")
			SET ORDER TO
			SORT ON FECHADE ;
			TO (TMP) FOR ;
			EMPTY(CCH.FECHAAC) .AND. ;
			CCH.ENTREGADO=.F. .AND. ;
			CCH.TIPO=CCH_TIPO AND ;
			CCH.FECHADE<=FECFIN AND ;
			CCH.FECHADE>=FECINI
		ELSE
			SELECT *,' ' AS SELECCION FROM CCH INTO TABLE (TMP) WHERE ;
			EMPTY(CCH.FECHAAC) .AND. ;
			CCH.ENTREGADO=.F. .AND. ;
			CCH.TIPO=CCH_TIPO AND ;
			CCH.FECHADE<=FECFIN AND ;
			CCH.FECHADE>=FECINI
		ENDIF
		USE
		SELE 25
		USE (TMP) ALIAS TMP
		TMPX=GENTMP()
		INDE ON FECHADE TO (M.TMPX) COMP
		SET ORDER TO TAG CODCLI IN PER
		SET RELATION TO TMP.CODCLI INTO PER
		SET ORDER TO TAG NUMERE IN CCH
		SET ORDER TO TAG PROCOD IN CCP
		DEFI WIND WINCHE FROM 2,0 TO 21,79 TITL " "+E_LDOC+" DISPONIBLES " FOOT " [ENTER] PARA SELECCIONAR / [ESC] PARA SALIR / [TAB] PARA GRABAR " COLO SCHE 8
		DEFI WIND WINCHE1 FROM 4,0 TO 17,76 IN WIND WINCHE DOUB COLO SCHE 8
		STORE NUL TO CHEQUES,SUMAFEC,MONPORFEC
		ON KEY LABEL TAB KEYBOARD "{CTRL+W}"
		ON KEY LABEL ENTER DO SUMCH
		=UNWORK()
		SELE TMP
		ACTI WIND WINCHE
		@ 1,1 SAY "SUMA:"
		@ 1,40 SAY "PROMEDIO:"
		ACTI WIND WINCHE1
		BROW FIELD ;
		FECHADE:R:H="DEPOSITO",;
		DIAS=FECHADE-DATE():R:H="DIAS":P="9999",;
		MONTO:R:H="MONTO":P="99,999,999.99",;
		CODCLI:R:H="CODIGO",;
		PER.CLIENTE:R:P=REPL('X',15):H="CLIENTE",;
		BANCO:R:P=REPL("X",10), ;
		SELECCION:H="SELE":R ;
		FREE SELECCION ;
		TITL ' '+E_LDOC+' EN CARTERA ' ;
		WIND WINCHE1 IN WIND WINCHE ;
		COLO SCHE 8
		=RELEWIN("WINCHE")
		ON KEY LABEL ENTER
		ON KEY LABEL TAB
	ENDIF
RETURN LAST()#27
PROCEDURE SUMCH
	F1=FECHADE-DATE()
	P1=MONTO*F1
	IF !EMPTY(SELECCION)
		REPL SELECCION WITH ' '
		CHEQUES=CHEQUES-MONTO
		MONPORFEC=MONPORFEC-P1
	ELSE
		REPL SELECCION WITH '๛'
		CHEQUES=CHEQUES+MONTO
		MONPORFEC=MONPORFEC+P1
	ENDIF
	ACTI WIND WINCHE
	@ 1,10 GET CHEQUES PICT '99,999,999.99'
	XX=MONPORFEC/CHEQUES
	@ 1,50 GET XX PICT '99999.99'
	CLEA GETS
RETURN
